"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[375],{31922:function(e,t,i){i.d(t,{y:function(){return _}});var n=i(13484),s=i(20996),o=i(38431),r=i(16012),d=i(35921),l=i(3024),u=i(90109),h=i(21329),c=i(16308),g=i(56709),a=i(8964),p=i(50038),f=i(35366),m=i(34319),v=i(9907);class I extends o.JT{constructor(e,t){super(),this.editor=e,this.suggestControllerPreselector=t,this.isSuggestWidgetVisible=!1,this.isShiftKeyPressed=!1,this._isActive=!1,this._currentSuggestItemInfo=void 0,this.onDidChangeEmitter=new g.Q5,this.onDidChange=this.onDidChangeEmitter.event,this.setInactiveDelayed=this._register(new n.pY((()=>{this.isSuggestWidgetVisible||this._isActive&&(this._isActive=!1,this.onDidChangeEmitter.fire())}),100)),this._register(e.onKeyDown((e=>{e.shiftKey&&!this.isShiftKeyPressed&&(this.isShiftKeyPressed=!0,this.update(this._isActive))}))),this._register(e.onKeyUp((e=>{e.shiftKey&&this.isShiftKeyPressed&&(this.isShiftKeyPressed=!1,this.update(this._isActive))})));const i=v.SuggestController.get(this.editor);if(i){this._register(i.registerSelector({priority:100,select:(e,t,n)=>{const s=this.editor.getModel(),o=(0,h.Is)(s,this.suggestControllerPreselector());if(!o)return-1;const r=a.L.lift(t),d=n.map(((e,t)=>{const n=C(i,r,e,this.isShiftKeyPressed),d=(0,h.Is)(s,null==n?void 0:n.normalizedInlineCompletion);if(!d)return;var l,u;return{index:t,valid:(l=o.range,(u=d.range).startLineNumber===l.startLineNumber&&u.startColumn===l.startColumn&&(u.endLineNumber<l.endLineNumber||u.endLineNumber===l.endLineNumber&&u.endColumn<=l.endColumn)&&o.insertText.startsWith(d.insertText)),prefixLength:d.insertText.length,suggestItem:e}})).filter((e=>e&&e.valid)),l=(0,c.Dc)(d,(0,c.tT)((e=>e.prefixLength),c.fv));return l?l.index:-1}}));let e=!1;const t=()=>{e||(e=!0,this._register(i.widget.value.onDidShow((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))),this._register(i.widget.value.onDidHide((()=>{this.isSuggestWidgetVisible=!1,this.setInactiveDelayed.schedule(),this.update(this._isActive)}))),this._register(i.widget.value.onDidFocus((()=>{this.isSuggestWidgetVisible=!0,this.update(!0)}))))};this._register(g.ju.once(i.model.onDidTrigger)((e=>{t()})))}this.update(this._isActive)}get state(){if(this._isActive)return{selectedItem:this._currentSuggestItemInfo}}update(e){const t=this.getSuggestItemInfo();let i=!1;(function(e,t){if(e===t)return!0;if(!e||!t)return!1;return e.completionItemKind===t.completionItemKind&&e.isSnippetText===t.isSnippetText&&(0,h.j0)(e.normalizedInlineCompletion,t.normalizedInlineCompletion)})(this._currentSuggestItemInfo,t)||(this._currentSuggestItemInfo=t,i=!0),this._isActive!==e&&(this._isActive=e,i=!0),i&&this.onDidChangeEmitter.fire()}getSuggestItemInfo(){const e=v.SuggestController.get(this.editor);if(!e)return;if(!this.isSuggestWidgetVisible)return;const t=e.widget.value.getFocusedItem();return t?C(e,this.editor.getPosition(),t.item,this.isShiftKeyPressed):void 0}stopForceRenderingAbove(){const e=v.SuggestController.get(this.editor);e&&e.stopForceRenderingAbove()}forceRenderingAbove(){const e=v.SuggestController.get(this.editor);e&&e.forceRenderingAbove()}}function C(e,t,i,n){if(Array.isArray(i.completion.additionalTextEdits)&&i.completion.additionalTextEdits.length>0)return{completionItemKind:i.completion.kind,isSnippetText:!1,normalizedInlineCompletion:{range:p.e.fromPositions(t,t),insertText:"",filterText:"",snippetInfo:void 0,additionalTextEdits:[]}};let{insertText:s}=i.completion,o=!1;if(4&i.completion.insertTextRules){const i=(new f.Yj).parse(s),n=e.editor.getModel();if(i.children.length>100)return;m.l.adjustWhitespace(n,t,i,!0,!0),s=i.toString(),o=!0}const r=e.getOverwriteInfo(i,n);return{isSnippetText:o,completionItemKind:i.completion.kind,normalizedInlineCompletion:{insertText:s,filterText:s,range:p.e.fromPositions(t.delta(0,-r.overwriteBefore),t.delta(0,Math.max(r.overwriteAfter,0))),snippetInfo:void 0,additionalTextEdits:[]}}}var S=function(e,t,i,n){var s,o=arguments.length,r=o<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var d=e.length-1;d>=0;d--)(s=e[d])&&(r=(o<3?s(r):o>3?s(t,i,r):s(t,i))||r);return o>3&&r&&Object.defineProperty(t,i,r),r},x=function(e,t){return function(i,n){t(i,n,e)}},b=function(e,t,i,n){return new(i||(i=Promise))((function(s,o){function r(e){try{l(n.next(e))}catch(e){o(e)}}function d(e){try{l(n.throw(e))}catch(e){o(e)}}function l(e){var t;e.done?s(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}l((n=n.apply(e,t||[])).next())}))};let _=class extends l.TX{constructor(e,t,i){super(e),this.cache=t,this.languageFeaturesService=i,this.suggestionInlineCompletionSource=this._register(new I(this.editor,(()=>{var e,t;return null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()}))),this.updateOperation=this._register(new o.XK),this.updateCacheSoon=this._register(new n.pY((()=>this.updateCache()),50)),this.minReservedLineCount=0,this._register(this.suggestionInlineCompletionSource.onDidChange((()=>{if(!this.editor.hasModel())return;this.updateCacheSoon.schedule();this.suggestionInlineCompletionSource.state||(this.minReservedLineCount=0);const e=this.ghostText;e&&(this.minReservedLineCount=Math.max(this.minReservedLineCount,e.parts.map((e=>e.lines.length-1)).reduce(((e,t)=>e+t),0))),this.minReservedLineCount>=1?this.suggestionInlineCompletionSource.forceRenderingAbove():this.suggestionInlineCompletionSource.stopForceRenderingAbove(),this.onDidChangeEmitter.fire()}))),this._register(this.cache.onDidChange((()=>{this.onDidChangeEmitter.fire()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{this.minReservedLineCount=0,this.updateCacheSoon.schedule(),this.onDidChangeEmitter.fire()}))),this._register((0,o.OF)((()=>this.suggestionInlineCompletionSource.stopForceRenderingAbove())))}get isActive(){return void 0!==this.suggestionInlineCompletionSource.state}isSuggestionPreviewEnabled(){return this.editor.getOption(108).preview}updateCache(){return b(this,void 0,void 0,(function*(){const e=this.suggestionInlineCompletionSource.state;if(!e||!e.selectedItem)return;const t={text:e.selectedItem.normalizedInlineCompletion.insertText,range:e.selectedItem.normalizedInlineCompletion.range,isSnippetText:e.selectedItem.isSnippetText,completionKind:e.selectedItem.completionItemKind},i=this.editor.getPosition();if(e.selectedItem.isSnippetText||27===e.selectedItem.completionItemKind||20===e.selectedItem.completionItemKind||23===e.selectedItem.completionItemKind)return void this.cache.clear();const o=(0,n.PG)((e=>b(this,void 0,void 0,(function*(){let n;try{n=yield(0,u.km)(this.languageFeaturesService.inlineCompletionsProvider,i,this.editor.getModel(),{triggerKind:r.bw.Automatic,selectedSuggestionInfo:t},e)}catch(e){return void(0,s.dL)(e)}e.isCancellationRequested?n.dispose():(this.cache.setValue(this.editor,n,r.bw.Automatic),this.onDidChangeEmitter.fire())})))),d=new u._X(o,r.bw.Automatic);this.updateOperation.value=d,yield o,this.updateOperation.value===d&&this.updateOperation.clear()}))}get ghostText(){var e,t,i;const n=this.isSuggestionPreviewEnabled(),s=this.editor.getModel(),o=(0,h.Is)(s,null===(t=null===(e=this.cache.value)||void 0===e?void 0:e.completions[0])||void 0===t?void 0:t.toLiveInlineCompletion()),r=this.suggestionInlineCompletionSource.state,d=(0,h.Is)(s,null===(i=null==r?void 0:r.selectedItem)||void 0===i?void 0:i.normalizedInlineCompletion),l=o&&d&&o.insertText.startsWith(d.insertText)&&o.range.equalsRange(d.range);if(!n&&!l)return;const u=l?o:d||o,c=l?u.insertText.length-d.insertText.length:0;return this.toGhostText(u,c)}toGhostText(e,t){const i=this.editor.getOptions().get(108).previewMode;return e?(0,h.mr)(e,this.editor.getModel(),i,this.editor.getPosition(),t)||new l.Vb(e.range.endLineNumber,[],this.minReservedLineCount):void 0}};_=S([x(2,d.p)],_)},56800:function(e,t,i){i.d(t,{Cy:function(){return s},He:function(){return l},Jj:function(){return o}});var n=i(50038);function s(e,t){return{object:e,dispose:()=>null==t?void 0:t.dispose()}}function o(e,t){const i=new r(e),s=t.map((e=>{const t=n.e.lift(e.range);return{startOffset:i.getOffset(t.getStartPosition()),endOffset:i.getOffset(t.getEndPosition()),text:e.text}}));s.sort(((e,t)=>t.startOffset-e.startOffset));for(const t of s)e=e.substring(0,t.startOffset)+t.text+e.substring(t.endOffset);return e}class r{constructor(e){this.lineStartOffsetByLineIdx=[],this.lineStartOffsetByLineIdx.push(0);for(let t=0;t<e.length;t++)"\n"===e.charAt(t)&&this.lineStartOffsetByLineIdx.push(t+1)}getOffset(e){return this.lineStartOffsetByLineIdx[e.lineNumber-1]+e.column-1}}const d=[];function l(){return d}}}]);