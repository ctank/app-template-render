"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[4093],{23645:function(e,t,n){n.r(t);var o=n(94880),i=n(55298),r=n(50038),s=n(21081),m=n(29173),a=n(19083),l=n(8964),c=n(57841);class u{constructor(e,t,n){this.languageConfigurationService=n,this._selection=e,this._insertSpace=t,this._usedEndToken=null}static _haystackHasNeedleAtOffset(e,t,n){if(n<0)return!1;const o=t.length;if(n+o>e.length)return!1;for(let i=0;i<o;i++){const o=e.charCodeAt(n+i),r=t.charCodeAt(i);if(o!==r&&!(o>=65&&o<=90&&o+32===r||r>=65&&r<=90&&r+32===o))return!1}return!0}_createOperationsForBlockComment(e,t,n,o,i,s){const m=e.startLineNumber,a=e.startColumn,l=e.endLineNumber,c=e.endColumn,g=i.getLineContent(m),d=i.getLineContent(l);let h,C=g.lastIndexOf(t,a-1+t.length),p=d.indexOf(n,c-1-n.length);if(-1!==C&&-1!==p)if(m===l){g.substring(C+t.length,p).indexOf(n)>=0&&(C=-1,p=-1)}else{const e=g.substring(C+t.length),o=d.substring(0,p);(e.indexOf(n)>=0||o.indexOf(n)>=0)&&(C=-1,p=-1)}-1!==C&&-1!==p?(o&&C+t.length<g.length&&32===g.charCodeAt(C+t.length)&&(t+=" "),o&&p>0&&32===d.charCodeAt(p-1)&&(n=" "+n,p-=1),h=u._createRemoveBlockCommentOperations(new r.e(m,C+t.length+1,l,p+1),t,n)):(h=u._createAddBlockCommentOperations(e,t,n,this._insertSpace),this._usedEndToken=1===h.length?n:null);for(const e of h)s.addTrackedEditOperation(e.range,e.text)}static _createRemoveBlockCommentOperations(e,t,n){const o=[];return r.e.isEmpty(e)?o.push(a.h.delete(new r.e(e.startLineNumber,e.startColumn-t.length,e.endLineNumber,e.endColumn+n.length))):(o.push(a.h.delete(new r.e(e.startLineNumber,e.startColumn-t.length,e.startLineNumber,e.startColumn))),o.push(a.h.delete(new r.e(e.endLineNumber,e.endColumn,e.endLineNumber,e.endColumn+n.length)))),o}static _createAddBlockCommentOperations(e,t,n,o){const i=[];return r.e.isEmpty(e)?i.push(a.h.replace(new r.e(e.startLineNumber,e.startColumn,e.endLineNumber,e.endColumn),t+"  "+n)):(i.push(a.h.insert(new l.L(e.startLineNumber,e.startColumn),t+(o?" ":""))),i.push(a.h.insert(new l.L(e.endLineNumber,e.endColumn),(o?" ":"")+n))),i}getEditOperations(e,t){const n=this._selection.startLineNumber,o=this._selection.startColumn;e.tokenization.tokenizeIfCheap(n);const i=e.getLanguageIdAtPosition(n,o),r=this.languageConfigurationService.getLanguageConfiguration(i).comments;r&&r.blockCommentStartToken&&r.blockCommentEndToken&&this._createOperationsForBlockComment(this._selection,r.blockCommentStartToken,r.blockCommentEndToken,this._insertSpace,e,t)}computeCursorState(e,t){const n=t.getInverseEditOperations();if(2===n.length){const e=n[0],t=n[1];return new c.Y(e.range.endLineNumber,e.range.endColumn,t.range.startLineNumber,t.range.startColumn)}{const e=n[0].range,t=this._usedEndToken?-this._usedEndToken.length-1:0;return new c.Y(e.endLineNumber,e.endColumn+t,e.endLineNumber,e.endColumn+t)}}}var g=n(17416);class d{constructor(e,t,n,o,i,r,s){this.languageConfigurationService=e,this._selection=t,this._tabSize=n,this._type=o,this._insertSpace=i,this._selectionId=null,this._deltaColumn=0,this._moveEndPositionDown=!1,this._ignoreEmptyLines=r,this._ignoreFirstLine=s||!1}static _gatherPreflightCommentStrings(e,t,n,o){e.tokenization.tokenizeIfCheap(t);const i=e.getLanguageIdAtPosition(t,1),r=o.getLanguageConfiguration(i).comments,s=r?r.lineCommentToken:null;if(!s)return null;const m=[];for(let e=0,o=n-t+1;e<o;e++)m[e]={ignore:!1,commentStr:s,commentStrOffset:0,commentStrLength:s.length};return m}static _analyzeLines(e,t,n,o,i,r,s,m){let a,l=!0;a=0===e||1!==e;for(let m=0,c=o.length;m<c;m++){const c=o[m],d=i+m;if(d===i&&s){c.ignore=!0;continue}const h=n.getLineContent(d),C=g.LC(h);if(-1!==C){if(l=!1,c.ignore=!1,c.commentStrOffset=C,a&&!u._haystackHasNeedleAtOffset(h,c.commentStr,C)&&(0===e?a=!1:1===e||(c.ignore=!0)),a&&t){const e=C+c.commentStrLength;e<h.length&&32===h.charCodeAt(e)&&(c.commentStrLength+=1)}}else c.ignore=r,c.commentStrOffset=h.length}if(0===e&&l){a=!1;for(let e=0,t=o.length;e<t;e++)o[e].ignore=!1}return{supported:!0,shouldRemoveComments:a,lines:o}}static _gatherPreflightData(e,t,n,o,i,r,s,m){const a=d._gatherPreflightCommentStrings(n,o,i,m);return null===a?{supported:!1}:d._analyzeLines(e,t,n,a,o,r,s,m)}_executeLineComments(e,t,n,o){let i;n.shouldRemoveComments?i=d._createRemoveLineCommentsOperations(n.lines,o.startLineNumber):(d._normalizeInsertionPoint(e,n.lines,o.startLineNumber,this._tabSize),i=this._createAddLineCommentsOperations(n.lines,o.startLineNumber));const s=new l.L(o.positionLineNumber,o.positionColumn);for(let n=0,o=i.length;n<o;n++)if(t.addEditOperation(i[n].range,i[n].text),r.e.isEmpty(i[n].range)&&r.e.getStartPosition(i[n].range).equals(s)){e.getLineContent(s.lineNumber).length+1===s.column&&(this._deltaColumn=(i[n].text||"").length)}this._selectionId=t.trackSelection(o)}_attemptRemoveBlockComment(e,t,n,o){let i=t.startLineNumber,s=t.endLineNumber;const m=o.length+Math.max(e.getLineFirstNonWhitespaceColumn(t.startLineNumber),t.startColumn);let a=e.getLineContent(i).lastIndexOf(n,m-1),l=e.getLineContent(s).indexOf(o,t.endColumn-1-n.length);return-1!==a&&-1===l&&(l=e.getLineContent(i).indexOf(o,a+n.length),s=i),-1===a&&-1!==l&&(a=e.getLineContent(s).lastIndexOf(n,l),i=s),!t.isEmpty()||-1!==a&&-1!==l||(a=e.getLineContent(i).indexOf(n),-1!==a&&(l=e.getLineContent(i).indexOf(o,a+n.length))),-1!==a&&32===e.getLineContent(i).charCodeAt(a+n.length)&&(n+=" "),-1!==l&&32===e.getLineContent(s).charCodeAt(l-1)&&(o=" "+o,l-=1),-1!==a&&-1!==l?u._createRemoveBlockCommentOperations(new r.e(i,a+n.length+1,s,l+1),n,o):null}_executeBlockComment(e,t,n){e.tokenization.tokenizeIfCheap(n.startLineNumber);const o=e.getLanguageIdAtPosition(n.startLineNumber,1),i=this.languageConfigurationService.getLanguageConfiguration(o).comments;if(!i||!i.blockCommentStartToken||!i.blockCommentEndToken)return;const s=i.blockCommentStartToken,m=i.blockCommentEndToken;let a=this._attemptRemoveBlockComment(e,n,s,m);if(!a){if(n.isEmpty()){const t=e.getLineContent(n.startLineNumber);let o=g.LC(t);-1===o&&(o=t.length),a=u._createAddBlockCommentOperations(new r.e(n.startLineNumber,o+1,n.startLineNumber,t.length+1),s,m,this._insertSpace)}else a=u._createAddBlockCommentOperations(new r.e(n.startLineNumber,e.getLineFirstNonWhitespaceColumn(n.startLineNumber),n.endLineNumber,e.getLineMaxColumn(n.endLineNumber)),s,m,this._insertSpace);1===a.length&&(this._deltaColumn=s.length+1)}this._selectionId=t.trackSelection(n);for(const e of a)t.addEditOperation(e.range,e.text)}getEditOperations(e,t){let n=this._selection;if(this._moveEndPositionDown=!1,n.startLineNumber===n.endLineNumber&&this._ignoreFirstLine)return t.addEditOperation(new r.e(n.startLineNumber,e.getLineMaxColumn(n.startLineNumber),n.startLineNumber+1,1),n.startLineNumber===e.getLineCount()?"":"\n"),void(this._selectionId=t.trackSelection(n));n.startLineNumber<n.endLineNumber&&1===n.endColumn&&(this._moveEndPositionDown=!0,n=n.setEndPosition(n.endLineNumber-1,e.getLineMaxColumn(n.endLineNumber-1)));const o=d._gatherPreflightData(this._type,this._insertSpace,e,n.startLineNumber,n.endLineNumber,this._ignoreEmptyLines,this._ignoreFirstLine,this.languageConfigurationService);return o.supported?this._executeLineComments(e,t,o,n):this._executeBlockComment(e,t,n)}computeCursorState(e,t){let n=t.getTrackedSelection(this._selectionId);return this._moveEndPositionDown&&(n=n.setEndPosition(n.endLineNumber+1,1)),new c.Y(n.selectionStartLineNumber,n.selectionStartColumn+this._deltaColumn,n.positionLineNumber,n.positionColumn+this._deltaColumn)}static _createRemoveLineCommentsOperations(e,t){const n=[];for(let o=0,i=e.length;o<i;o++){const i=e[o];i.ignore||n.push(a.h.delete(new r.e(t+o,i.commentStrOffset+1,t+o,i.commentStrOffset+i.commentStrLength+1)))}return n}_createAddLineCommentsOperations(e,t){const n=[],o=this._insertSpace?" ":"";for(let i=0,r=e.length;i<r;i++){const r=e[i];r.ignore||n.push(a.h.insert(new l.L(t+i,r.commentStrOffset+1),r.commentStr+o))}return n}static nextVisibleColumn(e,t,n,o){return n?e+(t-e%t):e+o}static _normalizeInsertionPoint(e,t,n,o){let i,r,s=1073741824;for(let i=0,r=t.length;i<r;i++){if(t[i].ignore)continue;const r=e.getLineContent(n+i);let m=0;for(let e=0,n=t[i].commentStrOffset;m<s&&e<n;e++)m=d.nextVisibleColumn(m,o,9===r.charCodeAt(e),1);m<s&&(s=m)}s=Math.floor(s/o)*o;for(let m=0,a=t.length;m<a;m++){if(t[m].ignore)continue;const a=e.getLineContent(n+m);let l=0;for(i=0,r=t[m].commentStrOffset;l<s&&i<r;i++)l=d.nextVisibleColumn(l,o,9===a.charCodeAt(i),1);t[m].commentStrOffset=l>s?i-1:i}}}var h=n(26386),C=n(21208);class p extends i.R6{constructor(e,t){super(t),this._type=e}run(e,t){const n=e.get(m.c_);if(!t.hasModel())return;const o=[],i=t.getModel().getOptions(),s=t.getOption(19),a=t.getSelections().map(((e,t)=>({selection:e,index:t,ignoreFirstLine:!1})));a.sort(((e,t)=>r.e.compareRangesUsingStarts(e.selection,t.selection)));let l=a[0];for(let e=1;e<a.length;e++){const t=a[e];l.selection.endLineNumber===t.selection.startLineNumber&&(l.index<t.index?t.ignoreFirstLine=!0:(l.ignoreFirstLine=!0,l=t))}for(const e of a)o.push(new d(n,e.selection,i.tabSize,this._type,s.insertSpace,s.ignoreEmptyLines,e.ignoreFirstLine));t.pushUndoStop(),t.executeCommands(this.id,o),t.pushUndoStop()}}class L extends i.R6{constructor(){super({id:"editor.action.blockComment",label:h.NC("comment.block","Toggle Block Comment"),alias:"Toggle Block Comment",precondition:s.u.writable,kbOpts:{kbExpr:s.u.editorTextFocus,primary:1567,linux:{primary:3103},weight:100},menuOpts:{menuId:C.eH.MenubarEditMenu,group:"5_insert",title:h.NC({key:"miToggleBlockComment",comment:["&& denotes a mnemonic"]},"Toggle &&Block Comment"),order:2}})}run(e,t){const n=e.get(m.c_);if(!t.hasModel())return;const o=t.getOption(19),i=[],r=t.getSelections();for(const e of r)i.push(new u(e,o.insertSpace,n));t.pushUndoStop(),t.executeCommands(this.id,i),t.pushUndoStop()}}(0,i.Qr)(class extends p{constructor(){super(0,{id:"editor.action.commentLine",label:h.NC("comment.line","Toggle Line Comment"),alias:"Toggle Line Comment",precondition:s.u.writable,kbOpts:{kbExpr:s.u.editorTextFocus,primary:2133,weight:100},menuOpts:{menuId:C.eH.MenubarEditMenu,group:"5_insert",title:h.NC({key:"miToggleLineComment",comment:["&& denotes a mnemonic"]},"&&Toggle Line Comment"),order:1}})}}),(0,i.Qr)(class extends p{constructor(){super(1,{id:"editor.action.addCommentLine",label:h.NC("comment.line.add","Add Line Comment"),alias:"Add Line Comment",precondition:s.u.writable,kbOpts:{kbExpr:s.u.editorTextFocus,primary:(0,o.gx)(2089,2081),weight:100}})}}),(0,i.Qr)(class extends p{constructor(){super(2,{id:"editor.action.removeCommentLine",label:h.NC("comment.line.remove","Remove Line Comment"),alias:"Remove Line Comment",precondition:s.u.writable,kbOpts:{kbExpr:s.u.editorTextFocus,primary:(0,o.gx)(2089,2099),weight:100}})}}),(0,i.Qr)(L)}}]);