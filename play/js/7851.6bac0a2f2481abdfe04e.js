"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[7851],{21329:function(e,t,i){i.d(t,{Is:function(){return l},j0:function(){return a},mr:function(){return d}});var n=i(99731),o=i(17416),s=i(50038),r=i(3024);function l(e,t){if(!t)return t;const i=e.getValueInRange(t.range),n=o.Mh(i,t.insertText),r=e.getOffsetAt(t.range.getStartPosition())+n,l=e.getPositionAt(r),a=i.substr(n),d=o.P1(a,t.insertText),h=e.getPositionAt(Math.max(r,e.getOffsetAt(t.range.getEndPosition())-d));return{range:s.e.fromPositions(l,h),insertText:t.insertText.substr(n,t.insertText.length-n-d),snippetInfo:t.snippetInfo,filterText:t.filterText,additionalTextEdits:t.additionalTextEdits}}function a(e,t){return e===t||!(!e||!t)&&(e.range.equalsRange(t.range)&&e.insertText===t.insertText&&e.command===t.command)}function d(e,t,i,n,l=0){if(e.range.startLineNumber!==e.range.endLineNumber)return;const a=t.getLineContent(e.range.startLineNumber),d=o.V8(a).length;if(e.range.startColumn-1<=d){const t=o.V8(e.insertText).length,i=a.substring(e.range.startColumn-1,d),n=s.e.fromPositions(e.range.getStartPosition().delta(0,i.length),e.range.getEndPosition()),r=e.insertText.startsWith(i)?e.insertText.substring(i.length):e.insertText.substring(t);e={range:n,insertText:r,command:e.command,snippetInfo:void 0,filterText:e.filterText,additionalTextEdits:e.additionalTextEdits}}const g=t.getValueInRange(e.range),m=function(e,t){if((null==h?void 0:h.originalValue)===e&&(null==h?void 0:h.newValue)===t)return null==h?void 0:h.changes;{let i=c(e,t,!0);if(i){const n=u(i);if(n>0){const o=c(e,t,!1);o&&u(o)<n&&(i=o)}}return h={originalValue:e,newValue:t,changes:i},i}}(g,e.insertText);if(!m)return;const p=e.range.startLineNumber,f=new Array;if("prefix"===i){const e=m.filter((e=>0===e.originalLength));if(e.length>1||1===e.length&&e[0].originalStart!==g.length)return}const C=e.insertText.length-l;for(const t of m){const s=e.range.startColumn+t.originalStart+t.originalLength;if("subwordSmart"===i&&n&&n.lineNumber===e.range.startLineNumber&&s<n.column)return;if(t.originalLength>0)return;if(0===t.modifiedLength)continue;const l=t.modifiedStart+t.modifiedLength,a=Math.max(t.modifiedStart,Math.min(l,C)),d=e.insertText.substring(t.modifiedStart,a),h=e.insertText.substring(a,Math.max(t.modifiedStart,l));if(d.length>0){const e=o.uq(d);f.push(new r.NY(s,e,!1))}if(h.length>0){const e=o.uq(h);f.push(new r.NY(s,e,!0))}}return new r.Vb(p,f,0)}let h;function u(e){let t=0;for(const i of e)t+=Math.max(i.originalLength-i.modifiedLength,0);return t}function c(e,t,i){if(e.length>5e3||t.length>5e3)return;function o(e){let t=0;for(let i=0,n=e.length;i<n;i++){const n=e.charCodeAt(i);n>t&&(t=n)}return t}const s=Math.max(o(e),o(t));function r(e){if(e<0)throw new Error("unexpected");return s+e+1}function l(e){let t=0,n=0;const o=new Int32Array(e.length);for(let s=0,l=e.length;s<l;s++)if(i&&"("===e[s]){const e=100*n+t;o[s]=r(2*e),t++}else if(i&&")"===e[s]){t=Math.max(t-1,0);const e=100*n+t;o[s]=r(2*e+1),0===t&&n++}else o[s]=e.charCodeAt(s);return o}const a=l(e),d=l(t);return new n.Hs({getElements:()=>a},{getElements:()=>d}).ComputeDiff(!1).changes}},90109:function(e,t,i){i.d(t,{FM:function(){return N},_X:function(){return M},k:function(){return L},km:function(){return A}});var n=i(13484),o=i(97464),s=i(20996),r=i(56709),l=i(38431),a=i(89033),d=i(19083),h=i(50038),u=i(16012),c=i(3024),g=i(80793),m=i(56462),p=i(21329),f=i(29173),C=i(95307),v=i(35921),x=i(69060),I=i(35366),T=i(31046),S=i(14818),b=i(4538),w=i(56800),y=i(71177),E=function(e,t,i,n){var o,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(r=(s<3?o(r):s>3?o(t,i,r):o(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},P=function(e,t){return function(i,n){t(i,n,e)}},D=function(e,t,i,n){return new(i||(i=Promise))((function(o,s){function r(e){try{a(n.next(e))}catch(e){s(e)}}function l(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,l)}a((n=n.apply(e,t||[])).next())}))};let L=class extends l.JT{constructor(e,t,i,n,o,s,d){super(),this.editor=e,this.cache=t,this.commandService=i,this.languageConfigurationService=n,this.languageFeaturesService=o,this.debounceService=s,this.onDidChangeEmitter=new r.Q5,this.onDidChange=this.onDidChangeEmitter.event,this.completionSession=this._register(new l.XK),this.active=!1,this.disposed=!1,this.debounceValue=this.debounceService.for(this.languageFeaturesService.inlineCompletionsProvider,"InlineCompletionsDebounce",{min:50,max:50}),this._register(i.onDidExecuteCommand((t=>{new Set([a.CoreEditingCommands.Tab.id,a.CoreEditingCommands.DeleteLeft.id,a.CoreEditingCommands.DeleteRight.id,m.O,"acceptSelectedSuggestion"]).has(t.commandId)&&e.hasTextFocus()&&this.handleUserInput()}))),this._register(this.editor.onDidType((e=>{this.handleUserInput()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{(3===e.reason||this.session&&!this.session.isValid)&&this.hide()}))),this._register((0,l.OF)((()=>{this.disposed=!0}))),this._register(this.editor.onDidBlurEditorWidget((()=>{d.getValue("editor.inlineSuggest.hideOnBlur")||this.hide()})))}handleUserInput(){this.session&&!this.session.isValid&&this.hide(),setTimeout((()=>{this.disposed||this.startSessionIfTriggered()}),0)}get session(){return this.completionSession.value}get ghostText(){var e;return null===(e=this.session)||void 0===e?void 0:e.ghostText}get minReservedLineCount(){return this.session?this.session.minReservedLineCount:0}setExpanded(e){var t;null===(t=this.session)||void 0===t||t.setExpanded(e)}setActive(e){var t;this.active=e,e&&(null===(t=this.session)||void 0===t||t.scheduleAutomaticUpdate())}startSessionIfTriggered(){this.editor.getOption(57).enabled&&(this.session&&this.session.isValid||this.trigger(u.bw.Automatic))}trigger(e){this.completionSession.value?e===u.bw.Explicit&&this.completionSession.value.ensureUpdateWithExplicitContext():(this.completionSession.value=new O(this.editor,this.editor.getPosition(),(()=>this.active),this.commandService,this.cache,e,this.languageConfigurationService,this.languageFeaturesService.inlineCompletionsProvider,this.debounceValue),this.completionSession.value.takeOwnership(this.completionSession.value.onDidChange((()=>{this.onDidChangeEmitter.fire()}))))}hide(){this.completionSession.clear(),this.onDidChangeEmitter.fire()}commitCurrentSuggestion(){var e;null===(e=this.session)||void 0===e||e.commitCurrentCompletion()}showNext(){var e;null===(e=this.session)||void 0===e||e.showNextInlineCompletion()}showPrevious(){var e;null===(e=this.session)||void 0===e||e.showPreviousInlineCompletion()}hasMultipleInlineCompletions(){var e;return D(this,void 0,void 0,(function*(){const t=yield null===(e=this.session)||void 0===e?void 0:e.hasMultipleInlineCompletions();return void 0!==t&&t}))}};L=E([P(2,g.Hy),P(3,f.c_),P(4,v.p),P(5,x.A),P(6,y.Ui)],L);class O extends c.TX{constructor(e,t,i,o,s,r,a,d,h){let c;super(e),this.triggerPosition=t,this.shouldUpdate=i,this.commandService=o,this.cache=s,this.initialTriggerKind=r,this.languageConfigurationService=a,this.registry=d,this.debounce=h,this.minReservedLineCount=0,this.updateOperation=this._register(new l.XK),this.updateSoon=this._register(new n.pY((()=>{const e=this.initialTriggerKind;return this.initialTriggerKind=u.bw.Automatic,this.update(e)}),50)),this.filteredCompletions=[],this.currentlySelectedCompletionId=void 0,this._register(this.onDidChange((()=>{var e;const t=this.currentCompletion;if(t&&t.sourceInlineCompletion!==c){c=t.sourceInlineCompletion;const i=t.sourceProvider;null===(e=i.handleItemDidShow)||void 0===e||e.call(i,t.sourceInlineCompletions,c)}}))),this._register((0,l.OF)((()=>{this.cache.clear()}))),this._register(this.editor.onDidChangeCursorPosition((e=>{var t;3!==e.reason&&(null===(t=this.cache.value)||void 0===t||t.updateRanges(),this.cache.value&&(this.updateFilteredInlineCompletions(),this.onDidChangeEmitter.fire()))}))),this._register(this.editor.onDidChangeModelContent((e=>{var t;null===(t=this.cache.value)||void 0===t||t.updateRanges(),this.updateFilteredInlineCompletions(),this.scheduleAutomaticUpdate()}))),this._register(this.registry.onDidChange((()=>{this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}))),this.scheduleAutomaticUpdate()}updateFilteredInlineCompletions(){if(!this.cache.value)return void(this.filteredCompletions=[]);const e=this.editor.getModel(),t=e.validatePosition(this.editor.getPosition());this.filteredCompletions=this.cache.value.completions.filter((i=>{const n=e.getValueInRange(i.synchronizedRange).toLowerCase(),o=i.inlineCompletion.filterText.toLowerCase(),s=e.getLineIndentColumn(i.synchronizedRange.startLineNumber),r=Math.max(0,t.column-i.synchronizedRange.startColumn);let l=o.substring(0,r),a=o.substring(r),d=n.substring(0,r),h=n.substring(r);return i.synchronizedRange.startColumn<=s&&(d=d.trimStart(),0===d.length&&(h=h.trimStart()),l=l.trimStart(),0===l.length&&(a=a.trimStart())),l.startsWith(d)&&(0,b.Sy)(h,a)}))}fixAndGetIndexOfCurrentSelection(){if(!this.currentlySelectedCompletionId||!this.cache.value)return 0;if(0===this.cache.value.completions.length)return 0;const e=this.filteredCompletions.findIndex((e=>e.semanticId===this.currentlySelectedCompletionId));return-1===e?(this.currentlySelectedCompletionId=void 0,0):e}get currentCachedCompletion(){if(this.cache.value)return this.filteredCompletions[this.fixAndGetIndexOfCurrentSelection()]}showNextInlineCompletion(){return D(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const e=this.filteredCompletions||[];if(e.length>0){const t=(this.fixAndGetIndexOfCurrentSelection()+1)%e.length;this.currentlySelectedCompletionId=e[t].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}showPreviousInlineCompletion(){return D(this,void 0,void 0,(function*(){yield this.ensureUpdateWithExplicitContext();const e=this.filteredCompletions||[];if(e.length>0){const t=(this.fixAndGetIndexOfCurrentSelection()+e.length-1)%e.length;this.currentlySelectedCompletionId=e[t].semanticId}else this.currentlySelectedCompletionId=void 0;this.onDidChangeEmitter.fire()}))}ensureUpdateWithExplicitContext(){var e;return D(this,void 0,void 0,(function*(){this.updateOperation.value?this.updateOperation.value.triggerKind===u.bw.Explicit?yield this.updateOperation.value.promise:yield this.update(u.bw.Explicit):(null===(e=this.cache.value)||void 0===e?void 0:e.triggerKind)!==u.bw.Explicit&&(yield this.update(u.bw.Explicit))}))}hasMultipleInlineCompletions(){var e;return D(this,void 0,void 0,(function*(){return yield this.ensureUpdateWithExplicitContext(),((null===(e=this.cache.value)||void 0===e?void 0:e.completions.length)||0)>1}))}get ghostText(){const e=this.currentCompletion;if(!e)return;const t=this.editor.getPosition();if(e.range.getEndPosition().isBefore(t))return;const i=this.editor.getOptions().get(57).mode,n=(0,p.mr)(e,this.editor.getModel(),i,t);if(n){if(n.isEmpty())return;return n}return new c.s1(e.range.startLineNumber,e.range.startColumn,e.range.endColumn-e.range.startColumn,e.insertText.split("\n"),0)}get currentCompletion(){const e=this.currentCachedCompletion;if(e)return e.toLiveInlineCompletion()}get isValid(){return this.editor.getPosition().lineNumber===this.triggerPosition.lineNumber}scheduleAutomaticUpdate(){this.updateOperation.clear(),this.updateSoon.schedule(this.debounce.get(this.editor.getModel()))}update(e){return D(this,void 0,void 0,(function*(){if(!this.shouldUpdate())return;const t=this.editor.getPosition(),i=new Date,o=(0,n.PG)((n=>D(this,void 0,void 0,(function*(){let o;try{o=yield A(this.registry,t,this.editor.getModel(),{triggerKind:e,selectedSuggestionInfo:void 0},n,this.languageConfigurationService);const s=new Date;this.debounce.update(this.editor.getModel(),s.getTime()-i.getTime())}catch(e){return void(0,s.dL)(e)}n.isCancellationRequested||(this.cache.setValue(this.editor,o,e),this.updateFilteredInlineCompletions(),this.onDidChangeEmitter.fire())})))),r=new M(o,e);this.updateOperation.value=r,yield o,this.updateOperation.value===r&&this.updateOperation.clear()}))}takeOwnership(e){this._register(e)}commitCurrentCompletion(){if(!this.ghostText)return;const e=this.currentCompletion;e&&this.commit(e)}commit(e){var t;const i=this.cache.clearAndLeak();e.snippetInfo?(this.editor.executeEdits("inlineSuggestion.accept",[d.h.replaceMove(e.range,""),...e.additionalTextEdits]),this.editor.setPosition(e.snippetInfo.range.getStartPosition()),null===(t=T.SnippetController2.get(this.editor))||void 0===t||t.insert(e.snippetInfo.snippet)):this.editor.executeEdits("inlineSuggestion.accept",[d.h.replaceMove(e.range,e.insertText),...e.additionalTextEdits]),e.command?this.commandService.executeCommand(e.command.id,...e.command.arguments||[]).finally((()=>{null==i||i.dispose()})).then(void 0,s.Cp):null==i||i.dispose(),this.onDidChangeEmitter.fire()}get commands(){var e;return[...new Set((null===(e=this.cache.value)||void 0===e?void 0:e.completions.map((e=>e.inlineCompletion.sourceInlineCompletions)))||[])].flatMap((e=>e.commands||[]))}}class M{constructor(e,t){this.promise=e,this.triggerKind=t}dispose(){this.promise.cancel()}}class N extends l.JT{constructor(e,t,i,n){super(),this.editor=t,this.onChange=i,this.triggerKind=n,this.isDisposing=!1;const o=t.changeDecorations((t=>t.deltaDecorations([],e.items.map((e=>({range:e.range,options:{description:"inline-completion-tracking-range"}}))))));this._register((0,l.OF)((()=>{this.isDisposing=!0,t.removeDecorations(o)}))),this.completions=e.items.map(((e,t)=>new R(e,o[t]))),this._register(t.onDidChangeModelContent((()=>{this.updateRanges()}))),this._register(e)}updateRanges(){if(this.isDisposing)return;let e=!1;const t=this.editor.getModel();for(const i of this.completions){const n=t.getDecorationRange(i.decorationId);n?i.synchronizedRange.equalsRange(n)||(e=!0,i.synchronizedRange=n):(0,s.dL)(new Error("Decoration has no range"))}e&&this.onChange()}}class R{constructor(e,t){this.inlineCompletion=e,this.decorationId=t,this.semanticId=JSON.stringify({text:this.inlineCompletion.insertText,abbreviation:this.inlineCompletion.filterText,startLine:this.inlineCompletion.range.startLineNumber,startColumn:this.inlineCompletion.range.startColumn,command:this.inlineCompletion.command}),this.synchronizedRange=e.range}toLiveInlineCompletion(){return{insertText:this.inlineCompletion.insertText,range:this.synchronizedRange,command:this.inlineCompletion.command,sourceProvider:this.inlineCompletion.sourceProvider,sourceInlineCompletions:this.inlineCompletion.sourceInlineCompletions,sourceInlineCompletion:this.inlineCompletion.sourceInlineCompletion,snippetInfo:this.inlineCompletion.snippetInfo,filterText:this.inlineCompletion.filterText,additionalTextEdits:this.inlineCompletion.additionalTextEdits}}}function A(e,t,i,n,r=o.T.None,l){return D(this,void 0,void 0,(function*(){const o=function(e,t){const i=t.getWordAtPosition(e),n=t.getLineMaxColumn(e.lineNumber);return i?new h.e(e.lineNumber,i.startColumn,e.lineNumber,n):h.e.fromPositions(e,e.with(void 0,n))}(t,i),a=e.all(i),d=yield Promise.all(a.map((e=>D(this,void 0,void 0,(function*(){const o=yield Promise.resolve(e.provideInlineCompletions(i,t,n,r)).catch(s.Cp);return{completions:o,provider:e,dispose:()=>{o&&e.freeInlineCompletions(o)}}}))))),u=new Map;for(const e of d){const t=e.completions;if(t)for(const n of t.items){let s,r,a=n.range?h.e.lift(n.range):o;if(a.startLineNumber!==a.endLineNumber)continue;if("string"==typeof n.insertText){if(s=n.insertText,l&&n.completeBracketPairs){s=_(s,a.getStartPosition(),i,l);const e=s.length-n.insertText.length;0!==e&&(a=new h.e(a.startLineNumber,a.startColumn,a.endLineNumber,a.endColumn+e))}r=void 0}else if("snippet"in n.insertText){s=(new I.Yj).parse(n.insertText.snippet).toString(),r={snippet:n.insertText.snippet,range:a}}else(0,S.vE)(n.insertText);const d={insertText:s,snippetInfo:r,range:a,command:n.command,sourceProvider:e.provider,sourceInlineCompletions:t,sourceInlineCompletion:n,filterText:n.filterText||s,additionalTextEdits:n.additionalTextEdits||(0,w.He)()};u.set(JSON.stringify({insertText:s,range:n.range}),d)}}return{items:[...u.values()],dispose:()=>{for(const e of d)e.dispose()}}}))}function _(e,t,i,n){const o=i.getLineContent(t.lineNumber).substring(0,t.column-1)+e,s=i.tokenization.tokenizeLineWithEdit(t,o.length-(t.column-1),e),r=null==s?void 0:s.sliceAndInflate(t.column-1,o.length,0);if(!r)return e;return(0,C.r)(r,n)}}}]);