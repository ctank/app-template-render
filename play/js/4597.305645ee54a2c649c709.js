"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[4597],{56984:function(e,t,i){i.d(t,{UW:function(){return I},_y:function(){return C}});var o=i(34441),n=i(54293),s=i(98299),r=i(20996),d=i(51280),c=i(38431),a=i(8964),l=i(35921),h=i(83915),u=i(35398),g=i(26386),v=i(71177),p=i(70499),f=i(36953),m=i(55495),_=i(68554),b=i(58566),A=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},y=function(e,t){return function(i,o){t(i,o,e)}},w=function(e,t,i,o){return new(i||(i=Promise))((function(n,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function d(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}c((o=o.apply(e,t||[])).next())}))};const C={Visible:new p.uy("CodeActionMenuVisible",!1,(0,g.NC)("CodeActionMenuVisible","Whether the code action list widget is visible"))};class S extends s.aU{constructor(e,t){super(e.command?e.command.id:e.title,e.title.replace(/\r\n|\r|\n/g," "),void 0,!e.disabled,t),this.action=e}}let E=class{constructor(e,t){this.acceptKeybindings=e,this.keybindingService=t}get templateId(){return"codeActionWidget"}renderTemplate(e){const t=Object.create(null);return t.disposables=[],t.root=e,t.text=document.createElement("span"),e.append(t.text),t}renderElement(e,t,i){const o=i,n=e.title,s=e.isEnabled,r=e.isSeparator,d=e.isDocumentation;if(o.text.textContent=n,s?o.root.classList.remove("option-disabled"):(o.root.classList.add("option-disabled"),o.root.style.backgroundColor="transparent !important"),r&&(o.root.classList.add("separator"),o.root.style.height="10px"),!d){(()=>{var e,t;const[i,n]=this.acceptKeybindings;o.root.title=(0,g.NC)({key:"label",comment:['placeholders are keybindings, e.g "F2 to Refactor, Shift+F2 to Preview"']},"{0} to Refactor, {1} to Preview",null===(e=this.keybindingService.lookupKeybinding(i))||void 0===e?void 0:e.getLabel(),null===(t=this.keybindingService.lookupKeybinding(n))||void 0===t?void 0:t.getLabel())})()}}disposeTemplate(e){e.disposables=(0,c.B9)(e.disposables)}};E=A([y(1,m.d)],E);let I=class e extends c.JT{constructor(e,t,i,o,n,s,r,d,a,l){super(),this._editor=e,this._delegate=t,this._contextMenuService=i,this._languageFeaturesService=n,this._telemetryService=s,this._configurationService=d,this._contextViewService=a,this._contextKeyService=l,this._showingActions=this._register(new c.XK),this.codeActionList=this._register(new c.XK),this.options=[],this._visible=!1,this.viewItems=[],this.hasSeperator=!1,this._keybindingResolver=new x({getKeybindings:()=>o.getKeybindings()}),this._ctxMenuWidgetVisible=C.Visible.bindTo(this._contextKeyService),this.listRenderer=new E(["onEnterSelectCodeAction","onEnterSelectCodeActionWithPreview"],o)}get isVisible(){return this._visible}isCodeActionWidgetEnabled(e){return this._configurationService.getValue("editor.experimental.useCustomCodeActionMenu",{resource:e.uri})}_onListSelection(e){e.elements.length&&e.elements.forEach((e=>{e.isEnabled&&(e.action.run(),this.hideCodeActionWidget())}))}_onListHover(e){var t,i,o,n;e.element?(null===(i=e.element)||void 0===i?void 0:i.isEnabled)?(null===(o=this.codeActionList.value)||void 0===o||o.setFocus([e.element.index]),this.focusedEnabledItem=this.viewItems.indexOf(e.element),this.currSelectedItem=e.element.index):(this.currSelectedItem=void 0,null===(n=this.codeActionList.value)||void 0===n||n.setFocus([e.element.index])):(this.currSelectedItem=void 0,null===(t=this.codeActionList.value)||void 0===t||t.setFocus([]))}renderCodeActionMenuList(t,i){var s;const r=new c.SL,d=document.createElement("div"),a=document.createElement("div");this.block=t.appendChild(a),this.block.classList.add("context-view-block"),this.block.style.position="fixed",this.block.style.cursor="initial",this.block.style.left="0",this.block.style.top="0",this.block.style.width="100%",this.block.style.height="100%",this.block.style.zIndex="-1",r.add(o.nm(this.block,o.tw.MOUSE_DOWN,(e=>e.stopPropagation()))),d.id="codeActionMenuWidget",d.classList.add("codeActionMenuWidget"),t.appendChild(d),this.codeActionList.value=new n.aV("codeActionWidget",d,{getHeight(e){return e.isSeparator?10:26},getTemplateId(e){return"codeActionWidget"}},[this.listRenderer],{keyboardSupport:!1}),r.add(this.codeActionList.value.onMouseOver((e=>this._onListHover(e)))),r.add(this.codeActionList.value.onDidChangeFocus((e=>{var t;return null===(t=this.codeActionList.value)||void 0===t?void 0:t.domFocus()}))),r.add(this.codeActionList.value.onDidChangeSelection((e=>this._onListSelection(e)))),r.add(this._editor.onDidLayoutChange((e=>this.hideCodeActionWidget()))),i.forEach(((t,o)=>{const n="separator"===t.class;let s=!1;t instanceof S&&(s=t.action.kind===e.documentationID),n&&(this.hasSeperator=!0);const r={title:t.label,detail:t.tooltip,action:i[o],isEnabled:t.enabled,isSeparator:n,index:o,isDocumentation:s};t.enabled&&this.viewItems.push(r),this.options.push(r)})),this.codeActionList.value.splice(0,this.codeActionList.value.length,this.options);const l=this.hasSeperator?26*(i.length-1)+10:26*i.length;d.style.height=String(l)+"px",this.codeActionList.value.layout(l);const h=[];this.options.forEach(((e,t)=>{var i,o;if(!this.codeActionList.value)return;const n=null===(o=document.getElementById(null===(i=this.codeActionList.value)||void 0===i?void 0:i.getElementID(t)))||void 0===o?void 0:o.getElementsByTagName("span")[0].offsetWidth;h.push(Number(n))}));const u=Math.max(...h);d.style.width=u+52+"px",null===(s=this.codeActionList.value)||void 0===s||s.layout(l,u),this.viewItems.length<1||this.viewItems.every((e=>e.isDocumentation))?this.currSelectedItem=void 0:(this.focusedEnabledItem=0,this.currSelectedItem=this.viewItems[0].index,this.codeActionList.value.setFocus([this.currSelectedItem])),this.codeActionList.value.domFocus();const g=o.go(t),v=g.onDidBlur((()=>{this.hideCodeActionWidget()}));return r.add(v),r.add(g),this._ctxMenuWidgetVisible.set(!0),r}focusPrevious(){var e;if(void 0===this.focusedEnabledItem)this.focusedEnabledItem=this.viewItems[0].index;else if(this.viewItems.length<1)return!1;const t=this.focusedEnabledItem;let i;do{this.focusedEnabledItem=this.focusedEnabledItem-1,this.focusedEnabledItem<0&&(this.focusedEnabledItem=this.viewItems.length-1),i=this.viewItems[this.focusedEnabledItem],null===(e=this.codeActionList.value)||void 0===e||e.setFocus([i.index]),this.currSelectedItem=i.index}while(this.focusedEnabledItem!==t&&(!i.isEnabled||i.action.id===s.Z0.ID));return!0}focusNext(){var e;if(void 0===this.focusedEnabledItem)this.focusedEnabledItem=this.viewItems.length-1;else if(this.viewItems.length<1)return!1;const t=this.focusedEnabledItem;let i;do{this.focusedEnabledItem=(this.focusedEnabledItem+1)%this.viewItems.length,i=this.viewItems[this.focusedEnabledItem],null===(e=this.codeActionList.value)||void 0===e||e.setFocus([i.index]),this.currSelectedItem=i.index}while(this.focusedEnabledItem!==t&&(!i.isEnabled||i.action.id===s.Z0.ID));return!0}navigateListWithKeysUp(){this.focusPrevious()}navigateListWithKeysDown(){this.focusNext()}onEnterSet(){var e;"number"==typeof this.currSelectedItem&&(null===(e=this.codeActionList.value)||void 0===e||e.setSelection([this.currSelectedItem]))}dispose(){super.dispose()}hideCodeActionWidget(){this._ctxMenuWidgetVisible.reset(),this.options=[],this.viewItems=[],this.focusedEnabledItem=0,this.currSelectedItem=void 0,this.hasSeperator=!1,this._contextViewService.hideContextView({source:this})}codeActionTelemetry(e,t,i){this._telemetryService.publicLog2("codeAction.applyCodeAction",{codeActionFrom:e,validCodeActions:i.validActions.length,cancelled:t})}show(e,t,i,o){return w(this,void 0,void 0,(function*(){const n=this._editor.getModel();if(!n)return;const s=o.includeDisabledActions?t.allActions:t.validActions;if(!s.length)return void(this._visible=!1);if(!this._editor.getDomNode())throw this._visible=!1,(0,r.F0)();this._visible=!0,this._showingActions.value=t;const d=this.getMenuActions(e,s,t.documentation),c=a.L.isIPosition(i)?this._toCoords(i):i||{x:0,y:0},l=this._keybindingResolver.getResolver(),h=this._editor.getOption(117);this.isCodeActionWidgetEnabled(n)?this._contextViewService.showContextView({getAnchor:()=>c,render:e=>this.renderCodeActionMenuList(e,d),onHide:i=>{const n=o.fromLightbulb?u.aQ.Lightbulb:e.triggerAction;this.codeActionTelemetry(n,i,t),this._visible=!1,this._editor.focus()}},this._editor.getDomNode(),!1):this._contextMenuService.showContextMenu({domForShadowRoot:h?this._editor.getDomNode():void 0,getAnchor:()=>c,getActions:()=>d,onHide:i=>{const n=o.fromLightbulb?u.aQ.Lightbulb:e.triggerAction;this.codeActionTelemetry(n,i,t),this._visible=!1,this._editor.focus()},autoSelectFirstItem:!0,getKeyBinding:e=>e instanceof S?l(e.action):void 0})}))}getMenuActions(t,i,o){var n,r;const d=e=>new S(e.action,(()=>this._delegate.onSelectCodeAction(e,t))),c=i.map(d),a=[...o],l=this._editor.getModel();if(l&&c.length)for(const e of this._languageFeaturesService.codeActionProvider.all(l))e._getAdditionalMenuItems&&a.push(...e._getAdditionalMenuItems({trigger:t.type,only:null===(r=null===(n=t.filter)||void 0===n?void 0:n.include)||void 0===r?void 0:r.value},i.map((e=>e.action))));return a.length&&c.push(new s.Z0,...a.map((t=>d(new h.bA({title:t.title,command:t,kind:e.documentationID},void 0))))),c}_toCoords(e){if(!this._editor.hasModel())return{x:0,y:0};this._editor.revealPosition(e,1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(e),i=o.i(this._editor.getDomNode());return{x:i.left+t.left,y:i.top+t.top+t.height}}};I.documentationID="_documentation",I=A([y(2,f.i),y(3,m.d),y(4,l.p),y(5,_.b),y(6,b.XE),y(7,v.Ui),y(8,f.u),y(9,p.i6)],I);class x{constructor(e){this._keybindingProvider=e}getResolver(){const e=new d.o((()=>this._keybindingProvider.getKeybindings().filter((e=>x.codeActionCommands.indexOf(e.command)>=0)).filter((e=>e.resolvedKeybinding)).map((e=>{let t=e.commandArgs;return e.command===h.uH?t={kind:u.yN.SourceOrganizeImports.value}:e.command===h.TM&&(t={kind:u.yN.SourceFixAll.value}),Object.assign({resolvedKeybinding:e.resolvedKeybinding},u.wZ.fromUser(t,{kind:u.yN.None,apply:"never"}))}))));return t=>{if(t.kind){const i=this.bestKeybindingForCodeAction(t,e.getValue());return null==i?void 0:i.resolvedKeybinding}}}bestKeybindingForCodeAction(e,t){if(!e.kind)return;const i=new u.yN(e.kind);return t.filter((e=>e.kind.contains(i))).filter((t=>!t.preferred||e.isPreferred)).reduceRight(((e,t)=>e?e.kind.contains(t.kind)?t:e:t),void 0)}}x.codeActionCommands=[h.Bb,h.RB,h.MN,h.uH,h.TM]},37295:function(e,t,i){i.d(t,{Jt:function(){return A},fj:function(){return f}});var o,n=i(13484),s=i(20996),r=i(56709),d=i(38431),c=i(6227),a=i(50038),l=i(70499),h=i(79969),u=i(83915),g=i(35398),v=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)},p=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i};const f=new l.uy("supportedCodeAction","");class m extends d.JT{constructor(e,t,i,o=250){super(),this._editor=e,this._markerService=t,this._signalChange=i,this._delay=o,this._autoTriggerTimer=this._register(new n._F),this._register(this._markerService.onMarkerChanged((e=>this._onMarkerChanges(e)))),this._register(this._editor.onDidChangeCursorPosition((()=>this._onCursorChange())))}trigger(e){const t=this._getRangeOfSelectionUnlessWhitespaceEnclosed(e);return this._createEventAndSignalChange(e,t)}_onMarkerChanges(e){const t=this._editor.getModel();t&&e.some((e=>(0,c.Xy)(e,t.uri)))&&this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2,triggerAction:g.aQ.Default})}),this._delay)}_onCursorChange(){this._autoTriggerTimer.cancelAndSet((()=>{this.trigger({type:2,triggerAction:g.aQ.Default})}),this._delay)}_getRangeOfMarker(e){const t=this._editor.getModel();if(t)for(const i of this._markerService.read({resource:t.uri})){const o=t.validateRange(i);if(a.e.intersectRanges(o,e))return a.e.lift(o)}}_getRangeOfSelectionUnlessWhitespaceEnclosed(e){if(!this._editor.hasModel())return;const t=this._editor.getModel(),i=this._editor.getSelection();if(i.isEmpty()&&2===e.type){const{lineNumber:e,column:o}=i.getPosition(),n=t.getLineContent(e);if(0===n.length)return;if(1===o){if(/\s/.test(n[0]))return}else if(o===t.getLineMaxColumn(e)){if(/\s/.test(n[n.length-1]))return}else if(/\s/.test(n[o-2])&&/\s/.test(n[o-1]))return}return i}_createEventAndSignalChange(e,t){const i=this._editor.getModel();if(!t||!i)return void this._signalChange(void 0);const o=this._getRangeOfMarker(t),n=o?o.getStartPosition():t.getStartPosition(),s={trigger:e,selection:t,position:n};return this._signalChange(s),s}}var _;!function(e){e.Empty={type:0};e.Triggered=class{constructor(e,t,i,o){this.trigger=e,this.rangeOrSelection=t,this.position=i,this._cancellablePromise=o,this.type=1,this.actions=o.catch((e=>{if((0,s.n2)(e))return b;throw e}))}cancel(){this._cancellablePromise.cancel()}}}(_||(_={}));const b={allActions:[],validActions:[],dispose:()=>{},documentation:[],hasAutoFix:!1};class A extends d.JT{constructor(e,t,i,n,s){super(),this._editor=e,this._registry=t,this._markerService=i,this._progressService=s,this._codeActionOracle=this._register(new d.XK),this._state=_.Empty,this._onDidChangeState=this._register(new r.Q5),this.onDidChangeState=this._onDidChangeState.event,o.set(this,!1),this._supportedCodeActions=f.bindTo(n),this._register(this._editor.onDidChangeModel((()=>this._update()))),this._register(this._editor.onDidChangeModelLanguage((()=>this._update()))),this._register(this._registry.onDidChange((()=>this._update()))),this._update()}dispose(){v(this,o,"f")||(p(this,o,!0,"f"),super.dispose(),this.setState(_.Empty,!0))}_update(){if(v(this,o,"f"))return;this._codeActionOracle.value=void 0,this.setState(_.Empty);const e=this._editor.getModel();if(e&&this._registry.has(e)&&!this._editor.getOption(83)){const t=[];for(const i of this._registry.all(e))Array.isArray(i.providedCodeActionKinds)&&t.push(...i.providedCodeActionKinds);this._supportedCodeActions.set(t.join(" ")),this._codeActionOracle.value=new m(this._editor,this._markerService,(t=>{var i;if(!t)return void this.setState(_.Empty);const o=(0,n.PG)((i=>(0,u.aI)(this._registry,e,t.selection,t.trigger,h.Ex.None,i)));1===t.trigger.type&&(null===(i=this._progressService)||void 0===i||i.showWhile(o,250)),this.setState(new _.Triggered(t.trigger,t.selection,t.position,o))}),void 0),this._codeActionOracle.value.trigger({type:2,triggerAction:g.aQ.Default})}else this._supportedCodeActions.reset()}trigger(e){var t;null===(t=this._codeActionOracle.value)||void 0===t||t.trigger(e)}setState(e,t){e!==this._state&&(1===this._state.type&&this._state.cancel(),this._state=e,t||v(this,o,"f")||this._onDidChangeState.fire(e))}}o=new WeakMap},33135:function(e,t,i){i.d(t,{b:function(){return f}});var o,n=i(20996),s=i(51280),r=i(38431),d=i(15263),c=i(44333),a=i(56984),l=i(82605),h=function(e,t,i,o){var n,s=arguments.length,r=s<3?t:null===o?o=Object.getOwnPropertyDescriptor(t,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,o);else for(var d=e.length-1;d>=0;d--)(n=e[d])&&(r=(s<3?n(r):s>3?n(t,i,r):n(t,i))||r);return s>3&&r&&Object.defineProperty(t,i,r),r},u=function(e,t){return function(i,o){t(i,o,e)}},g=function(e,t,i,o){return new(i||(i=Promise))((function(n,s){function r(e){try{c(o.next(e))}catch(e){s(e)}}function d(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(r,d)}c((o=o.apply(e,t||[])).next())}))},v=function(e,t,i,o,n){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!n)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?n.call(e,i):n?n.value=i:t.set(e,i),i},p=function(e,t,i,o){if("a"===i&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===i?o:"a"===i?o.call(e):o?o.value:t.get(e)};let f=class extends r.JT{constructor(e,t,i,n,d){super(),this._editor=e,this.delegate=n,this._activeCodeActions=this._register(new r.XK),this.previewOn=!1,o.set(this,!1),this._codeActionWidget=new s.o((()=>this._register(d.createInstance(a.UW,this._editor,{onSelectCodeAction:(e,t)=>g(this,void 0,void 0,(function*(){this.previewOn?this.delegate.applyCodeAction(e,!0,Boolean(this.previewOn)):this.delegate.applyCodeAction(e,!0,Boolean(t.preview)),this.previewOn=!1}))})))),this._lightBulbWidget=new s.o((()=>{const e=this._register(d.createInstance(l.f,this._editor,t,i));return this._register(e.onClick((e=>this.showCodeActionList(e.trigger,e.actions,e,{includeDisabledActions:!1,fromLightbulb:!0})))),e}))}dispose(){v(this,o,!0,"f"),super.dispose()}hideCodeActionWidget(){this._codeActionWidget.hasValue()&&this._codeActionWidget.getValue().hideCodeActionWidget()}onEnter(){this._codeActionWidget.hasValue()&&this._codeActionWidget.getValue().onEnterSet()}onPreviewEnter(){this.previewOn=!0,this.onEnter()}navigateList(e){this._codeActionWidget.hasValue()&&(e?this._codeActionWidget.getValue().navigateListWithKeysUp():this._codeActionWidget.getValue().navigateListWithKeysDown())}update(e){var t,i,s,r,c;return g(this,void 0,void 0,(function*(){if(1!==e.type)return void(null===(t=this._lightBulbWidget.rawValue)||void 0===t||t.hide());let a;try{a=yield e.actions}catch(e){return void(0,n.dL)(e)}if(!p(this,o,"f"))if(this._lightBulbWidget.getValue().update(a,e.trigger,e.position),1===e.trigger.type){if(null===(i=e.trigger.filter)||void 0===i?void 0:i.include){const t=this.tryGetValidActionToApply(e.trigger,a);if(t){try{this._lightBulbWidget.getValue().hide(),yield this.delegate.applyCodeAction(t,!1,!1)}finally{a.dispose()}return}if(e.trigger.context){const t=this.getInvalidActionThatWouldHaveBeenApplied(e.trigger,a);if(t&&t.action.disabled)return null===(s=d.O.get(this._editor))||void 0===s||s.showMessage(t.action.disabled,e.trigger.context.position),void a.dispose()}}const t=!!(null===(r=e.trigger.filter)||void 0===r?void 0:r.include);if(e.trigger.context&&(!a.allActions.length||!t&&!a.validActions.length))return null===(c=d.O.get(this._editor))||void 0===c||c.showMessage(e.trigger.context.notAvailableMessage,e.trigger.context.position),this._activeCodeActions.value=a,void a.dispose();this._activeCodeActions.value=a,this._codeActionWidget.getValue().show(e.trigger,a,e.position,{includeDisabledActions:t,fromLightbulb:!1})}else this._codeActionWidget.getValue().isVisible?a.dispose():this._activeCodeActions.value=a}))}getInvalidActionThatWouldHaveBeenApplied(e,t){if(t.allActions.length)return"first"===e.autoApply&&0===t.validActions.length||"ifSingle"===e.autoApply&&1===t.allActions.length?t.allActions.find((({action:e})=>e.disabled)):void 0}tryGetValidActionToApply(e,t){if(t.validActions.length)return"first"===e.autoApply&&t.validActions.length>0||"ifSingle"===e.autoApply&&1===t.validActions.length?t.validActions[0]:void 0}showCodeActionList(e,t,i,o){return g(this,void 0,void 0,(function*(){this._codeActionWidget.getValue().show(e,t,i,o)}))}};o=new WeakMap,f=h([u(4,c.TG)],f)},55182:function(e,t,i){var o=i(86689),n=i(26386),s=i(12326);i(6325).B.as(s.IP.Configuration).registerConfiguration(Object.assign(Object.assign({},o.wk),{properties:{"editor.experimental.useCustomCodeActionMenu":{type:"boolean",tags:["experimental"],scope:5,description:n.NC("codeActionWidget","Enabling this adjusts how the code action menu is rendered."),default:!1}}}))}}]);