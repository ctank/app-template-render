"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[3664],{32093:function(t,e,i){i.d(e,{H:function(){return y}});var s=i(26386),o=i(71488),n=i(34733),r=i(11138),l=i(17416),a=i(71344),h=i(10521),d=i(60153),c=i(85253),u=i(83981),_=i(32207),g=i(70054),p=i(31599),x=i(8964),m=i(50038),A=i(57841),f=i(89531),b=i(16012),v=i(86741);class C{constructor(t,e,i,s,o){this._context=t,this.modelLineNumber=e,this.distanceToModelLineStart=i,this.widthOfHiddenLineTextBefore=s,this.distanceToModelLineEnd=o,this._visibleTextAreaBrand=void 0,this.startPosition=null,this.endPosition=null,this.visibleTextareaStart=null,this.visibleTextareaEnd=null,this._previousPresentation=null}prepareRender(t){const e=new x.L(this.modelLineNumber,this.distanceToModelLineStart+1),i=new x.L(this.modelLineNumber,this._context.viewModel.model.getLineMaxColumn(this.modelLineNumber)-this.distanceToModelLineEnd);this.startPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(e),this.endPosition=this._context.viewModel.coordinatesConverter.convertModelPositionToViewPosition(i),this.startPosition.lineNumber===this.endPosition.lineNumber?(this.visibleTextareaStart=t.visibleRangeForPosition(this.startPosition),this.visibleTextareaEnd=t.visibleRangeForPosition(this.endPosition)):(this.visibleTextareaStart=null,this.visibleTextareaEnd=null)}definePresentation(t){return this._previousPresentation||(this._previousPresentation=t||{foreground:1,italic:!1,bold:!1,underline:!1,strikethrough:!1}),this._previousPresentation}}const w=o.isFirefox;class y extends c.E{constructor(t,e,i){super(t),this._primaryCursorPosition=new x.L(1,1),this._primaryCursorVisibleRange=null,this._viewController=e,this._visibleRangeProvider=i,this._scrollLeft=0,this._scrollTop=0;const l=this._context.configuration.options,u=l.get(133);this._setAccessibilityOptions(l),this._contentLeft=u.contentLeft,this._contentWidth=u.contentWidth,this._contentHeight=u.height,this._fontInfo=l.get(46),this._lineHeight=l.get(61),this._emptySelectionClipboard=l.get(33),this._copyWithSyntaxHighlighting=l.get(21),this._visibleTextArea=null,this._selections=[new A.Y(1,1,1,1)],this._modelSelections=[new A.Y(1,1,1,1)],this._lastRenderPosition=null,this.textArea=(0,n.X)(document.createElement("textarea")),c.K.write(this.textArea,6),this.textArea.setClassName(`inputarea ${f.S}`),this.textArea.setAttribute("wrap","off"),this.textArea.setAttribute("autocorrect","off"),this.textArea.setAttribute("autocapitalize","off"),this.textArea.setAttribute("autocomplete","off"),this.textArea.setAttribute("spellcheck","false"),this.textArea.setAttribute("aria-label",this._getAriaLabel(l)),this.textArea.setAttribute("tabindex",String(l.get(114))),this.textArea.setAttribute("role","textbox"),this.textArea.setAttribute("aria-roledescription",s.NC("editor","editor")),this.textArea.setAttribute("aria-multiline","true"),this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),l.get(30)&&l.get(83)&&this.textArea.setAttribute("readonly","true"),this.textAreaCover=(0,n.X)(document.createElement("div")),this.textAreaCover.setPosition("absolute");const _={getLineCount:()=>this._context.viewModel.getLineCount(),getLineMaxColumn:t=>this._context.viewModel.getLineMaxColumn(t),getValueInRange:(t,e)=>this._context.viewModel.getValueInRange(t,e)},g={getDataToCopy:()=>{const t=this._context.viewModel.getPlainTextToCopy(this._modelSelections,this._emptySelectionClipboard,r.ED),e=this._context.viewModel.model.getEOL(),i=this._emptySelectionClipboard&&1===this._modelSelections.length&&this._modelSelections[0].isEmpty(),s=Array.isArray(t)?t:null,o=Array.isArray(t)?t.join(e):t;let n,l=null;if(h.RA.forceCopyWithSyntaxHighlighting||this._copyWithSyntaxHighlighting&&o.length<65536){const t=this._context.viewModel.getRichTextToCopy(this._modelSelections,this._emptySelectionClipboard);t&&(n=t.html,l=t.mode)}return{isFromEmptySelection:i,multicursorText:s,text:o,html:n,mode:l}},getScreenReaderContent:t=>{if(1===this._accessibilitySupport){const t=this._selections[0];if(r.dz&&t.isEmpty()){const e=t.getStartPosition();let i=this._getWordBeforePosition(e);if(0===i.length&&(i=this._getCharacterBeforePosition(e)),i.length>0)return new d.un(i,i.length,i.length,e,e)}if(o.isSafari&&!t.isEmpty()){const t="vscode-placeholder";return new d.un(t,0,t.length,null,null)}return d.un.EMPTY}if(o.isAndroid){const t=this._selections[0];if(t.isEmpty()){const e=t.getStartPosition(),[i,s]=this._getAndroidWordAtPosition(e);if(i.length>0)return new d.un(i,s,s,e,e)}return d.un.EMPTY}return d.ee.fromEditorSelection(t,_,this._selections[0],this._accessibilityPageSize,0===this._accessibilitySupport)},deduceModelPosition:(t,e,i)=>this._context.viewModel.deduceModelPositionRelativeToViewPosition(t,e,i)},p=this._register(new h.Tj(this.textArea.domNode));this._textAreaInput=this._register(new h.Fz(g,p,r.OS,o)),this._register(this._textAreaInput.onKeyDown((t=>{this._viewController.emitKeyDown(t)}))),this._register(this._textAreaInput.onKeyUp((t=>{this._viewController.emitKeyUp(t)}))),this._register(this._textAreaInput.onPaste((t=>{let e=!1,i=null,s=null;t.metadata&&(e=this._emptySelectionClipboard&&!!t.metadata.isFromEmptySelection,i=void 0!==t.metadata.multicursorText?t.metadata.multicursorText:null,s=t.metadata.mode),this._viewController.paste(t.text,e,i,s)}))),this._register(this._textAreaInput.onCut((()=>{this._viewController.cut()}))),this._register(this._textAreaInput.onType((t=>{t.replacePrevCharCnt||t.replaceNextCharCnt||t.positionDelta?(d.al,this._viewController.compositionType(t.text,t.replacePrevCharCnt,t.replaceNextCharCnt,t.positionDelta)):(d.al,this._viewController.type(t.text))}))),this._register(this._textAreaInput.onSelectionChangeRequest((t=>{this._viewController.setSelection(t)}))),this._register(this._textAreaInput.onCompositionStart((t=>{const e=this.textArea.domNode,i=this._modelSelections[0],{distanceToModelLineStart:s,widthOfHiddenTextBefore:o}=(()=>{const t=e.value.substring(0,Math.min(e.selectionStart,e.selectionEnd)),s=t.lastIndexOf("\n"),o=t.substring(s+1),n=o.lastIndexOf("\t"),r=o.length-n-1,l=i.getStartPosition(),h=Math.min(l.column-1,r);return{distanceToModelLineStart:l.column-1-h,widthOfHiddenTextBefore:function(t,e){if(0===t.length)return 0;const i=document.createElement("div");i.style.position="absolute",i.style.top="-50000px",i.style.width="50000px";const s=document.createElement("span");(0,a.N)(s,e),s.style.whiteSpace="pre",s.append(t),i.appendChild(s),document.body.appendChild(i);const o=s.offsetWidth;return document.body.removeChild(i),o}(o.substring(0,o.length-h),this._fontInfo)}})(),{distanceToModelLineEnd:n}=(()=>{const t=e.value.substring(Math.max(e.selectionStart,e.selectionEnd)),s=t.indexOf("\n"),o=-1===s?t:t.substring(0,s),n=o.indexOf("\t"),r=-1===n?o.length:o.length-n-1,l=i.getEndPosition(),a=Math.min(this._context.viewModel.model.getLineMaxColumn(l.lineNumber)-l.column,r);return{distanceToModelLineEnd:this._context.viewModel.model.getLineMaxColumn(l.lineNumber)-l.column-a}})();this._context.viewModel.revealRange("keyboard",!0,m.e.fromPositions(this._selections[0].getStartPosition()),0,1),this._visibleTextArea=new C(this._context,i.startLineNumber,s,o,n),this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render(),this.textArea.setClassName(`inputarea ${f.S} ime-input`),this._viewController.compositionStart(),this._context.viewModel.onCompositionStart()}))),this._register(this._textAreaInput.onCompositionUpdate((t=>{this._visibleTextArea&&(this._visibleTextArea.prepareRender(this._visibleRangeProvider),this._render())}))),this._register(this._textAreaInput.onCompositionEnd((()=>{this._visibleTextArea=null,this._render(),this.textArea.setClassName(`inputarea ${f.S}`),this._viewController.compositionEnd(),this._context.viewModel.onCompositionEnd()}))),this._register(this._textAreaInput.onFocus((()=>{this._context.viewModel.setHasFocus(!0)}))),this._register(this._textAreaInput.onBlur((()=>{this._context.viewModel.setHasFocus(!1)})))}dispose(){super.dispose()}_getAndroidWordAtPosition(t){const e=this._context.viewModel.getLineContent(t.lineNumber),i=(0,p.u)('`~!@#$%^&*()-=+[{]}\\|;:",.<>/?');let s=!0,o=t.column,n=!0,r=t.column,l=0;for(;l<50&&(s||n);){if(s&&o<=1&&(s=!1),s){const t=e.charCodeAt(o-2);0!==i.get(t)?s=!1:o--}if(n&&r>e.length&&(n=!1),n){const t=e.charCodeAt(r-1);0!==i.get(t)?n=!1:r++}l++}return[e.substring(o-1,r-1),t.column-o]}_getWordBeforePosition(t){const e=this._context.viewModel.getLineContent(t.lineNumber),i=(0,p.u)(this._context.configuration.options.get(119));let s=t.column,o=0;for(;s>1;){const n=e.charCodeAt(s-2);if(0!==i.get(n)||o>50)return e.substring(s-1,t.column-1);o++,s--}return e.substring(0,t.column-1)}_getCharacterBeforePosition(t){if(t.column>1){const e=this._context.viewModel.getLineContent(t.lineNumber).charAt(t.column-2);if(!l.ZG(e.charCodeAt(0)))return e}return""}_getAriaLabel(t){return 1===t.get(2)?s.NC("accessibilityOffAriaLabel","The editor is not accessible at this time. Press {0} for options.",r.IJ?"Shift+Alt+F1":"Alt+F1"):t.get(4)}_setAccessibilityOptions(t){this._accessibilitySupport=t.get(2);const e=t.get(3);2===this._accessibilitySupport&&e===g.BH.accessibilityPageSize.defaultValue?this._accessibilityPageSize=500:this._accessibilityPageSize=e}onConfigurationChanged(t){const e=this._context.configuration.options,i=e.get(133);return this._setAccessibilityOptions(e),this._contentLeft=i.contentLeft,this._contentWidth=i.contentWidth,this._contentHeight=i.height,this._fontInfo=e.get(46),this._lineHeight=e.get(61),this._emptySelectionClipboard=e.get(33),this._copyWithSyntaxHighlighting=e.get(21),this.textArea.setAttribute("aria-label",this._getAriaLabel(e)),this.textArea.setAttribute("tabindex",String(e.get(114))),(t.hasChanged(30)||t.hasChanged(83))&&(e.get(30)&&e.get(83)?this.textArea.setAttribute("readonly","true"):this.textArea.removeAttribute("readonly")),t.hasChanged(2)&&this._textAreaInput.writeScreenReaderContent("strategy changed"),!0}onCursorStateChanged(t){return this._selections=t.selections.slice(0),this._modelSelections=t.modelSelections.slice(0),this._textAreaInput.writeScreenReaderContent("selection changed"),!0}onDecorationsChanged(t){return!0}onFlushed(t){return!0}onLinesChanged(t){return!0}onLinesDeleted(t){return!0}onLinesInserted(t){return!0}onScrollChanged(t){return this._scrollLeft=t.scrollLeft,this._scrollTop=t.scrollTop,!0}onZonesChanged(t){return!0}isFocused(){return this._textAreaInput.isFocused()}focusTextArea(){this._textAreaInput.focusTextArea()}getLastRenderData(){return this._lastRenderPosition}setAriaOptions(t){t.activeDescendant?(this.textArea.setAttribute("aria-haspopup","true"),this.textArea.setAttribute("aria-autocomplete","list"),this.textArea.setAttribute("aria-activedescendant",t.activeDescendant)):(this.textArea.setAttribute("aria-haspopup","false"),this.textArea.setAttribute("aria-autocomplete","both"),this.textArea.removeAttribute("aria-activedescendant")),t.role&&this.textArea.setAttribute("role",t.role)}prepareRender(t){var e;this._primaryCursorPosition=new x.L(this._selections[0].positionLineNumber,this._selections[0].positionColumn),this._primaryCursorVisibleRange=t.visibleRangeForPosition(this._primaryCursorPosition),null===(e=this._visibleTextArea)||void 0===e||e.prepareRender(t)}render(t){this._textAreaInput.writeScreenReaderContent("render"),this._render()}_render(){if(this._visibleTextArea){const t=this._visibleTextArea.visibleTextareaStart,e=this._visibleTextArea.visibleTextareaEnd,i=this._visibleTextArea.startPosition,s=this._visibleTextArea.endPosition;if(i&&s&&t&&e&&e.left>=this._scrollLeft&&t.left<=this._scrollLeft+this._contentWidth){const o=this._context.viewLayout.getVerticalOffsetForLineNumber(this._primaryCursorPosition.lineNumber)-this._scrollTop,n=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));let r=this._visibleTextArea.widthOfHiddenLineTextBefore,l=this._contentLeft+t.left-this._scrollLeft,a=e.left-t.left+1;if(l<this._contentLeft){const t=this._contentLeft-l;l+=t,r+=t,a-=t}a>this._contentWidth&&(a=this._contentWidth);const h=this._context.viewModel.getViewLineData(i.lineNumber),d=h.tokens.findTokenIndexAtOffset(i.column-1),c=d===h.tokens.findTokenIndexAtOffset(s.column-1),u=this._visibleTextArea.definePresentation(c?h.tokens.getPresentation(d):null);this.textArea.domNode.scrollTop=n*this._lineHeight,this.textArea.domNode.scrollLeft=r,this._doRender({lastRenderPosition:null,top:o,left:l,width:a,height:this._lineHeight,useCover:!1,color:(b.RW.getColorMap()||[])[u.foreground],italic:u.italic,bold:u.bold,underline:u.underline,strikethrough:u.strikethrough})}return}if(!this._primaryCursorVisibleRange)return void this._renderAtTopLeft();const t=this._contentLeft+this._primaryCursorVisibleRange.left-this._scrollLeft;if(t<this._contentLeft||t>this._contentLeft+this._contentWidth)return void this._renderAtTopLeft();const e=this._context.viewLayout.getVerticalOffsetForLineNumber(this._selections[0].positionLineNumber)-this._scrollTop;if(e<0||e>this._contentHeight)this._renderAtTopLeft();else if(r.dz){this._doRender({lastRenderPosition:this._primaryCursorPosition,top:e,left:t,width:w?0:1,height:this._lineHeight,useCover:!1}),this.textArea.domNode.scrollLeft=this._primaryCursorVisibleRange.left;const i=this._newlinecount(this.textArea.domNode.value.substr(0,this.textArea.domNode.selectionStart));this.textArea.domNode.scrollTop=i*this._lineHeight}else this._doRender({lastRenderPosition:this._primaryCursorPosition,top:e,left:t,width:w?0:1,height:w?0:1,useCover:!1})}_newlinecount(t){let e=0,i=-1;for(;;){if(i=t.indexOf("\n",i+1),-1===i)break;e++}return e}_renderAtTopLeft(){this._doRender({lastRenderPosition:null,top:0,left:0,width:w?0:1,height:w?0:1,useCover:!0})}_doRender(t){this._lastRenderPosition=t.lastRenderPosition;const e=this.textArea,i=this.textAreaCover;(0,a.N)(e,this._fontInfo),e.setTop(t.top),e.setLeft(t.left),e.setWidth(t.width),e.setHeight(t.height),e.setColor(t.color?v.Il.Format.CSS.formatHex(t.color):""),e.setFontStyle(t.italic?"italic":""),t.bold&&e.setFontWeight("bold"),e.setTextDecoration(`${t.underline?" underline":""}${t.strikethrough?" line-through":""}`),i.setTop(t.useCover?t.top:0),i.setLeft(t.useCover?t.left:0),i.setWidth(t.useCover?t.width:0),i.setHeight(t.useCover?t.height:0);const s=this._context.configuration.options;s.get(52)?i.setClassName("monaco-editor-background textAreaCover "+_.Z.OUTER_CLASS_NAME):0!==s.get(62).renderType?i.setClassName("monaco-editor-background textAreaCover "+u.x.CLASS_NAME):i.setClassName("monaco-editor-background textAreaCover")}}}}]);