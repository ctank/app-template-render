"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[9701],{13389:function(e,t,i){i.r(t),i.d(t,{MarkerController:function(){return re},NextMarkerAction:function(){return se}});var r=i(407),o=i(38431),s=i(55298),n=i(5603),a=i(8964),l=i(50038),d=i(21081),h=i(16308),c=i(56709),g=i(17979),_=i(17416),u=i(28919),m=i(53061),p=i(44333),k=i(36156),v=i(71177),f=function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n},b=function(e,t){return function(i,r){t(i,r,e)}};class x{constructor(e,t,i){this.marker=e,this.index=t,this.total=i}}let C=class{constructor(e,t,i){this._markerService=t,this._configService=i,this._onDidChange=new c.Q5,this.onDidChange=this._onDidChange.event,this._dispoables=new o.SL,this._markers=[],this._nextIdx=-1,u.o.isUri(e)?this._resourceFilter=t=>t.toString()===e.toString():e&&(this._resourceFilter=e);const r=this._configService.getValue("problems.sortOrder"),s=(e,t)=>{let i=(0,_.qu)(e.resource.toString(),t.resource.toString());return 0===i&&(i="position"===r?l.e.compareRangesUsingStarts(e,t)||k.ZL.compare(e.severity,t.severity):k.ZL.compare(e.severity,t.severity)||l.e.compareRangesUsingStarts(e,t)),i},n=()=>{this._markers=this._markerService.read({resource:u.o.isUri(e)?e:void 0,severities:k.ZL.Error|k.ZL.Warning|k.ZL.Info}),"function"==typeof e&&(this._markers=this._markers.filter((e=>this._resourceFilter(e.resource)))),this._markers.sort(s)};n(),this._dispoables.add(t.onMarkerChanged((e=>{this._resourceFilter&&!e.some((e=>this._resourceFilter(e)))||(n(),this._nextIdx=-1,this._onDidChange.fire())})))}dispose(){this._dispoables.dispose(),this._onDidChange.dispose()}matches(e){return!this._resourceFilter&&!e||!(!this._resourceFilter||!e)&&this._resourceFilter(e)}get selected(){const e=this._markers[this._nextIdx];return e&&new x(e,this._nextIdx+1,this._markers.length)}_initIdx(e,t,i){let r=!1,o=this._markers.findIndex((t=>t.resource.toString()===e.uri.toString()));o<0&&(o=(0,h.ry)(this._markers,{resource:e.uri},((e,t)=>(0,_.qu)(e.resource.toString(),t.resource.toString()))),o<0&&(o=~o));for(let i=o;i<this._markers.length;i++){let o=l.e.lift(this._markers[i]);if(o.isEmpty()){const t=e.getWordAtPosition(o.getStartPosition());t&&(o=new l.e(o.startLineNumber,t.startColumn,o.startLineNumber,t.endColumn))}if(t&&(o.containsPosition(t)||t.isBeforeOrEqual(o.getStartPosition()))){this._nextIdx=i,r=!0;break}if(this._markers[i].resource.toString()!==e.uri.toString())break}r||(this._nextIdx=i?0:this._markers.length-1),this._nextIdx<0&&(this._nextIdx=this._markers.length-1)}resetIndex(){this._nextIdx=-1}move(e,t,i){if(0===this._markers.length)return!1;const r=this._nextIdx;return-1===this._nextIdx?this._initIdx(t,i,e):e?this._nextIdx=(this._nextIdx+1)%this._markers.length:e||(this._nextIdx=(this._nextIdx-1+this._markers.length)%this._markers.length),r!==this._nextIdx}find(e,t){let i=this._markers.findIndex((t=>t.resource.toString()===e.toString()));if(!(i<0))for(;i<this._markers.length;i++)if(l.e.containsPosition(this._markers[i],t))return new x(this._markers[i],i+1,this._markers.length)}};C=f([b(1,k.lT),b(2,v.Ui)],C);const w=(0,p.yh)("IMarkerNavigationService");let y=class{constructor(e,t){this._markerService=e,this._configService=t,this._provider=new g.S}getMarkerList(e){for(const t of this._provider){const i=t.getMarkerList(e);if(i)return i}return new C(e,this._markerService,this._configService)}};y=f([b(0,k.lT),b(1,v.Ui)],y),(0,m.z)(w,y,!0);var L=i(26386),I=i(21208),S=i(70499),N=i(89528),M=i(34441),D=i(28638),E=i(86741),P=i(6227),B=i(12139),O=i(56797),R=i(18680),T=i(48786),W=i(63481),A=i(92537),F=i(58566),G=function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n},H=function(e,t){return function(i,r){t(i,r,e)}};class Z{constructor(e,t,i,r,s){this._openerService=r,this._labelService=s,this._lines=0,this._longestLineLength=0,this._relatedDiagnostics=new WeakMap,this._disposables=new o.SL,this._editor=t;const n=document.createElement("div");n.className="descriptioncontainer",this._messageBlock=document.createElement("div"),this._messageBlock.classList.add("message"),this._messageBlock.setAttribute("aria-live","assertive"),this._messageBlock.setAttribute("role","alert"),n.appendChild(this._messageBlock),this._relatedBlock=document.createElement("div"),n.appendChild(this._relatedBlock),this._disposables.add(M.mu(this._relatedBlock,"click",(e=>{e.preventDefault();const t=this._relatedDiagnostics.get(e.target);t&&i(t)}))),this._scrollable=new D.NB(n,{horizontal:1,vertical:1,useShadows:!1,horizontalScrollbarSize:6,verticalScrollbarSize:6}),e.appendChild(this._scrollable.getDomNode()),this._disposables.add(this._scrollable.onScroll((e=>{n.style.left=`-${e.scrollLeft}px`,n.style.top=`-${e.scrollTop}px`}))),this._disposables.add(this._scrollable)}dispose(){(0,o.B9)(this._disposables)}update(e){const{source:t,message:i,relatedInformation:r,code:o}=e;let s=((null==t?void 0:t.length)||0)+"()".length;o&&(s+="string"==typeof o?o.length:o.value.length);const n=(0,_.uq)(i);this._lines=n.length,this._longestLineLength=0;for(const e of n)this._longestLineLength=Math.max(e.length+s,this._longestLineLength);M.PO(this._messageBlock),this._messageBlock.setAttribute("aria-label",this.getAriaLabel(e)),this._editor.applyFontInfo(this._messageBlock);let a=this._messageBlock;for(const e of n)a=document.createElement("div"),a.innerText=e,""===e&&(a.style.height=this._messageBlock.style.lineHeight),this._messageBlock.appendChild(a);if(t||o){const e=document.createElement("span");if(e.classList.add("details"),a.appendChild(e),t){const i=document.createElement("span");i.innerText=t,i.classList.add("source"),e.appendChild(i)}if(o)if("string"==typeof o){const t=document.createElement("span");t.innerText=`(${o})`,t.classList.add("code"),e.appendChild(t)}else{this._codeLink=M.$("a.code-link"),this._codeLink.setAttribute("href",`${o.target.toString()}`),this._codeLink.onclick=e=>{this._openerService.open(o.target,{allowCommands:!0}),e.preventDefault(),e.stopPropagation()};M.R3(this._codeLink,M.$("span")).innerText=o.value,e.appendChild(this._codeLink)}}if(M.PO(this._relatedBlock),this._editor.applyFontInfo(this._relatedBlock),(0,h.Of)(r)){const e=this._relatedBlock.appendChild(document.createElement("div"));e.style.paddingTop=`${Math.floor(.66*this._editor.getOption(61))}px`,this._lines+=1;for(const t of r){const i=document.createElement("div"),r=document.createElement("a");r.classList.add("filename"),r.innerText=`${this._labelService.getUriBasenameLabel(t.resource)}(${t.startLineNumber}, ${t.startColumn}): `,r.title=this._labelService.getUriLabel(t.resource),this._relatedDiagnostics.set(r,t);const o=document.createElement("span");o.innerText=t.message,i.appendChild(r),i.appendChild(o),this._lines+=1,e.appendChild(i)}}const l=this._editor.getOption(46),d=Math.ceil(l.typicalFullwidthCharacterWidth*this._longestLineLength*.75),c=l.lineHeight*this._lines;this._scrollable.setScrollDimensions({scrollWidth:d,scrollHeight:c})}layout(e,t){this._scrollable.getDomNode().style.height=`${e}px`,this._scrollable.getDomNode().style.width=`${t}px`,this._scrollable.setScrollDimensions({width:t,height:e})}getHeightInLines(){return Math.min(17,this._lines)}getAriaLabel(e){let t="";switch(e.severity){case k.ZL.Error:t=L.NC("Error","Error");break;case k.ZL.Warning:t=L.NC("Warning","Warning");break;case k.ZL.Info:t=L.NC("Info","Info");break;case k.ZL.Hint:t=L.NC("Hint","Hint")}let i=L.NC("marker aria","{0} at {1}. ",t,e.startLineNumber+":"+e.startColumn);const r=this._editor.getModel();if(r&&e.startLineNumber<=r.getLineCount()&&e.startLineNumber>=1){i=`${r.getLineContent(e.startLineNumber)}, ${i}`}return i}}let $=class e extends B.vk{constructor(e,t,i,r,s,n,a){super(e,{showArrow:!0,showFrame:!0,isAccessible:!0,frameWidth:1},s),this._themeService=t,this._openerService=i,this._menuService=r,this._contextKeyService=n,this._labelService=a,this._callOnDispose=new o.SL,this._onDidSelectRelatedInformation=new c.Q5,this.onDidSelectRelatedInformation=this._onDidSelectRelatedInformation.event,this._severity=k.ZL.Warning,this._backgroundColor=E.Il.white,this._applyTheme(t.getColorTheme()),this._callOnDispose.add(t.onDidColorThemeChange(this._applyTheme.bind(this))),this.create()}_applyTheme(e){this._backgroundColor=e.getColor(Y);let t=q,i=X;this._severity===k.ZL.Warning?(t=Q,i=z):this._severity===k.ZL.Info&&(t=V,i=J);const r=e.getColor(t),o=e.getColor(i);this.style({arrowColor:r,frameColor:r,headerBackgroundColor:o,primaryHeadingColor:e.getColor(B.IH),secondaryHeadingColor:e.getColor(B.R7)})}_applyStyles(){this._parentContainer&&(this._parentContainer.style.backgroundColor=this._backgroundColor?this._backgroundColor.toString():""),super._applyStyles()}dispose(){this._callOnDispose.dispose(),super.dispose()}_fillHead(t){super._fillHead(t),this._disposables.add(this._actionbarWidget.actionRunner.onBeforeRun((e=>this.editor.focus())));const i=[],r=this._menuService.createMenu(e.TitleMenu,this._contextKeyService);(0,O.vr)(r,void 0,i),this._actionbarWidget.push(i,{label:!1,icon:!0,index:0}),r.dispose()}_fillTitleIcon(e){this._icon=M.R3(e,M.$(""))}_fillBody(e){this._parentContainer=e,e.classList.add("marker-widget"),this._parentContainer.tabIndex=0,this._parentContainer.setAttribute("role","tooltip"),this._container=document.createElement("div"),e.appendChild(this._container),this._message=new Z(this._container,this.editor,(e=>this._onDidSelectRelatedInformation.fire(e)),this._openerService,this._labelService),this._disposables.add(this._message)}show(){throw new Error("call showAtMarker")}showAtMarker(e,t,i){this._container.classList.remove("stale"),this._message.update(e),this._severity=e.severity,this._applyTheme(this._themeService.getColorTheme());const r=l.e.lift(e),o=this.editor.getPosition(),s=o&&r.containsPosition(o)?o:r.getStartPosition();super.show(s,this.computeRequiredHeight());const n=this.editor.getModel();if(n){const e=i>1?L.NC("problems","{0} of {1} problems",t,i):L.NC("change","{0} of {1} problem",t,i);this.setTitle((0,P.EZ)(n.uri),e)}this._icon.className=`codicon ${W.j.className(k.ZL.toSeverity(this._severity))}`,this.editor.revealPositionNearTop(s,0),this.editor.focus()}updateMarker(e){this._container.classList.remove("stale"),this._message.update(e)}showStale(){this._container.classList.add("stale"),this._relayout()}_doLayoutBody(e,t){super._doLayoutBody(e,t),this._heightInPixel=e,this._message.layout(e,t),this._container.style.height=`${e}px`}_onWidth(e){this._message.layout(this._heightInPixel,e)}_relayout(){super._relayout(this.computeRequiredHeight())}computeRequiredHeight(){return 3+this._message.getHeightInLines()}};$.TitleMenu=new I.eH("gotoErrorTitleMenu"),$=G([H(1,F.XE),H(2,T.v4),H(3,I.co),H(4,p.TG),H(5,S.i6),H(6,R.e)],$);const U=(0,A.kwl)(A.lXJ,A.b6y),K=(0,A.kwl)(A.uoC,A.pW3),j=(0,A.kwl)(A.c63,A.T83),q=(0,A.P6G)("editorMarkerNavigationError.background",{dark:U,light:U,hcDark:A.lRK,hcLight:A.lRK},L.NC("editorMarkerNavigationError","Editor marker navigation widget error color.")),X=(0,A.P6G)("editorMarkerNavigationError.headerBackground",{dark:(0,A.ZnX)(q,.1),light:(0,A.ZnX)(q,.1),hcDark:null,hcLight:null},L.NC("editorMarkerNavigationErrorHeaderBackground","Editor marker navigation widget error heading background.")),Q=(0,A.P6G)("editorMarkerNavigationWarning.background",{dark:K,light:K,hcDark:A.lRK,hcLight:A.lRK},L.NC("editorMarkerNavigationWarning","Editor marker navigation widget warning color.")),z=(0,A.P6G)("editorMarkerNavigationWarning.headerBackground",{dark:(0,A.ZnX)(Q,.1),light:(0,A.ZnX)(Q,.1),hcDark:"#0C141F",hcLight:(0,A.ZnX)(Q,.2)},L.NC("editorMarkerNavigationWarningBackground","Editor marker navigation widget warning heading background.")),V=(0,A.P6G)("editorMarkerNavigationInfo.background",{dark:j,light:j,hcDark:A.lRK,hcLight:A.lRK},L.NC("editorMarkerNavigationInfo","Editor marker navigation widget info color.")),J=(0,A.P6G)("editorMarkerNavigationInfo.headerBackground",{dark:(0,A.ZnX)(V,.1),light:(0,A.ZnX)(V,.1),hcDark:null,hcLight:null},L.NC("editorMarkerNavigationInfoHeaderBackground","Editor marker navigation widget info heading background.")),Y=(0,A.P6G)("editorMarkerNavigation.background",{dark:A.cvW,light:A.cvW,hcDark:A.cvW,hcLight:A.cvW},L.NC("editorMarkerNavigationBackground","Editor marker navigation widget background."));var ee=function(e,t,i,r){var o,s=arguments.length,n=s<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)n=Reflect.decorate(e,t,i,r);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(n=(s<3?o(n):s>3?o(t,i,n):o(t,i))||n);return s>3&&n&&Object.defineProperty(t,i,n),n},te=function(e,t){return function(i,r){t(i,r,e)}},ie=function(e,t,i,r){return new(i||(i=Promise))((function(o,s){function n(e){try{l(r.next(e))}catch(e){s(e)}}function a(e){try{l(r.throw(e))}catch(e){s(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(n,a)}l((r=r.apply(e,t||[])).next())}))};let re=class e{constructor(e,t,i,r,s){this._markerNavigationService=t,this._contextKeyService=i,this._editorService=r,this._instantiationService=s,this._sessionDispoables=new o.SL,this._editor=e,this._widgetVisible=ae.bindTo(this._contextKeyService)}static get(t){return t.getContribution(e.ID)}dispose(){this._cleanUp(),this._sessionDispoables.dispose()}_cleanUp(){this._widgetVisible.reset(),this._sessionDispoables.clear(),this._widget=void 0,this._model=void 0}_getOrCreateModel(e){if(this._model&&this._model.matches(e))return this._model;let t=!1;return this._model&&(t=!0,this._cleanUp()),this._model=this._markerNavigationService.getMarkerList(e),t&&this._model.move(!0,this._editor.getModel(),this._editor.getPosition()),this._widget=this._instantiationService.createInstance($,this._editor),this._widget.onDidClose((()=>this.close()),this,this._sessionDispoables),this._widgetVisible.set(!0),this._sessionDispoables.add(this._model),this._sessionDispoables.add(this._widget),this._sessionDispoables.add(this._editor.onDidChangeCursorPosition((e=>{var t,i,r;(null===(t=this._model)||void 0===t?void 0:t.selected)&&l.e.containsPosition(null===(i=this._model)||void 0===i?void 0:i.selected.marker,e.position)||null===(r=this._model)||void 0===r||r.resetIndex()}))),this._sessionDispoables.add(this._model.onDidChange((()=>{if(!this._widget||!this._widget.position||!this._model)return;const e=this._model.find(this._editor.getModel().uri,this._widget.position);e?this._widget.updateMarker(e.marker):this._widget.showStale()}))),this._sessionDispoables.add(this._widget.onDidSelectRelatedInformation((e=>{this._editorService.openCodeEditor({resource:e.resource,options:{pinned:!0,revealIfOpened:!0,selection:l.e.lift(e).collapseToStart()}},this._editor),this.close(!1)}))),this._sessionDispoables.add(this._editor.onDidChangeModel((()=>this._cleanUp()))),this._model}close(e=!0){this._cleanUp(),e&&this._editor.focus()}showAtMarker(e){if(this._editor.hasModel()){const t=this._getOrCreateModel(this._editor.getModel().uri);t.resetIndex(),t.move(!0,this._editor.getModel(),new a.L(e.startLineNumber,e.startColumn)),t.selected&&this._widget.showAtMarker(t.selected.marker,t.selected.index,t.selected.total)}}nagivate(t,i){var r,o;return ie(this,void 0,void 0,(function*(){if(this._editor.hasModel()){const s=this._getOrCreateModel(i?void 0:this._editor.getModel().uri);if(s.move(t,this._editor.getModel(),this._editor.getPosition()),!s.selected)return;if(s.selected.marker.resource.toString()!==this._editor.getModel().uri.toString()){this._cleanUp();const n=yield this._editorService.openCodeEditor({resource:s.selected.marker.resource,options:{pinned:!1,revealIfOpened:!0,selectionRevealType:2,selection:s.selected.marker}},this._editor);n&&(null===(r=e.get(n))||void 0===r||r.close(),null===(o=e.get(n))||void 0===o||o.nagivate(t,i))}else this._widget.showAtMarker(s.selected.marker,s.selected.index,s.selected.total)}}))}};re.ID="editor.contrib.markerController",re=ee([te(1,w),te(2,S.i6),te(3,n.$),te(4,p.TG)],re);class oe extends s.R6{constructor(e,t,i){super(i),this._next=e,this._multiFile=t}run(e,t){var i;return ie(this,void 0,void 0,(function*(){t.hasModel()&&(null===(i=re.get(t))||void 0===i||i.nagivate(this._next,this._multiFile))}))}}class se extends oe{constructor(){super(!0,!1,{id:se.ID,label:se.LABEL,alias:"Go to Next Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:d.u.focus,primary:578,weight:100},menuOpts:{menuId:$.TitleMenu,title:se.LABEL,icon:(0,N.q5)("marker-navigation-next",r.lA.arrowDown,L.NC("nextMarkerIcon","Icon for goto next marker.")),group:"navigation",order:1}})}}se.ID="editor.action.marker.next",se.LABEL=L.NC("markerAction.next.label","Go to Next Problem (Error, Warning, Info)");class ne extends oe{constructor(){super(!1,!1,{id:ne.ID,label:ne.LABEL,alias:"Go to Previous Problem (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:d.u.focus,primary:1602,weight:100},menuOpts:{menuId:$.TitleMenu,title:ne.LABEL,icon:(0,N.q5)("marker-navigation-previous",r.lA.arrowUp,L.NC("previousMarkerIcon","Icon for goto previous marker.")),group:"navigation",order:2}})}}ne.ID="editor.action.marker.prev",ne.LABEL=L.NC("markerAction.previous.label","Go to Previous Problem (Error, Warning, Info)");(0,s._K)(re.ID,re),(0,s.Qr)(se),(0,s.Qr)(ne),(0,s.Qr)(class extends oe{constructor(){super(!0,!0,{id:"editor.action.marker.nextInFiles",label:L.NC("markerAction.nextInFiles.label","Go to Next Problem in Files (Error, Warning, Info)"),alias:"Go to Next Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:d.u.focus,primary:66,weight:100},menuOpts:{menuId:I.eH.MenubarGoMenu,title:L.NC({key:"miGotoNextProblem",comment:["&& denotes a mnemonic"]},"Next &&Problem"),group:"6_problem_nav",order:1}})}}),(0,s.Qr)(class extends oe{constructor(){super(!1,!0,{id:"editor.action.marker.prevInFiles",label:L.NC("markerAction.previousInFiles.label","Go to Previous Problem in Files (Error, Warning, Info)"),alias:"Go to Previous Problem in Files (Error, Warning, Info)",precondition:void 0,kbOpts:{kbExpr:d.u.focus,primary:1090,weight:100},menuOpts:{menuId:I.eH.MenubarGoMenu,title:L.NC({key:"miGotoPreviousProblem",comment:["&& denotes a mnemonic"]},"Previous &&Problem"),group:"6_problem_nav",order:2}})}});const ae=new S.uy("markersNavigationVisible",!1),le=s._l.bindToContribution(re.get);(0,s.fK)(new le({id:"closeMarkersNavigation",precondition:ae,handler:e=>e.close(),kbOpts:{weight:150,kbExpr:d.u.focus,primary:9,secondary:[1033]}}))}}]);