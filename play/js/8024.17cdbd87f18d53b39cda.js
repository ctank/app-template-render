"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[8024],{89633:function(t,e,n){n.d(e,{P:function(){return b}});var i=n(56709),o=n(8964),s=n(52676),a=n(83388),r=n(16308),h=n(20996),g=n(10403),d=n(16012),u=n(93375),l=n(38431),_=n(69344),k=n(58570),c=n(7908),T=n(13484),z=n(11138);class S{constructor(t){this._default=t,this._store=[]}get(t){return t<this._store.length?this._store[t]:this._default}set(t,e){for(;t>=this._store.length;)this._store[this._store.length]=this._default;this._store[t]=e}delete(t,e){0===e||t>=this._store.length||this._store.splice(t,e)}insert(t,e){if(0===e||t>=this._store.length)return;const n=[];for(let t=0;t<e;t++)n[t]=this._default;this._store=r.Zv(this._store,t,n)}}class f{constructor(t,e){this.tokenizationSupport=t,this.initialState=e,this._lineBeginState=new S(null),this._lineNeedsTokenization=new S(!0),this._firstLineNeedsTokenization=0,this._lineBeginState.set(0,this.initialState)}get invalidLineStartIndex(){return this._firstLineNeedsTokenization}markMustBeTokenized(t){this._lineNeedsTokenization.set(t,!0),this._firstLineNeedsTokenization=Math.min(this._firstLineNeedsTokenization,t)}getBeginState(t){return this._lineBeginState.get(t)}setEndState(t,e,n){if(this._lineNeedsTokenization.set(e,!1),this._firstLineNeedsTokenization=e+1,e===t-1)return;const i=this._lineBeginState.get(e+1);if(null===i||!n.equals(i))return this._lineBeginState.set(e+1,n),void this.markMustBeTokenized(e+1);let o=e+1;for(;o<t&&!this._lineNeedsTokenization.get(o);)o++;this._firstLineNeedsTokenization=o}applyEdits(t,e){this.markMustBeTokenized(t.startLineNumber-1),this._lineBeginState.delete(t.startLineNumber,t.endLineNumber-t.startLineNumber),this._lineNeedsTokenization.delete(t.startLineNumber,t.endLineNumber-t.startLineNumber),this._lineBeginState.insert(t.startLineNumber,e),this._lineNeedsTokenization.insert(t.startLineNumber,e)}}class L extends l.JT{constructor(t,e,n){super(),this._textModel=t,this._tokenizationPart=e,this._languageIdCodec=n,this._isScheduled=!1,this._isDisposed=!1,this._tokenizationStateStore=null,this._register(d.RW.onDidChange((t=>{const e=this._textModel.getLanguageId();-1!==t.changedLanguages.indexOf(e)&&(this._resetTokenizationState(),this._tokenizationPart.clearTokens())}))),this._resetTokenizationState()}dispose(){this._isDisposed=!0,super.dispose()}handleDidChangeContent(t){if(t.isFlush)this._resetTokenizationState();else{if(this._tokenizationStateStore)for(let e=0,n=t.changes.length;e<n;e++){const n=t.changes[e],[i]=(0,k.Q)(n.text);this._tokenizationStateStore.applyEdits(n.range,i)}this._beginBackgroundTokenization()}}handleDidChangeAttached(){this._beginBackgroundTokenization()}handleDidChangeLanguage(t){this._resetTokenizationState(),this._tokenizationPart.clearTokens()}_resetTokenizationState(){const[t,e]=function(t,e){if(t.isTooLargeForTokenization())return[null,null];const n=d.RW.get(e.getLanguageId());if(!n)return[null,null];let i;try{i=n.getInitialState()}catch(t){return(0,h.dL)(t),[null,null]}return[n,i]}(this._textModel,this._tokenizationPart);this._tokenizationStateStore=t&&e?new f(t,e):null,this._beginBackgroundTokenization()}_beginBackgroundTokenization(){!this._isScheduled&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._isScheduled=!0,(0,T.To)((t=>{this._isScheduled=!1,this._backgroundTokenizeWithDeadline(t)})))}_backgroundTokenizeWithDeadline(t){const e=Date.now()+t.timeRemaining(),n=()=>{!this._isDisposed&&this._textModel.isAttachedToEditor()&&this._hasLinesToTokenize()&&(this._backgroundTokenizeForAtLeast1ms(),Date.now()<e?(0,z.fn)(n):this._beginBackgroundTokenization())};n()}_backgroundTokenizeForAtLeast1ms(){const t=this._textModel.getLineCount(),e=new c.N,n=_.G.create(!1);do{if(n.elapsed()>1)break;if(this._tokenizeOneInvalidLine(e)>=t)break}while(this._hasLinesToTokenize());this._tokenizationPart.setTokens(e.finalize(),this._isTokenizationComplete())}tokenizeViewport(t,e){const n=new c.N;this._tokenizeViewport(n,t,e),this._tokenizationPart.setTokens(n.finalize(),this._isTokenizationComplete())}reset(){this._resetTokenizationState(),this._tokenizationPart.clearTokens()}forceTokenization(t){const e=new c.N;this._updateTokensUntilLine(e,t),this._tokenizationPart.setTokens(e.finalize(),this._isTokenizationComplete())}getTokenTypeIfInsertingCharacter(t,e){if(!this._tokenizationStateStore)return 0;this.forceTokenization(t.lineNumber);const n=this._tokenizationStateStore.getBeginState(t.lineNumber-1);if(!n)return 0;const i=this._textModel.getLanguageId(),o=this._textModel.getLineContent(t.lineNumber),s=o.substring(0,t.column-1)+e+o.substring(t.column-1),a=C(this._languageIdCodec,i,this._tokenizationStateStore.tokenizationSupport,s,!0,n),r=new g.A(a.tokens,s,this._languageIdCodec);if(0===r.getCount())return 0;const h=r.findTokenIndexAtOffset(t.column-1);return r.getStandardTokenType(h)}tokenizeLineWithEdit(t,e,n){const i=t.lineNumber,o=t.column;if(!this._tokenizationStateStore)return null;this.forceTokenization(i);const s=this._tokenizationStateStore.getBeginState(i-1);if(!s)return null;const a=this._textModel.getLineContent(i),r=a.substring(0,o-1)+n+a.substring(o-1+e),h=this._textModel.getLanguageIdAtPosition(i,0),d=C(this._languageIdCodec,h,this._tokenizationStateStore.tokenizationSupport,r,!0,s);return new g.A(d.tokens,r,this._languageIdCodec)}isCheapToTokenize(t){if(!this._tokenizationStateStore)return!0;const e=this._tokenizationStateStore.invalidLineStartIndex+1;return!(t>e)&&(t<e||this._textModel.getLineLength(t)<2048)}_hasLinesToTokenize(){return!!this._tokenizationStateStore&&this._tokenizationStateStore.invalidLineStartIndex<this._textModel.getLineCount()}_isTokenizationComplete(){return!!this._tokenizationStateStore&&this._tokenizationStateStore.invalidLineStartIndex>=this._textModel.getLineCount()}_tokenizeOneInvalidLine(t){if(!this._tokenizationStateStore||!this._hasLinesToTokenize())return this._textModel.getLineCount()+1;const e=this._tokenizationStateStore.invalidLineStartIndex+1;return this._updateTokensUntilLine(t,e),e}_updateTokensUntilLine(t,e){if(!this._tokenizationStateStore)return;const n=this._textModel.getLanguageId(),i=this._textModel.getLineCount(),o=e-1;for(let e=this._tokenizationStateStore.invalidLineStartIndex;e<=o;e++){const o=this._textModel.getLineContent(e+1),s=this._tokenizationStateStore.getBeginState(e),a=C(this._languageIdCodec,n,this._tokenizationStateStore.tokenizationSupport,o,!0,s);t.add(e+1,a.tokens),this._tokenizationStateStore.setEndState(i,e,a.endState),e=this._tokenizationStateStore.invalidLineStartIndex-1}}_tokenizeViewport(t,e,n){if(!this._tokenizationStateStore)return;if(n<=this._tokenizationStateStore.invalidLineStartIndex)return;if(e<=this._tokenizationStateStore.invalidLineStartIndex)return void this._updateTokensUntilLine(t,n);let i=this._textModel.getLineFirstNonWhitespaceColumn(e);const o=[];let s=null;for(let t=e-1;i>1&&t>=1;t--){const e=this._textModel.getLineFirstNonWhitespaceColumn(t);if(0!==e&&(e<i&&(o.push(this._textModel.getLineContent(t)),i=e,s=this._tokenizationStateStore.getBeginState(t-1),s)))break}s||(s=this._tokenizationStateStore.initialState);const a=this._textModel.getLanguageId();let r=s;for(let t=o.length-1;t>=0;t--){r=C(this._languageIdCodec,a,this._tokenizationStateStore.tokenizationSupport,o[t],!1,r).endState}for(let i=e;i<=n;i++){const e=this._textModel.getLineContent(i),n=C(this._languageIdCodec,a,this._tokenizationStateStore.tokenizationSupport,e,!0,r);t.add(i,n.tokens),this._tokenizationStateStore.markMustBeTokenized(i-1),r=n.endState}}}function C(t,e,n,i,o,s){let a=null;if(n)try{a=n.tokenizeEncoded(i,o,s.clone())}catch(t){(0,h.dL)(t)}return a||(a=(0,u.Dy)(t.encodeLanguageId(e),s)),g.A.convertToEndOffset(a.tokens,i.length),a}var m=n(25516),p=n(4259);class b extends a.U{constructor(t,e,n,o,s){super(),this._languageService=t,this._languageConfigurationService=e,this._textModel=n,this.bracketPairsTextModelPart=o,this._languageId=s,this._onDidChangeLanguage=this._register(new i.Q5),this.onDidChangeLanguage=this._onDidChangeLanguage.event,this._onDidChangeLanguageConfiguration=this._register(new i.Q5),this.onDidChangeLanguageConfiguration=this._onDidChangeLanguageConfiguration.event,this._onDidChangeTokens=this._register(new i.Q5),this.onDidChangeTokens=this._onDidChangeTokens.event,this._backgroundTokenizationState=0,this._onBackgroundTokenizationStateChanged=this._register(new i.Q5),this._tokens=new m.l(this._languageService.languageIdCodec),this._semanticTokens=new p.u(this._languageService.languageIdCodec),this._tokenization=new L(n,this,this._languageService.languageIdCodec),this._languageRegistryListener=this._languageConfigurationService.onDidChange((t=>{t.affects(this._languageId)&&this._onDidChangeLanguageConfiguration.fire({})}))}acceptEdit(t,e,n,i,o){this._tokens.acceptEdit(t,n,i),this._semanticTokens.acceptEdit(t,n,i,o,e.length>0?e.charCodeAt(0):0)}handleDidChangeAttached(){this._tokenization.handleDidChangeAttached()}flush(){this._tokens.flush(),this._semanticTokens.flush()}handleDidChangeContent(t){this._tokenization.handleDidChangeContent(t)}dispose(){this._languageRegistryListener.dispose(),this._tokenization.dispose(),super.dispose()}get backgroundTokenizationState(){return this._backgroundTokenizationState}handleTokenizationProgress(t){if(2===this._backgroundTokenizationState)return;const e=t?2:1;this._backgroundTokenizationState!==e&&(this._backgroundTokenizationState=e,this.bracketPairsTextModelPart.handleDidChangeBackgroundTokenizationState(),this._onBackgroundTokenizationStateChanged.fire())}setTokens(t,e=!1){if(0!==t.length){const e=[];for(let n=0,i=t.length;n<i;n++){const i=t[n];let o=0,s=0,a=!1;for(let t=i.startLineNumber;t<=i.endLineNumber;t++)if(a)this._tokens.setTokens(this._languageId,t-1,this._textModel.getLineLength(t),i.getLineTokens(t),!1),s=t;else{this._tokens.setTokens(this._languageId,t-1,this._textModel.getLineLength(t),i.getLineTokens(t),!0)&&(a=!0,o=t,s=t)}a&&e.push({fromLineNumber:o,toLineNumber:s})}e.length>0&&this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!1,ranges:e})}this.handleTokenizationProgress(e)}setSemanticTokens(t,e){this._semanticTokens.set(t,e),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:null!==t,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}hasCompleteSemanticTokens(){return this._semanticTokens.isComplete()}hasSomeSemanticTokens(){return!this._semanticTokens.isEmpty()}setPartialSemanticTokens(t,e){if(this.hasCompleteSemanticTokens())return;const n=this._textModel.validateRange(this._semanticTokens.setPartial(t,e));this._emitModelTokensChangedEvent({tokenizationSupportChanged:!1,semanticTokensApplied:!0,ranges:[{fromLineNumber:n.startLineNumber,toLineNumber:n.endLineNumber}]})}tokenizeViewport(t,e){t=Math.max(1,t),e=Math.min(this._textModel.getLineCount(),e),this._tokenization.tokenizeViewport(t,e)}clearTokens(){this._tokens.flush(),this._emitModelTokensChangedEvent({tokenizationSupportChanged:!0,semanticTokensApplied:!1,ranges:[{fromLineNumber:1,toLineNumber:this._textModel.getLineCount()}]})}_emitModelTokensChangedEvent(t){this._textModel._isDisposing()||(this.bracketPairsTextModelPart.handleDidChangeTokens(t),this._onDidChangeTokens.fire(t))}resetTokenization(){this._tokenization.reset()}forceTokenization(t){if(t<1||t>this._textModel.getLineCount())throw new Error("Illegal value for lineNumber");this._tokenization.forceTokenization(t)}isCheapToTokenize(t){return this._tokenization.isCheapToTokenize(t)}tokenizeIfCheap(t){this.isCheapToTokenize(t)&&this.forceTokenization(t)}getLineTokens(t){if(t<1||t>this._textModel.getLineCount())throw new Error("Illegal value for lineNumber");return this._getLineTokens(t)}_getLineTokens(t){const e=this._textModel.getLineContent(t),n=this._tokens.getTokens(this._languageId,t-1,e);return this._semanticTokens.addSparseTokens(t,n)}getTokenTypeIfInsertingCharacter(t,e,n){const i=this._textModel.validatePosition(new o.L(t,e));return this._tokenization.getTokenTypeIfInsertingCharacter(i,n)}tokenizeLineWithEdit(t,e,n){const i=this._textModel.validatePosition(t);return this._tokenization.tokenizeLineWithEdit(i,e,n)}getLanguageConfiguration(t){return this._languageConfigurationService.getLanguageConfiguration(t)}getWordAtPosition(t){this.assertNotDisposed();const e=this._textModel.validatePosition(t),n=this._textModel.getLineContent(e.lineNumber),i=this._getLineTokens(e.lineNumber),o=i.findTokenIndexAtOffset(e.column-1),[a,r]=b._findLanguageBoundaries(i,o),h=(0,s.t2)(e.column,this.getLanguageConfiguration(i.getLanguageId(o)).getWordDefinition(),n.substring(a,r),a);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn)return h;if(o>0&&a===e.column-1){const[a,r]=b._findLanguageBoundaries(i,o-1),h=(0,s.t2)(e.column,this.getLanguageConfiguration(i.getLanguageId(o-1)).getWordDefinition(),n.substring(a,r),a);if(h&&h.startColumn<=t.column&&t.column<=h.endColumn)return h}return null}static _findLanguageBoundaries(t,e){const n=t.getLanguageId(e);let i=0;for(let o=e;o>=0&&t.getLanguageId(o)===n;o--)i=t.getStartOffset(o);let o=t.getLineContent().length;for(let i=e,s=t.getCount();i<s&&t.getLanguageId(i)===n;i++)o=t.getEndOffset(i);return[i,o]}getWordUntilPosition(t){const e=this.getWordAtPosition(t);return e?{word:e.word.substr(0,t.column-e.startColumn),startColumn:e.startColumn,endColumn:t.column}:{word:"",startColumn:t.column,endColumn:t.column}}getLanguageId(){return this._languageId}getLanguageIdAtPosition(t,e){const n=this._textModel.validatePosition(new o.L(t,e)),i=this.getLineTokens(n.lineNumber);return i.getLanguageId(i.findTokenIndexAtOffset(n.column-1))}setLanguageId(t){if(this._languageId===t)return;const e={oldLanguage:this._languageId,newLanguage:t};this._languageId=t,this.bracketPairsTextModelPart.handleDidChangeLanguage(e),this._tokenization.handleDidChangeLanguage(e),this._onDidChangeLanguage.fire(e),this._onDidChangeLanguageConfiguration.fire({})}}},6287:function(t,e,n){function i(t,e){let n=0,i=0;const o=t.length;for(;i<o;){const o=t.charCodeAt(i);if(32===o)n++;else{if(9!==o)break;n=n-n%e+e}i++}return i===o?-1:n}n.d(e,{q:function(){return i}})}}]);