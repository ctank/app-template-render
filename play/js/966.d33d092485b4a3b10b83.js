"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[966],{44061:function(t,e,n){n.d(e,{s:function(){return r}});n(77950),n(85940);var i=n(48488),a=n(27875),r={name:"FormComponentBase",components:{},inject:["onChange","onGetValue","onEvent"],props:{id:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}},extras:{type:Object,default:function(){return{}}},placeholder:{type:String,default:function(){return"请输入"}},rules:{type:Array,default:function(){return[]}},fieldPath:{type:String,default:function(){return""}},componentMap:{type:Object,default:function(){return{}}},formData:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{value:{get:function(){var t="";return this.formData&&this.fieldPath&&(t=(0,i.g)(this.formData,this.fieldPath)),t},set:function(t){this.onChange(t,this.id)}},validProp:function(){return this.fieldPath.replace(/\//g,".")}},render:function(t,e,n,i,r,l){return(0,a.wg)(),(0,a.iD)("div")}}},63966:function(t,e,n){n.r(e),n.d(e,{default:function(){return s}});n(68995),n(18178),n(39529),n(31235),n(77950),n(48319),n(95342),n(58188),n(74083),n(1939);var i=n(27875),a=n(50349),r=n(48488),l=n(44061),s=(0,i.aZ)({name:"CheckBox",extends:l.s,props:{title:{type:String,default:function(){return""}},required:{type:Boolean,default:function(){return!1}}},data:function(){return{filterOptions:[],relateOptionFieldValue:"",checkAll:!1,isIndeterminate:!1}},computed:{relateValue:function(){var t="";if(this.extras.relateOptionField){var e=this.componentMap[this.extras.relateOptionField];t=(0,r.g)(this.formData,e.fieldPath)}return t}},watch:{relateValue:function(){this.setFilterOptions()},"extras.options":function(){this.setFilterOptions()}},created:function(){this.setDefaultValue(),this.setRules()},mounted:function(){this.init()},methods:{init:function(){this.setFilterOptions()},setRules:function(){if(this.rules){var t=this.title;if(this.required&&this.rules.push({required:!0,message:"".concat(t,"不能为空"),trigger:"blur"}),this.extras){var e=parseInt(this.extras.minLimit),n=parseInt(this.extras.maxLimit);isNaN(e)||isNaN(n)?isNaN(e)?isNaN(n)||this.rules.push({validator:function(t,e,i){e&&e instanceof Array&&e.length>n?i("最多可选择".concat(n,"个选项")):i()},trigger:"change"}):this.rules.push({validator:function(t,n,i){n&&n instanceof Array&&n.length<e?i("至少选择".concat(e,"个选项")):i()},trigger:"change"}):this.rules.push({validator:function(t,i,a){i&&i instanceof Array&&(i.length<e||i.length>n)?a("选择的数量必须在".concat(e,"和").concat(n,"之间")):a()},trigger:"change"})}}},setDefaultValue:function(){if(this.value)this.setCheckAll();else{for(var t=[],e=0;e<this.extras.options.length;e++)this.extras.options[e].isDefault&&t.push(this.extras.options[e].value);t&&t.length&&this.onChange(t,this.id)}},setCheckAll:function(){var t=!0;if(this.filterOptions.length)for(var e=0;e<this.filterOptions.length&&(t=this.value.includes(this.filterOptions[e].value));e++);else t=!1;this.checkAll=t},setFilterOptions:function(){var t=this,e=[];if("api"===this.extras.dataSource){this.relateOptionFieldValue!==this.relateValue&&(this.relateOptionFieldValue=this.relateValue);var n=this.fieldPath.split("/");this.onGetValue({id:this.id,field:n[n.length-1]||"",relateValue:this.relateOptionFieldValue},(function(e){Array.isArray(e)&&setTimeout((function(){t.filterOptions=e,t.setCheckAll()}),0)}))}else if(this.extras.relateOptionField){var i=this.extras.relateAvailableOptions[this.relateValue];i&&i.length&&(e=this.extras.options.filter((function(t){return i.indexOf(t.value)>=0})))}else e=this.extras.options;this.filterOptions=e},handleCheckAllChange:function(t){var e=[];this.filterOptions.forEach((function(t){e.push(t.value)})),this.value=t?e:[],this.isIndeterminate=!1},handleValueChange:function(t){var e=t.length,n=[];this.filterOptions.forEach((function(t){n.push(t.value)})),this.checkAll=e===n.length,this.isIndeterminate=e>0&&e<n.length}}}),u=(0,i.Uk)("全选");s.render=function(t,e,n,r,l,s){var o=(0,i.up)("el-checkbox"),h=(0,i.up)("el-checkbox-group"),c=(0,i.up)("el-form-item");return(0,i.wg)(),(0,i.j4)(c,{label:t.title,class:(0,a.normalizeClass)(t.required?"is-required":""),prop:t.validProp,rules:t.rules},{default:(0,i.w5)((function(){return[t.extras.checkAll?((0,i.wg)(),(0,i.j4)(o,{key:0,class:"atp-checkbox__all",modelValue:t.checkAll,"onUpdate:modelValue":e[0]||(e[0]=function(e){return t.checkAll=e}),indeterminate:t.isIndeterminate,onChange:t.handleCheckAllChange},{default:(0,i.w5)((function(){return[u]})),_:1},8,["modelValue","indeterminate","onChange"])):(0,i.kq)("",!0),(0,i.Wm)(h,{modelValue:t.value,"onUpdate:modelValue":e[1]||(e[1]=function(e){return t.value=e}),onChange:t.handleValueChange},{default:(0,i.w5)((function(){return[((0,i.wg)(!0),(0,i.iD)(i.HY,null,(0,i.Ko)(t.filterOptions,(function(t,e){return(0,i.wg)(),(0,i.j4)(o,{label:t.value,key:"".concat(e,"-").concat(t.value)},{default:(0,i.w5)((function(){return[(0,i.Uk)((0,a.toDisplayString)(t.label),1)]})),_:2},1032,["label"])})),128))]})),_:1},8,["modelValue","onChange"])]})),_:1},8,["label","class","prop","rules"])}},74083:function(t,e,n){var i=n(23103),a=n(65968),r=n(19540).indexOf,l=n(96038),s=a([].indexOf),u=!!s&&1/s([1],1,-0)<0,o=l("indexOf");i({target:"Array",proto:!0,forced:u||!o},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return u?s(this,t,e)||0:r(this,t,e)}})}}]);