"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[9383],{10589:function(t,e,i){i.r(e);var n=i(55298),s=i(72223),o=i(86412),a=i(63149);(0,n._K)(o.K.ID,o.K),s.Ae.register(a.G)},86412:function(t,e,i){i.d(e,{K:function(){return T},f:function(){return E}});var n=i(34441),s=i(16308),o=i(13484),a=i(97464),r=i(20996),d=i(38431),l=i(39832),c=i(14818),h=i(28919),u=i(31396),p=i(70054),_=i(19083),g=i(50038),f=i(16012),v=i(41913),y=i(132),m=i(69060),b=i(35921),D=i(91223),C=i(66931),M=i(20912),R=i(52429),H=i(80793),x=i(53061),I=i(44333),w=i(97968),S=i(92537),F=i(58566),k=function(t,e,i,n){var s,o=arguments.length,a=o<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,i,n);else for(var r=t.length-1;r>=0;r--)(s=t[r])&&(a=(o<3?s(a):o>3?s(e,i,a):s(e,i))||a);return o>3&&a&&Object.defineProperty(e,i,a),a},N=function(t,e){return function(i,n){e(i,n,t)}},P=function(t,e,i,n){return new(i||(i=Promise))((function(s,o){function a(t){try{d(n.next(t))}catch(t){o(t)}}function r(t){try{d(n.throw(t))}catch(t){o(t)}}function d(t){var e;t.done?s(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(a,r)}d((n=n.apply(t,e||[])).next())}))};class L{constructor(){this._entries=new l.z6(50)}get(t){const e=L._key(t);return this._entries.get(e)}set(t,e){const i=L._key(t);this._entries.set(i,e)}static _key(t){return`${t.uri.toString()}/${t.getVersionId()}`}}const A=(0,I.yh)("IInlayHintsCache");(0,x.z)(A,L,!0);class E{constructor(t,e){this.item=t,this.index=e}get part(){const t=this.item.hint.label;return"string"==typeof t?{label:t}:t[this.index]}}class O{constructor(t,e){this.part=t,this.hasTriggerModifier=e}}let T=class t{constructor(t,e,i,n,s,o,a){this._editor=t,this._languageFeaturesService=e,this._inlayHintsCache=n,this._commandService=s,this._notificationService=o,this._instaService=a,this._disposables=new d.SL,this._sessionDisposables=new d.SL,this._decorationsMetadata=new Map,this._ruleFactory=new u.t7(this._editor),this._activeRenderMode=0,this._debounceInfo=i.for(e.inlayHintsProvider,"InlayHint",{min:25}),this._disposables.add(e.inlayHintsProvider.onDidChange((()=>this._update()))),this._disposables.add(t.onDidChangeModel((()=>this._update()))),this._disposables.add(t.onDidChangeModelLanguage((()=>this._update()))),this._disposables.add(t.onDidChangeConfiguration((t=>{t.hasChanged(129)&&this._update()}))),this._update()}static get(e){var i;return null!==(i=e.getContribution(t.ID))&&void 0!==i?i:void 0}dispose(){this._sessionDisposables.dispose(),this._removeAllDecorations(),this._disposables.dispose()}_update(){this._sessionDisposables.clear(),this._removeAllDecorations();const t=this._editor.getOption(129);if("off"===t.enabled)return;const e=this._editor.getModel();if(!e||!this._languageFeaturesService.inlayHintsProvider.has(e))return;const i=this._inlayHintsCache.get(e);let s;i&&this._updateHintsDecorators([e.getFullModelRange()],i),this._sessionDisposables.add((0,d.OF)((()=>{e.isDisposed()||this._cacheHintsForFastRestore(e)})));const l=new Set,c=new o.pY((()=>P(this,void 0,void 0,(function*(){const t=Date.now();null==s||s.dispose(!0),s=new a.A;const i=e.onWillDispose((()=>null==s?void 0:s.cancel()));try{const n=s.token,o=yield M.Q3.create(this._languageFeaturesService.inlayHintsProvider,e,this._getHintsRanges(),n);if(c.delay=this._debounceInfo.update(e,Date.now()-t),n.isCancellationRequested)return void o.dispose();for(const t of o.provider)"function"!=typeof t.onDidChangeInlayHints||l.has(t)||(l.add(t),this._sessionDisposables.add(t.onDidChangeInlayHints((()=>{c.isScheduled()||c.schedule()}))));this._sessionDisposables.add(o),this._updateHintsDecorators(o.ranges,o.items),this._cacheHintsForFastRestore(e)}catch(t){(0,r.dL)(t)}finally{s.dispose(),i.dispose()}}))),this._debounceInfo.get(e));if(this._sessionDisposables.add(c),this._sessionDisposables.add((0,d.OF)((()=>null==s?void 0:s.dispose(!0)))),c.schedule(0),this._sessionDisposables.add(this._editor.onDidScrollChange((t=>{!t.scrollTopChanged&&c.isScheduled()||c.schedule()}))),this._sessionDisposables.add(this._editor.onDidChangeModelContent((t=>{const e=Math.max(c.delay,1250);c.schedule(e)}))),"on"===t.enabled)this._activeRenderMode=0;else{let e,i;"onUnlessPressed"===t.enabled?(e=0,i=1):(e=1,i=0),this._activeRenderMode=e,this._sessionDisposables.add(n._q.getInstance().event((t=>{if(!this._editor.hasModel())return;const n=t.altKey&&t.ctrlKey?i:e;if(n!==this._activeRenderMode){this._activeRenderMode=n;const t=this._editor.getModel(),e=this._copyInlayHintsWithCurrentAnchor(t);this._updateHintsDecorators([t.getFullModelRange()],e),c.schedule(0)}})))}this._sessionDisposables.add(this._installDblClickGesture((()=>c.schedule(0)))),this._sessionDisposables.add(this._installLinkGesture()),this._sessionDisposables.add(this._installContextMenu())}_installLinkGesture(){const t=new d.SL,e=t.add(new C.yN(this._editor)),i=new d.SL;return t.add(i),t.add(e.onMouseMoveOrRelevantKeyDown((t=>{const[e]=t,n=this._getInlayHintLabelPart(e),s=this._editor.getModel();if(!n||!s)return void i.clear();const o=new a.A;i.add((0,d.OF)((()=>o.dispose(!0)))),n.item.resolve(o.token),this._activeInlayHintPart=n.part.command||n.part.location?new O(n,e.hasTriggerModifier):void 0;const r=n.item.hint.position.lineNumber,l=new g.e(r,1,r,s.getLineMaxColumn(r)),c=this._getInlineHintsForRange(l);this._updateHintsDecorators([l],c),i.add((0,d.OF)((()=>{this._activeInlayHintPart=void 0,this._updateHintsDecorators([l],c)})))}))),t.add(e.onCancel((()=>i.clear()))),t.add(e.onExecute((t=>P(this,void 0,void 0,(function*(){const e=this._getInlayHintLabelPart(t);if(e){const i=e.part;i.location?this._instaService.invokeFunction(R.K,t,this._editor,i.location):f.mY.is(i.command)&&(yield this._invokeCommand(i.command,e.item))}}))))),t}_getInlineHintsForRange(t){const e=new Set;for(const i of this._decorationsMetadata.values())t.containsRange(i.item.anchor.range)&&e.add(i.item);return Array.from(e)}_installDblClickGesture(t){return this._editor.onMouseUp((e=>P(this,void 0,void 0,(function*(){if(2!==e.event.detail)return;const i=this._getInlayHintLabelPart(e);if(i&&(e.event.preventDefault(),yield i.item.resolve(a.T.None),(0,s.Of)(i.item.hint.textEdits))){const e=i.item.hint.textEdits.map((t=>_.h.replace(g.e.lift(t.range),t.text)));this._editor.executeEdits("inlayHint.default",e),t()}}))))}_installContextMenu(){return this._editor.onContextMenu((t=>P(this,void 0,void 0,(function*(){if(!(t.event.target instanceof HTMLElement))return;const e=this._getInlayHintLabelPart(t);e&&(yield this._instaService.invokeFunction(R.u,this._editor,t.event.target,e))}))))}_getInlayHintLabelPart(t){var e;if(6!==t.target.type)return;const i=null===(e=t.target.detail.injectedText)||void 0===e?void 0:e.options;return i instanceof y.HS&&(null==i?void 0:i.attachedData)instanceof E?i.attachedData:void 0}_invokeCommand(t,e){var i;return P(this,void 0,void 0,(function*(){try{yield this._commandService.executeCommand(t.id,...null!==(i=t.arguments)&&void 0!==i?i:[])}catch(t){this._notificationService.notify({severity:w.zb.Error,source:e.provider.displayName,message:t})}}))}_cacheHintsForFastRestore(t){const e=this._copyInlayHintsWithCurrentAnchor(t);this._inlayHintsCache.set(t,e)}_copyInlayHintsWithCurrentAnchor(t){const e=new Map;for(const[i,n]of this._decorationsMetadata){if(e.has(n.item))continue;const s=t.getDecorationRange(i);if(s){const t=new M.UQ(s,n.item.anchor.direction),i=n.item.with({anchor:t});e.set(n.item,i)}}return Array.from(e.values())}_getHintsRanges(){const t=this._editor.getModel(),e=this._editor.getVisibleRangesPlusViewportAboveBelow(),i=[];for(const n of e.sort(g.e.compareRangesUsingStarts)){const e=t.validateRange(new g.e(n.startLineNumber-30,n.startColumn,n.endLineNumber+30,n.endColumn));0!==i.length&&g.e.areIntersectingOrTouching(i[i.length-1],e)?i[i.length-1]=g.e.plusRange(i[i.length-1],e):i.push(e)}return i}_updateHintsDecorators(e,i){var n,o;const a=[],r=(t,e,i,n,s)=>{const o={content:i,inlineClassNameAffectsLetterSpacing:!0,inlineClassName:e.className,cursorStops:n,attachedData:s};a.push({item:t,classNameRef:e,decoration:{range:t.anchor.range,options:{description:"InlayHint",showIfCollapsed:t.anchor.range.isEmpty(),collapseOnReplaceEdit:!t.anchor.range.isEmpty(),stickiness:0,[t.anchor.direction]:0===this._activeRenderMode?o:void 0}}})},d=(t,e)=>{const i=this._ruleFactory.createClassNameRef({width:(l/3|0)+"px",display:"inline-block"});r(t,i," ",e?v.RM.Right:v.RM.None)},{fontSize:l,fontFamily:c,padding:h,isUniform:u}=this._getLayoutInfo(),_="--code-editorInlayHintsFontFamily";this._editor.getContainerDomNode().style.setProperty(_,c);for(const e of i){e.hint.paddingLeft&&d(e,!1);const i="string"==typeof e.hint.label?[{label:e.hint.label}]:e.hint.label;for(let t=0;t<i.length;t++){const o=i[t],a=0===t,d=t===i.length-1,c={fontSize:`${l}px`,fontFamily:`var(${_}), ${p.hL.fontFamily}`,verticalAlign:u?"baseline":"middle"};(0,s.Of)(e.hint.textEdits)&&(c.cursor="default"),this._fillInColors(c,e.hint),(o.command||o.location)&&(null===(n=this._activeInlayHintPart)||void 0===n?void 0:n.part.item)===e&&this._activeInlayHintPart.part.index===t&&(c.textDecoration="underline",this._activeInlayHintPart.hasTriggerModifier&&(c.color=(0,F.EN)(S._Yy),c.cursor="pointer")),h&&(a&&d?(c.padding=`1px ${0|Math.max(1,l/4)}px`,c.borderRadius=(l/4|0)+"px"):a?(c.padding=`1px 0 1px ${0|Math.max(1,l/4)}px`,c.borderRadius=`${l/4|0}px 0 0 ${l/4|0}px`):d?(c.padding=`1px ${0|Math.max(1,l/4)}px 1px 0`,c.borderRadius=`0 ${l/4|0}px ${l/4|0}px 0`):c.padding="1px 0 1px 0"),r(e,this._ruleFactory.createClassNameRef(c),$(o.label),d&&!e.hint.paddingRight?v.RM.Right:v.RM.None,new E(e,t))}if(e.hint.paddingRight&&d(e,!0),a.length>t._MAX_DECORATORS)break}const g=[];for(const t of e)for(const{id:e}of null!==(o=this._editor.getDecorationsInRange(t))&&void 0!==o?o:[]){const t=this._decorationsMetadata.get(e);t&&(g.push(e),t.classNameRef.dispose(),this._decorationsMetadata.delete(e))}this._editor.changeDecorations((t=>{const e=t.deltaDecorations(g,a.map((t=>t.decoration)));for(let t=0;t<e.length;t++){const i=a[t];this._decorationsMetadata.set(e[t],i)}}))}_fillInColors(t,e){e.kind===f.gl.Parameter?(t.backgroundColor=(0,F.EN)(S.phM),t.color=(0,F.EN)(S.HCL)):e.kind===f.gl.Type?(t.backgroundColor=(0,F.EN)(S.bKB),t.color=(0,F.EN)(S.hX8)):(t.backgroundColor=(0,F.EN)(S.PpC),t.color=(0,F.EN)(S.VVv))}_getLayoutInfo(){const t=this._editor.getOption(129),e=t.padding,i=this._editor.getOption(48),n=this._editor.getOption(45);let s=t.fontSize;(!s||s<5||s>i)&&(s=i);const o=t.fontFamily||n;return{fontSize:s,fontFamily:o,padding:e,isUniform:!e&&o===n&&s===i}}_removeAllDecorations(){this._editor.removeDecorations(Array.from(this._decorationsMetadata.keys()));for(const t of this._decorationsMetadata.values())t.classNameRef.dispose();this._decorationsMetadata.clear()}};function $(t){return t.replace(/[ \t]/g," ")}T.ID="editor.contrib.InlayHints",T._MAX_DECORATORS=1500,T=k([N(1,b.p),N(2,m.A),N(3,A),N(4,H.Hy),N(5,w.lT),N(6,I.TG)],T),H.P0.registerCommand("_executeInlayHintProvider",((t,...e)=>P(void 0,void 0,void 0,(function*(){const[i,n]=e;(0,c.p_)(h.o.isUri(i)),(0,c.p_)(g.e.isIRange(n));const{inlayHintsProvider:s}=t.get(b.p),o=yield t.get(D.S).createModelReference(i);try{const t=yield M.Q3.create(s,o.object.textEditorModel,[g.e.lift(n)],a.T.None),e=t.items.map((t=>t.hint));return setTimeout((()=>t.dispose()),0),e}finally{o.dispose()}}))))}}]);