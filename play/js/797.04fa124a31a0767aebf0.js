(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[797],{80231:function(e,t,i){"use strict";i.d(t,{s:function(){return a}});i(77950),i(85940);var n=i(90743),r=i(27875),a={name:"FormComponentBase",components:{},inject:["onChange","onGetValue","onEvent"],props:{id:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}},extras:{type:Object,default:function(){return{}}},placeholder:{type:String,default:function(){return"请输入"}},rules:{type:Array,default:function(){return[]}},fieldPath:{type:String,default:function(){return""}},componentMap:{type:Object,default:function(){return{}}},formData:{type:Object,default:function(){return{}}}},data:function(){return{}},computed:{value:{get:function(){var e="";return this.formData&&this.fieldPath&&(e=(0,n.g)(this.formData,this.fieldPath)),e},set:function(e){this.onChange(e,this.id)}},validProp:function(){return this.fieldPath.replace(/\//g,".")}},render:function(e,t,i,n,a,s){return(0,r.wg)(),(0,r.iD)("div")}}},81797:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return m}});i(74660),i(26936),i(39529),i(31235),i(77950),i(48319),i(58188),i(1939),i(68995),i(18178),i(17368),i(51172),i(88233),i(21850),i(9949),i(99805);var n=i(27875),r=i(50349),a=i(80231),s=i(90743),o={excel:["xls","xlsx"],music:["mp3","wav"],pic:["jpg","png","gif"],ppt:["ppt","pptx"],video:["mp4"],word:["doc","docx"],zip:["zip","rar","7z"]},l=(0,n.aZ)({name:"FileList",extends:a.s,props:{fileList:{type:Array,default:function(){return[]}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{fileTypeIcons:s.F}},watch:{},created:function(){},methods:{getFileTypeIconSrc:function(e){var t=s.F.file,i=e.name.lastIndexOf(".");if(i>=0){var n=e.name.substr(i+1);if(s.j[n.toLowerCase()])t=s.j[n.toLowerCase()];else for(var r in o)o[r].includes(n)&&(t=s.F[r])}return t},handleFilePreview:function(e){this.$emit("preview",e)},handleFIleRemove:function(e){this.$emit("remove",e)}}}),u={class:"atp-file-list"},c={class:"atp-file-list__content"},f={class:"atp-file-list__icon"},d=["src"],p={class:"atp-file-list__title"},h=["title","onClick"],g={class:"atp-file-list_action"},v={key:0,class:"atp-progress atp-file-progress"};l.render=function(e,t,i,a,s,o){var l=(0,n.up)("Delete"),m=(0,n.up)("el-icon");return(0,n.wg)(),(0,n.iD)("div",u,[((0,n.wg)(!0),(0,n.iD)(n.HY,null,(0,n.Ko)(e.fileList,(function(t,i){return(0,n.wg)(),(0,n.iD)("div",{class:(0,r.normalizeClass)(["atp-file-list__item",t.percent&&t.percent<100?"atp-file-list__item--progress":""]),key:t.url},[(0,n._)("div",c,[(0,n._)("div",f,[(0,n._)("img",{class:"atp-file-icon",src:e.getFileTypeIconSrc(t)},null,8,d)]),(0,n._)("div",p,[(0,n._)("span",{title:t.name,onClick:function(i){return e.handleFilePreview(t)}},(0,r.toDisplayString)(t.name),9,h)]),(0,n._)("div",g,[(0,n.Wm)(m,{title:"删除",onClick:function(t){return e.handleFIleRemove(i)}},{default:(0,n.w5)((function(){return[(0,n.Wm)(l)]})),_:2},1032,["onClick"])])]),t.percent&&t.percent<100?((0,n.wg)(),(0,n.iD)("div",v,[(0,n._)("div",{class:"atp-progress__bar atp-progress__bar--striped atp-progress__bar--animated",style:(0,r.normalizeStyle)("width:".concat(t.percent||100,"%;"))},null,4)])):(0,n.kq)("",!0)],2)})),128))])};var m=(0,n.aZ)({name:"FileUpload",extends:a.s,components:{FileList:l},props:{title:{type:String,default:function(){return""}},required:{type:Boolean,default:function(){return!1}},placeholder:{type:String,default:function(){return""}}},data:function(){return{}},computed:{showUploadBtn:function(){return 1!==this.extras.maxLimit||this.value.length!==this.extras.maxLimit},uploadAccept:function(){if(this.extras.fileType){var e=this.extras.fileType.split(";"),t="";return e.forEach((function(e){t.length&&(t+=" "),t+=".".concat(e,",")})),t}return"*"},disabledUpload:function(){return this.extras.maxLimit>1&&this.value.length===this.extras.maxLimit}},created:function(){this.setRules(),this.setDefaultValue()},methods:{setRules:function(){if(this.rules){var e=this.title;if(this.required&&this.rules.push({required:!0,message:"".concat(e,"不能为空"),trigger:"submit"}),this.extras){var t=parseInt(this.extras.minLimit),i=parseInt(this.extras.maxLimit);isNaN(t)||isNaN(i)?isNaN(t)?isNaN(i)||this.rules.push({validator:function(e,t,n){Array.isArray(t)&&t.length>i?n(new Error("最多允许上传".concat(i,"个文件"))):n()},trigger:"submit"}):this.rules.push({validator:function(e,i,n){Array.isArray(i)&&i.length<t?n(new Error("最少需要上传".concat(t,"个文件"))):n()},trigger:"submit"}):this.rules.push({validator:function(e,n,r){Array.isArray(n)&&(n.length<t||n.length>i)?r(new Error("上传文件数量在".concat(t,"和").concat(i,"之间"))):r()},trigger:"submit"})}}},setDefaultValue:function(){this.value||this.onChange([],this.id)},beforeUpload:function(e){var t=this.__$app.config.globalProperties.$message,i=new RegExp("^[一-龥A-Za-z0-9_-]+$");if(e.name.split(".").length>2||!i.test(this.filename))return t?t({showClose:!0,message:"文件名仅能包含中文数字英文字母_-",type:"error"}):alert("文件名仅能包含中文数字英文字母_-"),!1;var n=this.extras.fileSizeLimit;if(n.value){var r="MB"===n.unit?1024*n.value:n.value;if(e.size/1024>r)return t?t({showClose:!0,message:"上传文件大小不能超过".concat(n.value).concat(n.unit),type:"error"}):alert("上传文件大小不能超过".concat(n.value).concat(n.unit)),!1}return!0},uploadSuccess:function(e,t,i){var n=this,r=function(t){var r=n.extras.uploadConfig,a=r.nameFieldPath,o=r.urlFieldPath,l=r.thumbUrlFieldPath,u=t.name;a&&(u=(0,s.g)(e,a));var c="";o&&(c=(0,s.g)(e,o));var f=c;l&&(c=(0,s.g)(e,l));var d=i.findIndex((function(e){return e.uid&&e.uid===t.uid}));i[d]={name:u,url:c,thumbUrl:f,uid:t.uid,status:t.status,percentage:t.percentage}};this.extras.actionConfig.success?this.onEvent(this.extras.actionConfig.success,{file:t,res:e,id:this.id,fieldPath:this.fieldPath},r):r(t)},uploadError:function(e,t,i){this.extras.actionConfig.success&&this.onEvent(this.extras.actionConfig.success,{file:t,err:e,id:this.id,fieldPath:this.fieldPath})},handleFilePreview:function(e){this.extras.actionConfig.preview&&this.onEvent(this.extras.actionConfig.preview,{file:e,id:this.id,fieldPath:this.fieldPath})},handleFileRemove:function(e){var t=this;if(Array.isArray(this.value)){var i=this.value[e];i.status="uploading";var n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success";if(i.status="success","success"===n){var r=(0,s.h)(t.value);r.splice(e,1),t.onChange(r,t.id)}};this.extras.actionConfig.remove?this.onEvent(this.extras.actionConfig.remove,{file:i,id:this.id,fieldPath:this.fieldPath},n):n()}}}}),x={class:"atp-file-upload"},y=(0,n.Uk)("点击上传");m.render=function(e,t,i,a,s,o){var l=(0,n.up)("el-button"),u=(0,n.up)("el-upload"),c=(0,n.up)("file-list"),f=(0,n.up)("el-form-item");return(0,n.wg)(),(0,n.j4)(f,{label:e.title,class:(0,r.normalizeClass)(e.required?"is-required":""),prop:e.validProp,rules:e.rules},{default:(0,n.w5)((function(){return[(0,n._)("div",x,[(0,n.Wm)(u,{class:"atp-file-upload__btn","file-list":e.value,"onUpdate:file-list":t[0]||(t[0]=function(t){return e.value=t}),accept:e.uploadAccept,action:e.extras.uploadConfig.action,disabled:e.disabledUpload,"show-file-list":!1,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess,"on-error":e.uploadError},{default:(0,n.w5)((function(){return[(0,n.Wm)(l,{disabled:e.disabledUpload,type:"primary"},{default:(0,n.w5)((function(){return[y]})),_:1},8,["disabled"])]})),_:1},8,["file-list","accept","action","disabled","before-upload","on-success","on-error"]),e.value.length?((0,n.wg)(),(0,n.j4)(c,{key:0,class:"atp-file-upload__list",width:e.extras.width,height:e.extras.height,"file-list":e.value,onPreview:e.handleFilePreview,onRemove:e.handleFileRemove},null,8,["width","height","file-list","onPreview","onRemove"])):(0,n.kq)("",!0)])]})),_:1},8,["label","class","prop","rules"])}},86462:function(e,t,i){"use strict";var n=i(53171),r=i(10905),a=i(43329),s=i(39646),o=i(96038),l=Math.min,u=[].lastIndexOf,c=!!u&&1/[1].lastIndexOf(1,-0)<0,f=o("lastIndexOf"),d=c||!f;e.exports=d?function(e){if(c)return n(u,this,arguments)||0;var t=r(this),i=s(t),o=i-1;for(arguments.length>1&&(o=l(o,a(arguments[1]))),o<0&&(o=i+o);o>=0;o--)if(o in t&&t[o]===e)return o||0;return-1}:u},96616:function(e,t,i){var n=i(16039),r=i(31787);e.exports=function(e,t,i){return i.get&&n(i.get,t,{getter:!0}),i.set&&n(i.set,t,{setter:!0}),r.f(e,t,i)}},20835:function(e,t,i){var n=i(26733),r=i(85052),a=i(56540);e.exports=function(e,t,i){var s,o;return a&&n(s=t.constructor)&&s!==i&&r(o=s.prototype)&&o!==i.prototype&&a(e,o),e}},26060:function(e,t,i){var n=i(31787).f;e.exports=function(e,t,i){i in e||n(e,i,{configurable:!0,get:function(){return t[i]},set:function(e){t[i]=e}})}},9949:function(e,t,i){"use strict";var n=i(23103),r=i(89996).findIndex,a=i(9736),s="findIndex",o=!0;s in[]&&Array(1).findIndex((function(){o=!1})),n({target:"Array",proto:!0,forced:o},{findIndex:function(e){return r(this,e,arguments.length>1?arguments[1]:void 0)}}),a(s)},74660:function(e,t,i){var n=i(23103),r=i(86462);n({target:"Array",proto:!0,forced:r!==[].lastIndexOf},{lastIndexOf:r})},17368:function(e,t,i){var n=i(7400),r=i(9859),a=i(65968),s=i(46541),o=i(20835),l=i(75762),u=i(78151).f,c=i(91321),f=i(48311),d=i(83326),p=i(83349),h=i(25650),g=i(26060),v=i(14768),m=i(24229),x=i(98270),y=i(56407).enforce,w=i(71832),_=i(70095),b=i(42926),C=i(10461),P=_("match"),E=r.RegExp,I=E.prototype,S=r.SyntaxError,F=a(I.exec),k=a("".charAt),A=a("".replace),R=a("".indexOf),D=a("".slice),L=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,U=/a/g,O=/a/g,j=new E(U)!==U,z=h.MISSED_STICKY,N=h.UNSUPPORTED_Y,T=n&&(!j||z||b||C||m((function(){return O[P]=!1,E(U)!=U||E(O)==O||"/a/i"!=E(U,"i")})));if(s("RegExp",T)){for(var q=function(e,t){var i,n,r,a,s,u,h=c(I,this),g=f(e),v=void 0===t,m=[],w=e;if(!h&&g&&v&&e.constructor===q)return e;if((g||c(I,e))&&(e=e.source,v&&(t=p(w))),e=void 0===e?"":d(e),t=void 0===t?"":d(t),w=e,b&&"dotAll"in U&&(n=!!t&&R(t,"s")>-1)&&(t=A(t,/s/g,"")),i=t,z&&"sticky"in U&&(r=!!t&&R(t,"y")>-1)&&N&&(t=A(t,/y/g,"")),C&&(a=function(e){for(var t,i=e.length,n=0,r="",a=[],s={},o=!1,l=!1,u=0,c="";n<=i;n++){if("\\"===(t=k(e,n)))t+=k(e,++n);else if("]"===t)o=!1;else if(!o)switch(!0){case"["===t:o=!0;break;case"("===t:F(L,D(e,n+1))&&(n+=2,l=!0),r+=t,u++;continue;case">"===t&&l:if(""===c||x(s,c))throw new S("Invalid capture group name");s[c]=!0,a[a.length]=[c,u],l=!1,c="";continue}l?c+=t:r+=t}return[r,a]}(e),e=a[0],m=a[1]),s=o(E(e,t),h?this:I,q),(n||r||m.length)&&(u=y(s),n&&(u.dotAll=!0,u.raw=q(function(e){for(var t,i=e.length,n=0,r="",a=!1;n<=i;n++)"\\"!==(t=k(e,n))?a||"."!==t?("["===t?a=!0:"]"===t&&(a=!1),r+=t):r+="[\\s\\S]":r+=t+k(e,++n);return r}(e),i)),r&&(u.sticky=!0),m.length&&(u.groups=m)),e!==w)try{l(s,"source",""===w?"(?:)":w)}catch(e){}return s},B=u(E),M=0;B.length>M;)g(q,E,B[M++]);I.constructor=q,q.prototype=I,v(r,"RegExp",q,{constructor:!0})}w("RegExp")},51172:function(e,t,i){var n=i(7400),r=i(25650).MISSED_STICKY,a=i(27079),s=i(96616),o=i(56407).get,l=RegExp.prototype,u=TypeError;n&&r&&s(l,"sticky",{configurable:!0,get:function(){if(this!==l){if("RegExp"===a(this))return!!o(this).sticky;throw u("Incompatible receiver, RegExp required")}}})}}]);