"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[991],{32434:function(e,t,i){i.r(t),i.d(t,{CONTEXT_ONTYPE_RENAME_INPUT_VISIBLE:function(){return E},LinkedEditingAction:function(){return T},LinkedEditingContribution:function(){return M},editorLinkedEditingBackground:function(){return S}});var n=i(16308),r=i(13484),s=i(97464),o=i(86741),c=i(20996),a=i(56709),l=i(38431),u=i(17416),d=i(28919),h=i(55298),g=i(5603),p=i(8964),f=i(50038),_=i(21081),v=i(132),k=i(29173),m=i(26386),L=i(70499),b=i(92537),C=i(58566),D=i(35921),R=i(69060),y=i(69344),P=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},O=function(e,t){return function(i,n){t(i,n,e)}},w=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{a(n.next(e))}catch(e){s(e)}}function c(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};const E=new L.uy("LinkedEditingInputVisible",!1),I="linked-editing-decoration";let M=class e extends l.JT{constructor(e,t,i,n,r){super(),this.languageConfigurationService=n,this._syncRangesToken=0,this._localToDispose=this._register(new l.SL),this._editor=e,this._providers=i.linkedEditingRangeProvider,this._enabled=!1,this._visibleContextKey=E.bindTo(t),this._debounceInformation=r.for(this._providers,"Linked Editing",{min:200}),this._currentDecorations=this._editor.createDecorationsCollection(),this._languageWordPattern=null,this._currentWordPattern=null,this._ignoreChangeEvent=!1,this._localToDispose=this._register(new l.SL),this._rangeUpdateTriggerPromise=null,this._rangeSyncTriggerPromise=null,this._currentRequest=null,this._currentRequestPosition=null,this._currentRequestModelVersion=null,this._register(this._editor.onDidChangeModel((()=>this.reinitialize(!0)))),this._register(this._editor.onDidChangeConfiguration((e=>{(e.hasChanged(64)||e.hasChanged(84))&&this.reinitialize(!1)}))),this._register(this._providers.onDidChange((()=>this.reinitialize(!1)))),this._register(this._editor.onDidChangeModelLanguage((()=>this.reinitialize(!0)))),this.reinitialize(!0)}static get(t){return t.getContribution(e.ID)}reinitialize(e){const t=this._editor.getModel(),i=null!==t&&(this._editor.getOption(64)||this._editor.getOption(84))&&this._providers.has(t);if(i===this._enabled&&!e)return;if(this._enabled=i,this.clearRanges(),this._localToDispose.clear(),!i||null===t)return;this._localToDispose.add(a.ju.runAndSubscribe(t.onDidChangeLanguageConfiguration,(()=>{this._languageWordPattern=this.languageConfigurationService.getLanguageConfiguration(t.getLanguageId()).getWordDefinition()})));const n=new r.vp(this._debounceInformation.get(t)),s=()=>{var e;this._rangeUpdateTriggerPromise=n.trigger((()=>this.updateRanges()),null!==(e=this._debounceDuration)&&void 0!==e?e:this._debounceInformation.get(t))},o=new r.vp(0),c=e=>{this._rangeSyncTriggerPromise=o.trigger((()=>this._syncRanges(e)))};this._localToDispose.add(this._editor.onDidChangeCursorPosition((()=>{s()}))),this._localToDispose.add(this._editor.onDidChangeModelContent((e=>{if(!this._ignoreChangeEvent&&this._currentDecorations.length>0){const t=this._currentDecorations.getRange(0);if(t&&e.changes.every((e=>t.intersectRanges(e.range))))return void c(this._syncRangesToken)}s()}))),this._localToDispose.add({dispose:()=>{n.dispose(),o.dispose()}}),this.updateRanges()}_syncRanges(e){if(!this._editor.hasModel()||e!==this._syncRangesToken||0===this._currentDecorations.length)return;const t=this._editor.getModel(),i=this._currentDecorations.getRange(0);if(!i||i.startLineNumber!==i.endLineNumber)return this.clearRanges();const n=t.getValueInRange(i);if(this._currentWordPattern){const e=n.match(this._currentWordPattern);if((e?e[0].length:0)!==n.length)return this.clearRanges()}const r=[];for(let e=1,i=this._currentDecorations.length;e<i;e++){const i=this._currentDecorations.getRange(e);if(i)if(i.startLineNumber!==i.endLineNumber)r.push({range:i,text:n});else{let e=t.getValueInRange(i),s=n,o=i.startColumn,c=i.endColumn;const a=u.Mh(e,s);o+=a,e=e.substr(a),s=s.substr(a);const l=u.P1(e,s);c-=l,e=e.substr(0,e.length-l),s=s.substr(0,s.length-l),o===c&&0===s.length||r.push({range:new f.e(i.startLineNumber,o,i.endLineNumber,c),text:s})}}if(0!==r.length)try{this._editor.popUndoStop(),this._ignoreChangeEvent=!0;const e=this._editor._getViewModel().getPrevEditOperationType();this._editor.executeEdits("linkedEditing",r),this._editor._getViewModel().setPrevEditOperationType(e)}finally{this._ignoreChangeEvent=!1}}dispose(){this.clearRanges(),super.dispose()}clearRanges(){this._visibleContextKey.set(!1),this._currentDecorations.clear(),this._currentRequest&&(this._currentRequest.cancel(),this._currentRequest=null,this._currentRequestPosition=null)}updateRanges(t=!1){return w(this,void 0,void 0,(function*(){if(!this._editor.hasModel())return void this.clearRanges();const i=this._editor.getPosition();if(!this._enabled&&!t||this._editor.getSelections().length>1)return void this.clearRanges();const n=this._editor.getModel(),s=n.getVersionId();if(this._currentRequestPosition&&this._currentRequestModelVersion===s){if(i.equals(this._currentRequestPosition))return;if(this._currentDecorations.length>0){const e=this._currentDecorations.getRange(0);if(e&&e.containsPosition(i))return}}this._currentRequestPosition=i,this._currentRequestModelVersion=s;const o=(0,r.PG)((t=>w(this,void 0,void 0,(function*(){try{const r=new y.G(!1),c=yield x(this._providers,n,i,t);if(this._debounceInformation.update(n,r.elapsed()),o!==this._currentRequest)return;if(this._currentRequest=null,s!==n.getVersionId())return;let a=[];(null==c?void 0:c.ranges)&&(a=c.ranges),this._currentWordPattern=(null==c?void 0:c.wordPattern)||this._languageWordPattern;let l=!1;for(let e=0,t=a.length;e<t;e++)if(f.e.containsPosition(a[e],i)){if(l=!0,0!==e){const t=a[e];a.splice(e,1),a.unshift(t)}break}if(!l)return void this.clearRanges();const u=a.map((t=>({range:t,options:e.DECORATION})));this._visibleContextKey.set(!0),this._currentDecorations.set(u),this._syncRangesToken++}catch(e){(0,c.n2)(e)||(0,c.dL)(e),this._currentRequest!==o&&this._currentRequest||this.clearRanges()}}))));return this._currentRequest=o,o}))}};M.ID="editor.contrib.linkedEditing",M.DECORATION=v.qx.register({description:"linked-editing",stickiness:0,className:I}),M=P([O(1,L.i6),O(2,D.p),O(3,k.c_),O(4,R.A)],M);class T extends h.R6{constructor(){super({id:"editor.action.linkedEditing",label:m.NC("linkedEditing.label","Start Linked Editing"),alias:"Start Linked Editing",precondition:L.Ao.and(_.u.writable,_.u.hasRenameProvider),kbOpts:{kbExpr:_.u.editorTextFocus,primary:3132,weight:100}})}runCommand(e,t){const i=e.get(g.$),[n,r]=Array.isArray(t)&&t||[void 0,void 0];return d.o.isUri(n)&&p.L.isIPosition(r)?i.openCodeEditor({resource:n},i.getActiveCodeEditor()).then((e=>{e&&(e.setPosition(r),e.invokeWithinContext((t=>(this.reportTelemetry(t,e),this.run(t,e)))))}),c.dL):super.runCommand(e,t)}run(e,t){const i=M.get(t);return i?Promise.resolve(i.updateRanges(!0)):Promise.resolve()}}const N=h._l.bindToContribution(M.get);function x(e,t,i,s){const o=e.ordered(t);return(0,r.Ps)(o.map((e=>()=>w(this,void 0,void 0,(function*(){try{return yield e.provideLinkedEditingRanges(t,i,s)}catch(e){return void(0,c.Cp)(e)}})))),(e=>!!e&&n.Of(null==e?void 0:e.ranges)))}(0,h.fK)(new N({id:"cancelLinkedEditingInput",precondition:E,handler:e=>e.clearRanges(),kbOpts:{kbExpr:_.u.editorTextFocus,weight:199,primary:9,secondary:[1033]}}));const S=(0,b.P6G)("editor.linkedEditingBackground",{dark:o.Il.fromHex("#f00").transparent(.3),light:o.Il.fromHex("#f00").transparent(.3),hcDark:o.Il.fromHex("#f00").transparent(.3),hcLight:o.Il.white},m.NC("editorLinkedEditingBackground","Background color when the editor auto renames on type."));(0,C.Ic)(((e,t)=>{const i=e.getColor(S);i&&t.addRule(`.monaco-editor .${I} { background: ${i}; border-left-color: ${i}; }`)})),(0,h.sb)("_executeLinkedEditingProvider",((e,t,i)=>{const{linkedEditingRangeProvider:n}=e.get(D.p);return x(n,t,i,s.T.None)})),(0,h._K)(M.ID,M),(0,h.Qr)(T)},20943:function(e,t,i){i.r(t),i.d(t,{LinkDetector:function(){return S}});var n=i(13484),r=i(97464),s=i(20996),o=i(69008),c=i(38431),a=i(5007),l=i(11138),u=i(6227),d=i(69344),h=i(28919),g=i(55298),p=i(132),f=i(69060),_=i(35921),v=i(66931),k=i(16308),m=i(14818),L=i(50038),b=i(65041),C=i(80793),D=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{a(n.next(e))}catch(e){s(e)}}function c(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};class R{constructor(e,t){this._link=e,this._provider=t}toJSON(){return{range:this.range,url:this.url,tooltip:this.tooltip}}get range(){return this._link.range}get url(){return this._link.url}get tooltip(){return this._link.tooltip}resolve(e){return D(this,void 0,void 0,(function*(){return this._link.url?this._link.url:"function"==typeof this._provider.resolveLink?Promise.resolve(this._provider.resolveLink(this._link,e)).then((t=>(this._link=t||this._link,this._link.url?this.resolve(e):Promise.reject(new Error("missing"))))):Promise.reject(new Error("missing"))}))}}class y{constructor(e){this._disposables=new c.SL;let t=[];for(const[i,n]of e){const e=i.links.map((e=>new R(e,n)));t=y._union(t,e),(0,c.Wf)(i)&&this._disposables.add(i)}this.links=t}dispose(){this._disposables.dispose(),this.links.length=0}static _union(e,t){const i=[];let n,r,s,o;for(n=0,s=0,r=e.length,o=t.length;n<r&&s<o;){const r=e[n],o=t[s];if(L.e.areIntersectingOrTouching(r.range,o.range)){n++;continue}L.e.compareRangesUsingStarts(r.range,o.range)<0?(i.push(r),n++):(i.push(o),s++)}for(;n<r;n++)i.push(e[n]);for(;s<o;s++)i.push(t[s]);return i}}function P(e,t,i){const n=[],r=e.ordered(t).reverse().map(((e,r)=>Promise.resolve(e.provideLinks(t,i)).then((t=>{t&&(n[r]=[t,e])}),s.Cp)));return Promise.all(r).then((()=>{const e=new y((0,k.kX)(n));return i.isCancellationRequested?(e.dispose(),new y([])):e}))}C.P0.registerCommand("_executeLinkProvider",((e,...t)=>D(void 0,void 0,void 0,(function*(){let[i,n]=t;(0,m.p_)(i instanceof h.o),"number"!=typeof n&&(n=0);const{linkProvider:s}=e.get(_.p),o=e.get(b.q).getModel(i);if(!o)return[];const c=yield P(s,o,r.T.None);if(!c)return[];for(let e=0;e<Math.min(n,c.links.length);e++)yield c.links[e].resolve(r.T.None);const a=c.links.slice(0);return c.dispose(),a}))));var O=i(26386),w=i(97968),E=i(48786),I=i(92537),M=i(58566),T=function(e,t,i,n){var r,s=arguments.length,o=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,i):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,i,n);else for(var c=e.length-1;c>=0;c--)(r=e[c])&&(o=(s<3?r(o):s>3?r(t,i,o):r(t,i))||o);return s>3&&o&&Object.defineProperty(t,i,o),o},N=function(e,t){return function(i,n){t(i,n,e)}},x=function(e,t,i,n){return new(i||(i=Promise))((function(r,s){function o(e){try{a(n.next(e))}catch(e){s(e)}}function c(e){try{a(n.throw(e))}catch(e){s(e)}}function a(e){var t;e.done?r(e.value):(t=e.value,t instanceof i?t:new i((function(e){e(t)}))).then(o,c)}a((n=n.apply(e,t||[])).next())}))};let S=class e extends c.JT{constructor(e,t,i,r,s){super(),this.editor=e,this.openerService=t,this.notificationService=i,this.languageFeaturesService=r,this.providers=this.languageFeaturesService.linkProvider,this.debounceInformation=s.for(this.providers,"Links",{min:1e3,max:4e3}),this.computeLinks=this._register(new n.pY((()=>this.computeLinksNow()),1e3)),this.computePromise=null,this.activeLinksList=null,this.currentOccurrences={},this.activeLinkDecorationId=null;const o=this._register(new v.yN(e));this._register(o.onMouseMoveOrRelevantKeyDown((([e,t])=>{this._onEditorMouseMove(e,t)}))),this._register(o.onExecute((e=>{this.onEditorMouseUp(e)}))),this._register(o.onCancel((e=>{this.cleanUpActiveLinkDecoration()}))),this._register(e.onDidChangeConfiguration((e=>{e.hasChanged(65)&&(this.updateDecorations([]),this.stop(),this.computeLinks.schedule(0))}))),this._register(e.onDidChangeModelContent((e=>{this.editor.hasModel()&&this.computeLinks.schedule(this.debounceInformation.get(this.editor.getModel()))}))),this._register(e.onDidChangeModel((e=>{this.currentOccurrences={},this.activeLinkDecorationId=null,this.stop(),this.computeLinks.schedule(0)}))),this._register(e.onDidChangeModelLanguage((e=>{this.stop(),this.computeLinks.schedule(0)}))),this._register(this.providers.onDidChange((e=>{this.stop(),this.computeLinks.schedule(0)}))),this.computeLinks.schedule(0)}static get(t){return t.getContribution(e.ID)}computeLinksNow(){return x(this,void 0,void 0,(function*(){if(!this.editor.hasModel()||!this.editor.getOption(65))return;const e=this.editor.getModel();if(this.providers.has(e)){this.activeLinksList&&(this.activeLinksList.dispose(),this.activeLinksList=null),this.computePromise=(0,n.PG)((t=>P(this.providers,e,t)));try{const t=new d.G(!1);if(this.activeLinksList=yield this.computePromise,this.debounceInformation.update(e,t.elapsed()),e.isDisposed())return;this.updateDecorations(this.activeLinksList.links)}catch(e){(0,s.dL)(e)}finally{this.computePromise=null}}}))}updateDecorations(e){const t="altKey"===this.editor.getOption(72),i=[],n=Object.keys(this.currentOccurrences);for(const e of n){const t=this.currentOccurrences[e];i.push(t.decorationId)}const r=[];if(e)for(const i of e)r.push(W.decoration(i,t));this.editor.changeDecorations((t=>{const n=t.deltaDecorations(i,r);this.currentOccurrences={},this.activeLinkDecorationId=null;for(let t=0,i=n.length;t<i;t++){const i=new W(e[t],n[t]);this.currentOccurrences[i.decorationId]=i}}))}_onEditorMouseMove(e,t){const i="altKey"===this.editor.getOption(72);if(this.isEnabled(e,t)){this.cleanUpActiveLinkDecoration();const t=this.getLinkOccurrence(e.target.position);t&&this.editor.changeDecorations((e=>{t.activate(e,i),this.activeLinkDecorationId=t.decorationId}))}else this.cleanUpActiveLinkDecoration()}cleanUpActiveLinkDecoration(){const e="altKey"===this.editor.getOption(72);if(this.activeLinkDecorationId){const t=this.currentOccurrences[this.activeLinkDecorationId];t&&this.editor.changeDecorations((i=>{t.deactivate(i,e)})),this.activeLinkDecorationId=null}}onEditorMouseUp(e){if(!this.isEnabled(e))return;const t=this.getLinkOccurrence(e.target.position);t&&this.openLinkOccurrence(t,e.hasSideBySideModifier,!0)}openLinkOccurrence(e,t,i=!1){if(!this.openerService)return;const{link:n}=e;n.resolve(r.T.None).then((e=>{if("string"==typeof e&&this.editor.hasModel()){const t=this.editor.getModel().uri;if(t.scheme===a.lg.file&&e.startsWith(`${a.lg.file}:`)){const i=h.o.parse(e);if(i.scheme===a.lg.file){const n=u.z_(i);let r=null;n.startsWith("/./")?r=`.${n.substr(1)}`:n.startsWith("//./")&&(r=`.${n.substr(2)}`),r&&(e=u.Vo(t,r))}}}return this.openerService.open(e,{openToSide:t,fromUserGesture:i,allowContributedOpeners:!0,allowCommands:!0,fromWorkspace:!0})}),(e=>{const t=e instanceof Error?e.message:e;"invalid"===t?this.notificationService.warn(O.NC("invalid.url","Failed to open this link because it is not well-formed: {0}",n.url.toString())):"missing"===t?this.notificationService.warn(O.NC("missing.url","Failed to open this link because its target is missing.")):(0,s.dL)(e)}))}getLinkOccurrence(e){if(!this.editor.hasModel()||!e)return null;const t=this.editor.getModel().getDecorationsInRange({startLineNumber:e.lineNumber,startColumn:e.column,endLineNumber:e.lineNumber,endColumn:e.column},0,!0);for(const e of t){const t=this.currentOccurrences[e.id];if(t)return t}return null}isEnabled(e,t){return Boolean(6===e.target.type&&(e.hasTriggerModifier||t&&t.keyCodeIsTriggerKey))}stop(){var e;this.computeLinks.cancel(),this.activeLinksList&&(null===(e=this.activeLinksList)||void 0===e||e.dispose(),this.activeLinksList=null),this.computePromise&&(this.computePromise.cancel(),this.computePromise=null)}dispose(){super.dispose(),this.stop()}};S.ID="editor.linkDetector",S=T([N(1,E.v4),N(2,w.lT),N(3,_.p),N(4,f.A)],S);const q={general:p.qx.register({description:"detected-link",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link"}),active:p.qx.register({description:"detected-link-active",stickiness:1,collapseOnReplaceEdit:!0,inlineClassName:"detected-link-active"})};class W{constructor(e,t){this.link=e,this.decorationId=t}static decoration(e,t){return{range:e.range,options:W._getOptions(e,t,!1)}}static _getOptions(e,t,i){const n=Object.assign({},i?q.active:q.general);return n.hoverMessage=function(e,t){const i=e.url&&/^command:/i.test(e.url.toString()),n=e.tooltip?e.tooltip:i?O.NC("links.navigate.executeCmd","Execute command"):O.NC("links.navigate.follow","Follow link"),r=t?l.dz?O.NC("links.navigate.kb.meta.mac","cmd + click"):O.NC("links.navigate.kb.meta","ctrl + click"):l.dz?O.NC("links.navigate.kb.alt.mac","option + click"):O.NC("links.navigate.kb.alt","alt + click");if(e.url){let t="";if(/^command:/i.test(e.url.toString())){const i=e.url.toString().match(/^command:([^?#]+)/);if(i){const e=i[1];t=O.NC("tooltip.explanation","Execute command {0}",e)}}return new o.W5("",!0).appendLink(e.url.toString(!0).replace(/ /g,"%20"),n,t).appendMarkdown(` (${r})`)}return(new o.W5).appendText(`${n} (${r})`)}(e,t),n}activate(e,t){e.changeDecorationOptions(this.decorationId,W._getOptions(this.link,t,!0))}deactivate(e,t){e.changeDecorationOptions(this.decorationId,W._getOptions(this.link,t,!1))}}class A extends g.R6{constructor(){super({id:"editor.action.openLink",label:O.NC("label","Open Link"),alias:"Open Link",precondition:void 0})}run(e,t){const i=S.get(t);if(!i)return;if(!t.hasModel())return;const n=t.getSelections();for(const e of n){const t=i.getLinkOccurrence(e.getEndPosition());t&&i.openLinkOccurrence(t,!1)}}}(0,g._K)(S.ID,S),(0,g.Qr)(A),(0,M.Ic)(((e,t)=>{const i=e.getColor(I._Yy);i&&t.addRule(`.monaco-editor .detected-link-active { color: ${i} !important; }`)}))}}]);