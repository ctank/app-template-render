"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[8078],{58806:function(t,e,i){i.d(e,{H:function(){return A},h:function(){return y}});var s=i(34441),o=i(82829),n=i(16308),r=i(38431),h=i(8964),a=i(50038),c=i(132),l=i(16012),d=i(41855),_=i(72223),g=i(70499),u=i(44333),p=i(55495),m=i(33024),v=i(13484),f=i(21081),C=function(t,e,i,s){var o,n=arguments.length,r=n<3?e:null===s?s=Object.getOwnPropertyDescriptor(e,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(t,e,i,s);else for(var h=t.length-1;h>=0;h--)(o=t[h])&&(r=(n<3?o(r):n>3?o(e,i,r):o(e,i))||r);return n>3&&r&&Object.defineProperty(e,i,r),r},D=function(t,e){return function(i,s){e(i,s,t)}};const b=s.$;let y=class t extends r.JT{constructor(t,e,i){super(),this._editor=t,this._instantiationService=e,this._keybindingService=i,this._widget=this._register(this._instantiationService.createInstance(A,this._editor)),this._isChangingDecorations=!1,this._messages=[],this._messagesAreComplete=!1,this._participants=[];for(const t of _.Ae.getAll())this._participants.push(this._instantiationService.createInstance(t,this._editor));this._participants.sort(((t,e)=>t.hoverOrdinal-e.hoverOrdinal)),this._computer=new S(this._editor,this._participants),this._hoverOperation=this._register(new d.H(this._editor,this._computer)),this._register(this._hoverOperation.onResult((t=>{this._withResult(t.value,t.isComplete,t.hasLoadingMessage)}))),this._register(this._editor.onDidChangeModelDecorations((()=>{this._isChangingDecorations||this._onModelDecorationsChanged()}))),this._register(s.mu(this._widget.getDomNode(),"keydown",(t=>{t.equals(9)&&this.hide()}))),this._register(l.RW.onDidChange((()=>{this._widget.position&&this._computer.anchor&&this._messages.length>0&&(this._widget.clear(),this._renderMessages(this._computer.anchor,this._messages))})))}_onModelDecorationsChanged(){this._widget.position&&(this._hoverOperation.cancel(),this._widget.isColorPickerVisible||this._hoverOperation.start(0))}maybeShowAt(t){const e=[];for(const i of this._participants)if(i.suggestHoverAnchor){const s=i.suggestHoverAnchor(t);s&&e.push(s)}const i=t.target;if(6===i.type&&e.push(new _.Qj(0,i.range)),7===i.type){const t=this._editor.getOption(46).typicalHalfwidthCharacterWidth/2;!i.detail.isAfterLines&&"number"==typeof i.detail.horizontalDistanceToText&&i.detail.horizontalDistanceToText<t&&e.push(new _.Qj(0,i.range))}return 0!==e.length&&(e.sort(((t,e)=>e.priority-t.priority)),this._startShowingAt(e[0],0,!1),!0)}startShowingAtRange(t,e,i){this._startShowingAt(new _.Qj(0,t),e,i)}_startShowingAt(t,e,i){if(!this._computer.anchor||!this._computer.anchor.equals(t)){if(this._hoverOperation.cancel(),this._widget.position)if(this._computer.anchor&&t.canAdoptVisibleHover(this._computer.anchor,this._widget.position)){const e=this._messages.filter((e=>e.isValidForHoverAnchor(t)));if(0===e.length)this.hide();else{if(e.length===this._messages.length&&this._messagesAreComplete)return;this._renderMessages(t,e)}}else this.hide();this._computer.anchor=t,this._computer.shouldFocus=i,this._hoverOperation.start(e)}}hide(){this._computer.anchor=null,this._hoverOperation.cancel(),this._widget.hide()}isColorPickerVisible(){return this._widget.isColorPickerVisible}containsNode(t){return this._widget.getDomNode().contains(t)}_addLoadingMessage(t){if(this._computer.anchor)for(const e of this._participants)if(e.createLoadingMessage){const i=e.createLoadingMessage(this._computer.anchor);if(i)return t.slice(0).concat([i])}return t}_withResult(t,e,i){this._messages=i?this._addLoadingMessage(t):t,this._messagesAreComplete=e,this._computer.anchor&&this._messages.length>0?this._renderMessages(this._computer.anchor,this._messages):e&&this.hide()}_renderMessages(e,i){const{showAtPosition:s,showAtRange:o,highlightRange:n}=t.computeHoverRanges(e.range,i),h=new r.SL,a=h.add(new N(this._keybindingService)),c=document.createDocumentFragment();let l=null;const d={fragment:c,statusBar:a,setColorPicker:t=>l=t,onContentsChanged:()=>this._widget.onContentsChanged(),hide:()=>this.hide()};for(const t of this._participants){const e=i.filter((e=>e.owner===t));e.length>0&&h.add(t.renderHoverParts(d,e))}if(a.hasContent&&c.appendChild(a.hoverElement),c.hasChildNodes()){if(n){const e=this._editor.createDecorationsCollection();try{this._isChangingDecorations=!0,e.set([{range:n,options:t._DECORATION_OPTIONS}])}finally{this._isChangingDecorations=!1}h.add((0,r.OF)((()=>{try{this._isChangingDecorations=!0,e.clear()}finally{this._isChangingDecorations=!1}})))}this._widget.showAt(c,new w(l,s,o,this._editor.getOption(55).above,this._computer.shouldFocus,h))}else h.dispose()}static computeHoverRanges(t,e){const i=t.startLineNumber;let s=t.startColumn,o=t.endColumn,n=e[0].range,r=null;for(const t of e)n=a.e.plusRange(n,t.range),t.range.startLineNumber===i&&t.range.endLineNumber===i&&(s=Math.min(s,t.range.startColumn),o=Math.max(o,t.range.endColumn)),t.forceShowAtRange&&(r=t.range);return{showAtPosition:r?r.getStartPosition():new h.L(t.startLineNumber,s),showAtRange:r||new a.e(i,s,i,o),highlightRange:n}}};y._DECORATION_OPTIONS=c.qx.register({description:"content-hover-highlight",className:"hoverHighlight"}),y=C([D(1,u.TG),D(2,p.d)],y);class w{constructor(t,e,i,s,o,n){this.colorPicker=t,this.showAtPosition=e,this.showAtRange=i,this.preferAbove=s,this.stoleFocus=o,this.disposables=n}}let A=class t extends r.JT{constructor(t,e){super(),this._editor=t,this._contextKeyService=e,this.allowEditorOverflow=!0,this._hoverVisibleKey=f.u.hoverVisible.bindTo(this._contextKeyService),this._hover=this._register(new o.c),this._visibleData=null,this._register(this._editor.onDidLayoutChange((()=>this._layout()))),this._register(this._editor.onDidChangeConfiguration((t=>{t.hasChanged(46)&&this._updateFont()}))),this._setVisibleData(null),this._layout(),this._editor.addContentWidget(this)}get position(){var t,e;return null!==(e=null===(t=this._visibleData)||void 0===t?void 0:t.showAtPosition)&&void 0!==e?e:null}get isColorPickerVisible(){var t;return Boolean(null===(t=this._visibleData)||void 0===t?void 0:t.colorPicker)}dispose(){this._editor.removeContentWidget(this),this._visibleData&&this._visibleData.disposables.dispose(),super.dispose()}getId(){return t.ID}getDomNode(){return this._hover.containerDomNode}getPosition(){if(!this._visibleData)return null;let t=this._visibleData.preferAbove;return!t&&this._contextKeyService.getContextKeyValue(m._y.Visible.key)&&(t=!0),{position:this._visibleData.showAtPosition,range:this._visibleData.showAtRange,preference:t?[1,2]:[2,1]}}_setVisibleData(t){this._visibleData&&this._visibleData.disposables.dispose(),this._visibleData=t,this._hoverVisibleKey.set(!!this._visibleData),this._hover.containerDomNode.classList.toggle("hidden",!this._visibleData)}_layout(){const t=Math.max(this._editor.getLayoutInfo().height/4,250),{fontSize:e,lineHeight:i}=this._editor.getOption(46);this._hover.contentsDomNode.style.fontSize=`${e}px`,this._hover.contentsDomNode.style.lineHeight=""+i/e,this._hover.contentsDomNode.style.maxHeight=`${t}px`,this._hover.contentsDomNode.style.maxWidth=`${Math.max(.66*this._editor.getLayoutInfo().width,500)}px`}_updateFont(){Array.prototype.slice.call(this._hover.contentsDomNode.getElementsByClassName("code")).forEach((t=>this._editor.applyFontInfo(t)))}showAt(t,e){this._setVisibleData(e),this._hover.contentsDomNode.textContent="",this._hover.contentsDomNode.appendChild(t),this._hover.contentsDomNode.style.paddingBottom="",this._updateFont(),this.onContentsChanged(),this._editor.render(),this.onContentsChanged(),e.stoleFocus&&this._hover.containerDomNode.focus(),e.colorPicker&&e.colorPicker.layout()}hide(){if(this._visibleData){const t=this._visibleData.stoleFocus;this._setVisibleData(null),this._editor.layoutContentWidget(this),t&&this._editor.focus()}}onContentsChanged(){this._editor.layoutContentWidget(this),this._hover.onContentsChanged();const t=this._hover.scrollbar.getScrollDimensions();if(t.scrollWidth>t.width){const t=`${this._hover.scrollbar.options.horizontalScrollbarSize}px`;this._hover.contentsDomNode.style.paddingBottom!==t&&(this._hover.contentsDomNode.style.paddingBottom=t,this._editor.layoutContentWidget(this),this._hover.onContentsChanged())}}clear(){this._hover.contentsDomNode.textContent=""}};A.ID="editor.contrib.contentHoverWidget",A=C([D(1,g.i6)],A);let N=class extends r.JT{constructor(t){super(),this._keybindingService=t,this._hasContent=!1,this.hoverElement=b("div.hover-row.status-bar"),this.actionsElement=s.R3(this.hoverElement,b("div.actions"))}get hasContent(){return this._hasContent}addAction(t){const e=this._keybindingService.lookupKeybinding(t.commandId),i=e?e.getLabel():null;return this._hasContent=!0,this._register(o.S.render(this.actionsElement,t,i))}append(t){const e=s.R3(this.actionsElement,t);return this._hasContent=!0,e}};N=C([D(0,p.d)],N);class S{constructor(t,e){this._editor=t,this._participants=e,this._anchor=null,this._shouldFocus=!1}get anchor(){return this._anchor}set anchor(t){this._anchor=t}get shouldFocus(){return this._shouldFocus}set shouldFocus(t){this._shouldFocus=t}static _getLineDecorations(t,e){if(1!==e.type)return[];const i=t.getModel(),s=e.range.startLineNumber;if(s>i.getLineCount())return[];const o=i.getLineMaxColumn(s);return t.getLineDecorations(s).filter((t=>{if(t.options.isWholeLine)return!0;const i=t.range.startLineNumber===s?t.range.startColumn:1,n=t.range.endLineNumber===s?t.range.endColumn:o;if(t.options.showIfCollapsed){if(i>e.range.startColumn+1||e.range.endColumn-1>n)return!1}else if(i>e.range.startColumn||e.range.endColumn>n)return!1;return!0}))}computeAsync(t){const e=this._anchor;if(!this._editor.hasModel()||!e)return v.Aq.EMPTY;const i=S._getLineDecorations(this._editor,e);return v.Aq.merge(this._participants.map((s=>s.computeAsync?s.computeAsync(e,i,t):v.Aq.EMPTY)))}computeSync(){if(!this._editor.hasModel()||!this._anchor)return[];const t=S._getLineDecorations(this._editor,this._anchor);let e=[];for(const i of this._participants)e=e.concat(i.computeSync(this._anchor,t));return(0,n.kX)(e)}}}}]);