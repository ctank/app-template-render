"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[6567],{34319:function(e,t,i){i.d(t,{l:function(){return y}});var s=i(16308),o=i(38431),n=i(17416),r=i(19083),a=i(50038),l=i(57841),c=i(29173),h=i(132),p=i(18680),d=i(83799),_=i(35366),u=i(31307),g=i(91686),f=i(6227),N=i(38577),m=i(26386),C=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},S=function(e,t){return function(i,s){t(i,s,e)}};Object.freeze({CURRENT_YEAR:!0,CURRENT_YEAR_SHORT:!0,CURRENT_MONTH:!0,CURRENT_DATE:!0,CURRENT_HOUR:!0,CURRENT_MINUTE:!0,CURRENT_SECOND:!0,CURRENT_DAY_NAME:!0,CURRENT_DAY_NAME_SHORT:!0,CURRENT_MONTH_NAME:!0,CURRENT_MONTH_NAME_SHORT:!0,CURRENT_SECONDS_UNIX:!0,SELECTION:!0,CLIPBOARD:!0,TM_SELECTED_TEXT:!0,TM_CURRENT_LINE:!0,TM_CURRENT_WORD:!0,TM_LINE_INDEX:!0,TM_LINE_NUMBER:!0,TM_FILENAME:!0,TM_FILENAME_BASE:!0,TM_DIRECTORY:!0,TM_FILEPATH:!0,CURSOR_INDEX:!0,CURSOR_NUMBER:!0,RELATIVE_FILEPATH:!0,BLOCK_COMMENT_START:!0,BLOCK_COMMENT_END:!0,LINE_COMMENT:!0,WORKSPACE_NAME:!0,WORKSPACE_FOLDER:!0,RANDOM:!0,RANDOM_HEX:!0,UUID:!0});class E{constructor(e){this._delegates=e}resolve(e){for(const t of this._delegates){const i=t.resolve(e);if(void 0!==i)return i}}}class v{constructor(e,t,i,s){this._model=e,this._selection=t,this._selectionIdx=i,this._overtypingCapturer=s}resolve(e){const{name:t}=e;if("SELECTION"===t||"TM_SELECTED_TEXT"===t){let t=this._model.getValueInRange(this._selection)||void 0,i=this._selection.startLineNumber!==this._selection.endLineNumber;if(!t&&this._overtypingCapturer){const e=this._overtypingCapturer.getLastOvertypedInfo(this._selectionIdx);e&&(t=e.value,i=e.multiline)}if(t&&i&&e.snippet){const i=this._model.getLineContent(this._selection.startLineNumber),s=(0,n.V8)(i,0,this._selection.startColumn-1);let o=s;e.snippet.walk((t=>t!==e&&(t instanceof _.xv&&(o=(0,n.V8)((0,n.uq)(t.value).pop())),!0)));const r=(0,n.Mh)(o,s);t=t.replace(/(\r\n|\r|\n)(.*)/g,((e,t,i)=>`${t}${o.substr(r)}${i}`))}return t}if("TM_CURRENT_LINE"===t)return this._model.getLineContent(this._selection.positionLineNumber);if("TM_CURRENT_WORD"===t){const e=this._model.getWordAtPosition({lineNumber:this._selection.positionLineNumber,column:this._selection.positionColumn});return e&&e.word||void 0}return"TM_LINE_INDEX"===t?String(this._selection.positionLineNumber-1):"TM_LINE_NUMBER"===t?String(this._selection.positionLineNumber):"CURSOR_INDEX"===t?String(this._selectionIdx):"CURSOR_NUMBER"===t?String(this._selectionIdx+1):void 0}}class R{constructor(e,t){this._labelService=e,this._model=t}resolve(e){const{name:t}=e;if("TM_FILENAME"===t)return g.EZ(this._model.uri.fsPath);if("TM_FILENAME_BASE"===t){const e=g.EZ(this._model.uri.fsPath),t=e.lastIndexOf(".");return t<=0?e:e.slice(0,t)}return"TM_DIRECTORY"===t?"."===g.XX(this._model.uri.fsPath)?"":this._labelService.getUriLabel((0,f.XX)(this._model.uri)):"TM_FILEPATH"===t?this._labelService.getUriLabel(this._model.uri):"RELATIVE_FILEPATH"===t?this._labelService.getUriLabel(this._model.uri,{relative:!0,noPrefix:!0}):void 0}}class T{constructor(e,t,i,s){this._readClipboardText=e,this._selectionIdx=t,this._selectionCount=i,this._spread=s}resolve(e){if("CLIPBOARD"!==e.name)return;const t=this._readClipboardText();if(t){if(this._spread){const e=t.split(/\r\n|\n|\r/).filter((e=>!(0,n.m5)(e)));if(e.length===this._selectionCount)return e[this._selectionIdx]}return t}}}let M=class{constructor(e,t,i){this._model=e,this._selection=t,this._languageConfigurationService=i}resolve(e){const{name:t}=e,i=this._model.getLanguageIdAtPosition(this._selection.selectionStartLineNumber,this._selection.selectionStartColumn),s=this._languageConfigurationService.getLanguageConfiguration(i).comments;if(s)return"LINE_COMMENT"===t?s.lineCommentToken||void 0:"BLOCK_COMMENT_START"===t?s.blockCommentStartToken||void 0:"BLOCK_COMMENT_END"===t&&s.blockCommentEndToken||void 0}};M=C([S(2,c.c_)],M);class b{constructor(){this._date=new Date}resolve(e){const{name:t}=e;return"CURRENT_YEAR"===t?String(this._date.getFullYear()):"CURRENT_YEAR_SHORT"===t?String(this._date.getFullYear()).slice(-2):"CURRENT_MONTH"===t?String(this._date.getMonth().valueOf()+1).padStart(2,"0"):"CURRENT_DATE"===t?String(this._date.getDate().valueOf()).padStart(2,"0"):"CURRENT_HOUR"===t?String(this._date.getHours().valueOf()).padStart(2,"0"):"CURRENT_MINUTE"===t?String(this._date.getMinutes().valueOf()).padStart(2,"0"):"CURRENT_SECOND"===t?String(this._date.getSeconds().valueOf()).padStart(2,"0"):"CURRENT_DAY_NAME"===t?b.dayNames[this._date.getDay()]:"CURRENT_DAY_NAME_SHORT"===t?b.dayNamesShort[this._date.getDay()]:"CURRENT_MONTH_NAME"===t?b.monthNames[this._date.getMonth()]:"CURRENT_MONTH_NAME_SHORT"===t?b.monthNamesShort[this._date.getMonth()]:"CURRENT_SECONDS_UNIX"===t?String(Math.floor(this._date.getTime()/1e3)):void 0}}b.dayNames=[m.NC("Sunday","Sunday"),m.NC("Monday","Monday"),m.NC("Tuesday","Tuesday"),m.NC("Wednesday","Wednesday"),m.NC("Thursday","Thursday"),m.NC("Friday","Friday"),m.NC("Saturday","Saturday")],b.dayNamesShort=[m.NC("SundayShort","Sun"),m.NC("MondayShort","Mon"),m.NC("TuesdayShort","Tue"),m.NC("WednesdayShort","Wed"),m.NC("ThursdayShort","Thu"),m.NC("FridayShort","Fri"),m.NC("SaturdayShort","Sat")],b.monthNames=[m.NC("January","January"),m.NC("February","February"),m.NC("March","March"),m.NC("April","April"),m.NC("May","May"),m.NC("June","June"),m.NC("July","July"),m.NC("August","August"),m.NC("September","September"),m.NC("October","October"),m.NC("November","November"),m.NC("December","December")],b.monthNamesShort=[m.NC("JanuaryShort","Jan"),m.NC("FebruaryShort","Feb"),m.NC("MarchShort","Mar"),m.NC("AprilShort","Apr"),m.NC("MayShort","May"),m.NC("JuneShort","Jun"),m.NC("JulyShort","Jul"),m.NC("AugustShort","Aug"),m.NC("SeptemberShort","Sep"),m.NC("OctoberShort","Oct"),m.NC("NovemberShort","Nov"),m.NC("DecemberShort","Dec")];class D{constructor(e){this._workspaceService=e}resolve(e){if(!this._workspaceService)return;const t=(0,d.uT)(this._workspaceService.getWorkspace());return t?"WORKSPACE_NAME"===e.name?this._resolveWorkspaceName(t):"WORKSPACE_FOLDER"===e.name?this._resoveWorkspacePath(t):void 0:void 0}_resolveWorkspaceName(e){if((0,d.eb)(e))return g.EZ(e.uri.path);let t=g.EZ(e.configPath.path);return t.endsWith(d.A6)&&(t=t.substr(0,t.length-d.A6.length-1)),t}_resoveWorkspacePath(e){if((0,d.eb)(e))return(0,u.D)(e.uri.fsPath);const t=g.EZ(e.configPath.path);let i=e.configPath.fsPath;return i.endsWith(t)&&(i=i.substr(0,i.length-t.length-1)),i?(0,u.D)(i):"/"}}class L{resolve(e){const{name:t}=e;return"RANDOM"===t?Math.random().toString().slice(-6):"RANDOM_HEX"===t?Math.random().toString(16).slice(-6):"UUID"===t?(0,N.R)():void 0}}var O=function(e,t,i,s){var o,n=arguments.length,r=n<3?t:null===s?s=Object.getOwnPropertyDescriptor(t,i):s;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,i,s);else for(var a=e.length-1;a>=0;a--)(o=e[a])&&(r=(n<3?o(r):n>3?o(t,i,r):o(t,i))||r);return n>3&&r&&Object.defineProperty(t,i,r),r},I=function(e,t){return function(i,s){t(i,s,e)}};class A{constructor(e,t,i){this._editor=e,this._snippet=t,this._snippetLineLeadingWhitespace=i,this._offset=-1,this._nestingLevel=1,this._placeholderGroups=(0,s.vM)(t.placeholders,_.Vm.compareByIndex),this._placeholderGroupsIdx=-1}initialize(e){this._offset=e.newPosition}dispose(){this._placeholderDecorations&&this._editor.removeDecorations([...this._placeholderDecorations.values()]),this._placeholderGroups.length=0}_initDecorations(){if(-1===this._offset)throw new Error("Snippet not initialized!");if(this._placeholderDecorations)return;this._placeholderDecorations=new Map;const e=this._editor.getModel();this._editor.changeDecorations((t=>{for(const i of this._snippet.placeholders){const s=this._snippet.offset(i),o=this._snippet.fullLen(i),n=a.e.fromPositions(e.getPositionAt(this._offset+s),e.getPositionAt(this._offset+s+o)),r=i.isFinalTabstop?A._decor.inactiveFinal:A._decor.inactive,l=t.addDecoration(n,r);this._placeholderDecorations.set(i,l)}}))}move(e){if(!this._editor.hasModel())return[];if(this._initDecorations(),this._placeholderGroupsIdx>=0){const e=[];for(const t of this._placeholderGroups[this._placeholderGroupsIdx])if(t.transform){const i=this._placeholderDecorations.get(t),s=this._editor.getModel().getDecorationRange(i),o=this._editor.getModel().getValueInRange(s),n=t.transform.resolve(o).split(/\r\n|\r|\n/);for(let e=1;e<n.length;e++)n[e]=this._editor.getModel().normalizeIndentation(this._snippetLineLeadingWhitespace+n[e]);e.push(r.h.replace(s,n.join(this._editor.getModel().getEOL())))}e.length>0&&this._editor.executeEdits("snippet.placeholderTransform",e)}let t=!1;!0===e&&this._placeholderGroupsIdx<this._placeholderGroups.length-1?(this._placeholderGroupsIdx+=1,t=!0):!1===e&&this._placeholderGroupsIdx>0&&(this._placeholderGroupsIdx-=1,t=!0);const i=this._editor.getModel().changeDecorations((e=>{const i=new Set,s=[];for(const o of this._placeholderGroups[this._placeholderGroupsIdx]){const n=this._placeholderDecorations.get(o),r=this._editor.getModel().getDecorationRange(n);s.push(new l.Y(r.startLineNumber,r.startColumn,r.endLineNumber,r.endColumn)),t=t&&this._hasPlaceholderBeenCollapsed(o),e.changeDecorationOptions(n,o.isFinalTabstop?A._decor.activeFinal:A._decor.active),i.add(o);for(const t of this._snippet.enclosingPlaceholders(o)){const s=this._placeholderDecorations.get(t);e.changeDecorationOptions(s,t.isFinalTabstop?A._decor.activeFinal:A._decor.active),i.add(t)}}for(const[t,s]of this._placeholderDecorations)i.has(t)||e.changeDecorationOptions(s,t.isFinalTabstop?A._decor.inactiveFinal:A._decor.inactive);return s}));return t?this.move(e):null!=i?i:[]}_hasPlaceholderBeenCollapsed(e){let t=e;for(;t;){if(t instanceof _.Vm){const e=this._placeholderDecorations.get(t);if(this._editor.getModel().getDecorationRange(e).isEmpty()&&t.toString().length>0)return!0}t=t.parent}return!1}get isAtFirstPlaceholder(){return this._placeholderGroupsIdx<=0||0===this._placeholderGroups.length}get isAtLastPlaceholder(){return this._placeholderGroupsIdx===this._placeholderGroups.length-1}get hasPlaceholder(){return this._snippet.placeholders.length>0}get isTrivialSnippet(){return 0===this._snippet.placeholders.length||1===this._snippet.placeholders.length&&this._snippet.placeholders[0].isFinalTabstop}computePossibleSelections(){const e=new Map;for(const t of this._placeholderGroups){let i;for(const s of t){if(s.isFinalTabstop)break;i||(i=[],e.set(s.index,i));const t=this._placeholderDecorations.get(s),o=this._editor.getModel().getDecorationRange(t);if(!o){e.delete(s.index);break}i.push(o)}}return e}get activeChoice(){if(!this._placeholderDecorations)return;const e=this._placeholderGroups[this._placeholderGroupsIdx][0];if(!(null==e?void 0:e.choice))return;const t=this._placeholderDecorations.get(e);if(!t)return;const i=this._editor.getModel().getDecorationRange(t);return i?{range:i,choice:e.choice}:void 0}get hasChoice(){let e=!1;return this._snippet.walk((t=>(e=t instanceof _.Lv,!e))),e}merge(e){const t=this._editor.getModel();this._nestingLevel*=10,this._editor.changeDecorations((i=>{for(const s of this._placeholderGroups[this._placeholderGroupsIdx]){const o=e.shift(),n=o._snippet.placeholderInfo.last.index;for(const e of o._snippet.placeholderInfo.all)e.isFinalTabstop?e.index=s.index+(n+1)/this._nestingLevel:e.index=s.index+e.index/this._nestingLevel;this._snippet.replace(s,o._snippet.children);const r=this._placeholderDecorations.get(s);i.removeDecoration(r),this._placeholderDecorations.delete(s);for(const e of o._snippet.placeholders){const s=o._snippet.offset(e),n=o._snippet.fullLen(e),r=a.e.fromPositions(t.getPositionAt(o._offset+s),t.getPositionAt(o._offset+s+n)),l=i.addDecoration(r,A._decor.inactive);this._placeholderDecorations.set(e,l)}}this._placeholderGroups=(0,s.vM)(this._snippet.placeholders,_.Vm.compareByIndex)}))}}A._decor={active:h.qx.register({description:"snippet-placeholder-1",stickiness:0,className:"snippet-placeholder"}),inactive:h.qx.register({description:"snippet-placeholder-2",stickiness:1,className:"snippet-placeholder"}),activeFinal:h.qx.register({description:"snippet-placeholder-3",stickiness:1,className:"finish-snippet-placeholder"}),inactiveFinal:h.qx.register({description:"snippet-placeholder-4",stickiness:1,className:"finish-snippet-placeholder"})};const P={overwriteBefore:0,overwriteAfter:0,adjustWhitespace:!0,clipboardText:void 0,overtypingCapturer:void 0};let y=class e{constructor(e,t,i=P,s){this._editor=e,this._template=t,this._options=i,this._languageConfigurationService=s,this._templateMerges=[],this._snippets=[]}static adjustWhitespace(e,t,i,s,o){const r=e.getLineContent(t.lineNumber),a=(0,n.V8)(r,0,t.column-1);let l;return i.walk((t=>{if(!(t instanceof _.xv)||t.parent instanceof _.Lv)return!0;const o=t.value.split(/\r\n|\r|\n/);if(s){const s=i.offset(t);if(0===s)o[0]=e.normalizeIndentation(o[0]);else{l=null!=l?l:i.toString();const t=l.charCodeAt(s-1);10!==t&&13!==t||(o[0]=e.normalizeIndentation(a+o[0]))}for(let t=1;t<o.length;t++)o[t]=e.normalizeIndentation(a+o[t])}const n=o.join(e.getEOL());return n!==t.value&&(t.parent.replace(t,[new _.xv(n)]),l=void 0),!0})),a}static adjustSelection(e,t,i,s){if(0!==i||0!==s){const{positionLineNumber:o,positionColumn:n}=t,r=n-i,a=n+s,c=e.validateRange({startLineNumber:o,startColumn:r,endLineNumber:o,endColumn:a});t=l.Y.createWithDirection(c.startLineNumber,c.startColumn,c.endLineNumber,c.endColumn,t.getDirection())}return t}static createEditsAndSnippetsFromSelections(t,i,s,o,n,l,c,h,u){const g=[],f=[];if(!t.hasModel())return{edits:g,snippets:f};const N=t.getModel(),m=t.invokeWithinContext((e=>e.get(d.ec))),C=t.invokeWithinContext((e=>new R(e.get(p.e),N))),S=()=>c,O=N.getValueInRange(e.adjustSelection(N,t.getSelection(),s,0)),I=N.getValueInRange(e.adjustSelection(N,t.getSelection(),0,o)),P=N.getLineFirstNonWhitespaceColumn(t.getSelection().positionLineNumber),y=t.getSelections().map(((e,t)=>({selection:e,idx:t}))).sort(((e,t)=>a.e.compareRangesUsingStarts(e.selection,t.selection)));for(const{selection:a,idx:c}of y){let p=e.adjustSelection(N,a,s,0),d=e.adjustSelection(N,a,0,o);O!==N.getValueInRange(p)&&(p=a),I!==N.getValueInRange(d)&&(d=a);const R=a.setStartPosition(p.startLineNumber,p.startColumn).setEndPosition(d.endLineNumber,d.endColumn),x=(new _.Yj).parse(i,!0,n),U=R.getStartPosition(),w=e.adjustWhitespace(N,U,x,l||c>0&&P!==N.getLineFirstNonWhitespaceColumn(a.positionLineNumber),!0);x.resolveVariables(new E([C,new T(S,c,y.length,"spread"===t.getOption(73)),new v(N,a,c,h),new M(N,a,u),new b,new D(m),new L])),g[c]=r.h.replace(R,x.toString()),g[c].identifier={major:c,minor:0},g[c]._isTracked=!0,f[c]=new A(t,x,w)}return{edits:g,snippets:f}}static createEditsAndSnippetsFromEdits(e,t,i,s,o,n,l){if(!e.hasModel()||0===t.length)return{edits:[],snippets:[]};const c=[],h=e.getModel(),u=new _.Yj,g=new _.y1,f=new E([e.invokeWithinContext((e=>new R(e.get(p.e),h))),new T((()=>o),0,e.getSelections().length,"spread"===e.getOption(73)),new v(h,e.getSelection(),0,n),new M(h,e.getSelection(),l),new b,new D(e.invokeWithinContext((e=>e.get(d.ec)))),new L]);t=t.sort(((e,t)=>a.e.compareRangesUsingStarts(e.range,t.range)));let N=0;for(let e=0;e<t.length;e++){const{range:i,template:s}=t[e];if(e>0){const s=t[e-1].range,o=a.e.fromPositions(s.getEndPosition(),i.getStartPosition()),n=new _.xv(h.getValueInRange(o));g.appendChild(n),N+=n.value.length}u.parseFragment(s,g),g.resolveVariables(f);const o=g.toString(),n=o.slice(N);N=o.length;const l=r.h.replace(i,n);l.identifier={major:e,minor:0},l._isTracked=!0,c.push(l)}return u.ensureFinalTabstop(g,i,!0),{edits:c,snippets:[new A(e,g,"")]}}dispose(){(0,o.B9)(this._snippets)}_logInfo(){return`template="${this._template}", merged_templates="${this._templateMerges.join(" -> ")}"`}insert(){if(!this._editor.hasModel())return;const{edits:t,snippets:i}="string"==typeof this._template?e.createEditsAndSnippetsFromSelections(this._editor,this._template,this._options.overwriteBefore,this._options.overwriteAfter,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService):e.createEditsAndSnippetsFromEdits(this._editor,this._template,!1,this._options.adjustWhitespace,this._options.clipboardText,this._options.overtypingCapturer,this._languageConfigurationService);this._snippets=i,this._editor.executeEdits("snippet",t,(e=>{const t=e.filter((e=>!!e.identifier));for(let e=0;e<i.length;e++)i[e].initialize(t[e].textChange);return this._snippets[0].hasPlaceholder?this._move(!0):t.map((e=>l.Y.fromPositions(e.range.getEndPosition())))})),this._editor.revealRange(this._editor.getSelections()[0])}merge(t,i=P){if(!this._editor.hasModel())return;this._templateMerges.push([this._snippets[0]._nestingLevel,this._snippets[0]._placeholderGroupsIdx,t]);const{edits:s,snippets:o}=e.createEditsAndSnippetsFromSelections(this._editor,t,i.overwriteBefore,i.overwriteAfter,!0,i.adjustWhitespace,i.clipboardText,i.overtypingCapturer,this._languageConfigurationService);this._editor.executeEdits("snippet",s,(e=>{const t=e.filter((e=>!!e.identifier));for(let e=0;e<o.length;e++)o[e].initialize(t[e].textChange);const i=o[0].isTrivialSnippet;if(!i)for(const e of this._snippets)e.merge(o);return this._snippets[0].hasPlaceholder&&!i?this._move(void 0):t.map((e=>l.Y.fromPositions(e.range.getEndPosition())))}))}next(){const e=this._move(!0);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}prev(){const e=this._move(!1);this._editor.setSelections(e),this._editor.revealPositionInCenterIfOutsideViewport(e[0].getPosition())}_move(e){const t=[];for(const i of this._snippets){const s=i.move(e);t.push(...s)}return t}get isAtFirstPlaceholder(){return this._snippets[0].isAtFirstPlaceholder}get isAtLastPlaceholder(){return this._snippets[0].isAtLastPlaceholder}get hasPlaceholder(){return this._snippets[0].hasPlaceholder}get hasChoice(){return this._snippets[0].hasChoice}get activeChoice(){return this._snippets[0].activeChoice}isSelectionWithinPlaceholders(){if(!this.hasPlaceholder)return!1;const e=this._editor.getSelections();if(e.length<this._snippets.length)return!1;const t=new Map;for(const i of this._snippets){const s=i.computePossibleSelections();if(0===t.size)for(const[i,o]of s){o.sort(a.e.compareRangesUsingStarts);for(const s of e)if(o[0].containsRange(s)){t.set(i,[]);break}}if(0===t.size)return!1;t.forEach(((e,t)=>{e.push(...s.get(t))}))}e.sort(a.e.compareRangesUsingStarts);for(const[i,s]of t)if(s.length===e.length){s.sort(a.e.compareRangesUsingStarts);for(let o=0;o<s.length;o++)s[o].containsRange(e[o])||t.delete(i)}else t.delete(i);return t.size>0}};y=O([I(3,c.c_)],y)}}]);