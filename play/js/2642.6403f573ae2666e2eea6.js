"use strict";(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[2642],{39994:function(t,e,i){i.r(e),i.d(e,{ContextMenuController:function(){return S}});var o=i(34441),n=i(85898),r=i(98299),s=i(38431),a=i(11138),d=i(55298),c=i(21081),l=i(26386),u=i(21208),h=i(70499),p=i(36953),g=i(55495),_=i(71177),f=function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},v=function(t,e){return function(i,o){e(i,o,t)}};let S=class t{constructor(t,e,i,n,r,a,d){this._contextMenuService=e,this._contextViewService=i,this._contextKeyService=n,this._keybindingService=r,this._menuService=a,this._configurationService=d,this._toDispose=new s.SL,this._contextMenuIsBeingShownCount=0,this._editor=t,this._toDispose.add(this._editor.onContextMenu((t=>this._onContextMenu(t)))),this._toDispose.add(this._editor.onMouseWheel((t=>{if(this._contextMenuIsBeingShownCount>0){const e=this._contextViewService.getContextViewElement(),i=t.srcElement;i.shadowRoot&&o.Ay(e)===i.shadowRoot||this._contextViewService.hideContextView()}}))),this._toDispose.add(this._editor.onKeyDown((t=>{this._editor.getOption(20)&&58===t.keyCode&&(t.preventDefault(),t.stopPropagation(),this.showContextMenu())})))}static get(e){return e.getContribution(t.ID)}_onContextMenu(t){if(!this._editor.hasModel())return;if(!this._editor.getOption(20))return this._editor.focus(),void(t.target.position&&!this._editor.getSelection().containsPosition(t.target.position)&&this._editor.setPosition(t.target.position));if(12===t.target.type)return;if(6===t.target.type&&t.target.detail.injectedText)return;if(t.event.preventDefault(),t.event.stopPropagation(),11===t.target.type)return this._showScrollbarContextMenu({x:t.event.posx-1,width:2,y:t.event.posy-1,height:2});if(6!==t.target.type&&7!==t.target.type&&1!==t.target.type)return;if(this._editor.focus(),t.target.position){let e=!1;for(const i of this._editor.getSelections())if(i.containsPosition(t.target.position)){e=!0;break}e||this._editor.setPosition(t.target.position)}let e=null;1!==t.target.type&&(e={x:t.event.posx-1,width:2,y:t.event.posy-1,height:2}),this.showContextMenu(e)}showContextMenu(t){if(!this._editor.getOption(20))return;if(!this._editor.hasModel())return;const e=this._getMenuActions(this._editor.getModel(),this._editor.isSimpleWidget?u.eH.SimpleEditorContext:u.eH.EditorContext);e.length>0&&this._doShowContextMenu(e,t)}_getMenuActions(t,e){const i=[],o=this._menuService.createMenu(e,this._contextKeyService),n=o.getActions({arg:t.uri});o.dispose();for(const e of n){const[,o]=e;let n=0;for(const e of o)if(e instanceof u.NZ){const o=this._getMenuActions(t,e.item.submenu);o.length>0&&(i.push(new r.wY(e.id,e.label,o)),n++)}else i.push(e),n++;n&&i.push(new r.Z0)}return i.length&&i.pop(),i}_doShowContextMenu(t,e=null){if(!this._editor.hasModel())return;const i=this._editor.getOption(55);if(this._editor.updateOptions({hover:{enabled:!1}}),!e){this._editor.revealPosition(this._editor.getPosition(),1),this._editor.render();const t=this._editor.getScrolledVisiblePosition(this._editor.getPosition()),i=o.i(this._editor.getDomNode()),n=i.left+t.left,r=i.top+t.top+t.height;e={x:n,y:r}}const r=this._editor.getOption(117)&&!a.gn;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:r?this._editor.getDomNode():void 0,getAnchor:()=>e,getActions:()=>t,getActionViewItem:t=>{const e=this._keybindingFor(t);if(e)return new n.g(t,t,{label:!0,keybinding:e.getLabel(),isMenu:!0});const i=t;return"function"==typeof i.getActionViewItem?i.getActionViewItem():new n.g(t,t,{icon:!0,label:!0,isMenu:!0})},getKeyBinding:t=>this._keybindingFor(t),onHide:t=>{this._contextMenuIsBeingShownCount--,this._editor.focus(),this._editor.updateOptions({hover:i})}})}_showScrollbarContextMenu(t){if(!this._editor.hasModel())return;const e=this._editor.getOption(67);let i=0;const o=t=>({id:"menu-action-"+ ++i,label:t.label,tooltip:"",class:void 0,enabled:void 0===t.enabled||t.enabled,checked:t.checked,run:t.run,dispose:()=>null}),n=(t,e,n,s,a)=>{if(!e)return o({label:t,enabled:e,run:()=>{}});const d=t=>()=>{this._configurationService.updateValue(n,t)},c=[];for(const t of a)c.push(o({label:t.label,checked:s===t.value,run:d(t.value)}));return((t,e)=>new r.wY("menu-action-"+ ++i,t,e,void 0))(t,c)},s=[];s.push(o({label:l.NC("context.minimap.minimap","Minimap"),checked:e.enabled,run:()=>{this._configurationService.updateValue("editor.minimap.enabled",!e.enabled)}})),s.push(new r.Z0),s.push(o({label:l.NC("context.minimap.renderCharacters","Render Characters"),enabled:e.enabled,checked:e.renderCharacters,run:()=>{this._configurationService.updateValue("editor.minimap.renderCharacters",!e.renderCharacters)}})),s.push(n(l.NC("context.minimap.size","Vertical size"),e.enabled,"editor.minimap.size",e.size,[{label:l.NC("context.minimap.size.proportional","Proportional"),value:"proportional"},{label:l.NC("context.minimap.size.fill","Fill"),value:"fill"},{label:l.NC("context.minimap.size.fit","Fit"),value:"fit"}])),s.push(n(l.NC("context.minimap.slider","Slider"),e.enabled,"editor.minimap.showSlider",e.showSlider,[{label:l.NC("context.minimap.slider.mouseover","Mouse Over"),value:"mouseover"},{label:l.NC("context.minimap.slider.always","Always"),value:"always"}]));const d=this._editor.getOption(117)&&!a.gn;this._contextMenuIsBeingShownCount++,this._contextMenuService.showContextMenu({domForShadowRoot:d?this._editor.getDomNode():void 0,getAnchor:()=>t,getActions:()=>s,onHide:t=>{this._contextMenuIsBeingShownCount--,this._editor.focus()}})}_keybindingFor(t){return this._keybindingService.lookupKeybinding(t.id)}dispose(){this._contextMenuIsBeingShownCount>0&&this._contextViewService.hideContextView(),this._toDispose.dispose()}};S.ID="editor.contrib.contextmenu",S=f([v(1,p.i),v(2,p.u),v(3,h.i6),v(4,g.d),v(5,u.co),v(6,_.Ui)],S);class m extends d.R6{constructor(){super({id:"editor.action.showContextMenu",label:l.NC("action.showContextMenu.label","Show Editor Context Menu"),alias:"Show Editor Context Menu",precondition:void 0,kbOpts:{kbExpr:c.u.textInputFocus,primary:1092,weight:100}})}run(t,e){var i;null===(i=S.get(e))||void 0===i||i.showContextMenu()}}(0,d._K)(S.ID,S),(0,d.Qr)(m)},88211:function(t,e,i){i.r(e);var o=i(55298),n=i(86689),r=i(89181),s=i(34441),a=i(13484),d=i(31837),c=i(38431),l=i(9161),u=i(38577),h=i(48115),p=i(53028),g=i(50038),_=i(35921),f=i(16614),v=i(31046),S=i(35366),m=i(51941),b=i(71177),C=function(t,e,i,o){var n,r=arguments.length,s=r<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,i):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(t,e,i,o);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(s=(r<3?n(s):r>3?n(e,i,s):n(e,i))||s);return r>3&&s&&Object.defineProperty(e,i,s),s},x=function(t,e){return function(i,o){e(i,o,t)}},w=function(t,e,i,o){return new(i||(i=Promise))((function(n,r){function s(t){try{d(o.next(t))}catch(t){r(t)}}function a(t){try{d(o.throw(t))}catch(t){r(t)}}function d(t){var e;t.done?n(t.value):(e=t.value,e instanceof i?e:new i((function(t){t(e)}))).then(s,a)}d((o=o.apply(t,e||[])).next())}))};const y="application/vnd.code.copyMetadata";let M=class extends c.JT{constructor(t,e,i,o,n){super(),this._bulkEditService=e,this._clipboardService=i,this._configurationService=o,this._languageFeaturesService=n,this._editor=t;const r=t.getContainerDomNode();this._register((0,s.nm)(r,"copy",(t=>this.handleCopy(t)))),this._register((0,s.nm)(r,"cut",(t=>this.handleCopy(t)))),this._register((0,s.nm)(r,"paste",(t=>this.handlePaste(t)),!0))}arePasteActionsEnabled(t){return this._configurationService.getValue("editor.experimental.pasteActions.enabled",{resource:t.uri})}handleCopy(t){var e;if(!t.clipboardData||!this._editor.hasTextFocus())return;const i=this._editor.getModel(),o=this._editor.getSelections();if(!i||!(null==o?void 0:o.length))return;if(!this.arePasteActionsEnabled(i))return;const n=[...o],r=o[0],s=r.isEmpty();if(s){if(!this._editor.getOption(33))return;n[0]=new g.e(r.startLineNumber,0,r.startLineNumber,i.getLineLength(r.startLineNumber))}const d=this._languageFeaturesService.documentPasteEditProvider.ordered(i).filter((t=>!!t.prepareDocumentPaste));if(!d.length)return void this.setCopyMetadata(t.clipboardData,{wasFromEmptySelection:s});const c=(0,h.Bo)(t.clipboardData),l=(0,u.R)();this.setCopyMetadata(t.clipboardData,{id:l,wasFromEmptySelection:s});const p=(0,a.PG)((t=>w(this,void 0,void 0,(function*(){const e=yield Promise.all(d.map((e=>e.prepareDocumentPaste(i,n,c,t))));for(const t of e)null==t||t.forEach(((t,e)=>{c.replace(e,t)}));return c}))));null===(e=this._currentClipboardItem)||void 0===e||e.dataTransferPromise.cancel(),this._currentClipboardItem={handle:l,dataTransferPromise:p}}setCopyMetadata(t,e){t.setData(y,JSON.stringify(e))}handlePaste(t){var e,i,o;return w(this,void 0,void 0,(function*(){if(!t.clipboardData||!this._editor.hasTextFocus())return;const n=this._editor.getSelections();if(!(null==n?void 0:n.length)||!this._editor.hasModel())return;const s=this._editor.getModel();if(!this.arePasteActionsEnabled(s))return;let a;const c=null===(e=t.clipboardData)||void 0===e?void 0:e.getData(y);c&&"string"==typeof c&&(a=JSON.parse(c));const u=this._languageFeaturesService.documentPasteEditProvider.ordered(s);if(!u.length)return;t.preventDefault(),t.stopImmediatePropagation();const g=s.getVersionId(),_=new f.Dl(this._editor,3);try{const e=(0,h.Bo)(t.clipboardData);if((null==a?void 0:a.id)&&(null===(i=this._currentClipboardItem)||void 0===i?void 0:i.handle)===a.id){(yield this._currentClipboardItem.dataTransferPromise).forEach(((t,i)=>{e.replace(i,t)}))}if(!e.has(l.v.uriList)){const t=yield this._clipboardService.readResources();t.length&&e.append(l.v.uriList,(0,d.ZO)(h.Z0.create(t)))}e.delete(y);for(const t of u){if(!t.pasteMimeTypes.some((t=>t.toLowerCase()===r.g.FILES.toLowerCase()?[...e.values()].some((t=>t.asFile())):e.has(t))))continue;const i=yield t.provideDocumentPasteEdits(s,n,e,_.token);if(g!==s.getVersionId())return;if(i)return(0,v.performSnippetEdit)(this._editor,"string"==typeof i.insertText?S.Yj.escape(i.insertText):i.insertText.snippet,n),void(i.additionalEdit&&(yield this._bulkEditService.apply(p.fo.convert(i.additionalEdit),{editor:this._editor})))}const c=null!==(o=e.get(l.v.text))&&void 0!==o?o:e.get("text");if(!c)return;const f=yield c.asString();if(g!==s.getVersionId())return;this._editor.trigger("keyboard","paste",{text:f,pasteOnNewLine:null==a?void 0:a.wasFromEmptySelection,multicursorText:null})}finally{_.dispose()}}))}};M.ID="editor.contrib.copyPasteActionController",M=C([x(1,p.vu),x(2,m.p),x(3,b.Ui),x(4,_.p)],M);var k=i(26386),D=i(12326),P=i(6325);(0,o._K)(M.ID,M),P.B.as(D.IP.Configuration).registerConfiguration(Object.assign(Object.assign({},n.wk),{properties:{"editor.experimental.pasteActions.enabled":{type:"boolean",scope:5,description:k.NC("pasteActions","Enable/disable running edits from extensions on paste."),default:!1}}}))},74744:function(t,e,i){i.r(e),i.d(e,{CursorRedo:function(){return u},CursorUndo:function(){return l},CursorUndoRedoController:function(){return c}});var o=i(38431),n=i(55298),r=i(21081),s=i(26386);class a{constructor(t){this.selections=t}equals(t){const e=this.selections.length;if(e!==t.selections.length)return!1;for(let i=0;i<e;i++)if(!this.selections[i].equalsSelection(t.selections[i]))return!1;return!0}}class d{constructor(t,e,i){this.cursorState=t,this.scrollTop=e,this.scrollLeft=i}}class c extends o.JT{constructor(t){super(),this._editor=t,this._isCursorUndoRedo=!1,this._undoStack=[],this._redoStack=[],this._register(t.onDidChangeModel((t=>{this._undoStack=[],this._redoStack=[]}))),this._register(t.onDidChangeModelContent((t=>{this._undoStack=[],this._redoStack=[]}))),this._register(t.onDidChangeCursorSelection((e=>{if(this._isCursorUndoRedo)return;if(!e.oldSelections)return;if(e.oldModelVersionId!==e.modelVersionId)return;const i=new a(e.oldSelections);this._undoStack.length>0&&this._undoStack[this._undoStack.length-1].cursorState.equals(i)||(this._undoStack.push(new d(i,t.getScrollTop(),t.getScrollLeft())),this._redoStack=[],this._undoStack.length>50&&this._undoStack.shift())})))}static get(t){return t.getContribution(c.ID)}cursorUndo(){this._editor.hasModel()&&0!==this._undoStack.length&&(this._redoStack.push(new d(new a(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._undoStack.pop()))}cursorRedo(){this._editor.hasModel()&&0!==this._redoStack.length&&(this._undoStack.push(new d(new a(this._editor.getSelections()),this._editor.getScrollTop(),this._editor.getScrollLeft())),this._applyState(this._redoStack.pop()))}_applyState(t){this._isCursorUndoRedo=!0,this._editor.setSelections(t.cursorState.selections),this._editor.setScrollPosition({scrollTop:t.scrollTop,scrollLeft:t.scrollLeft}),this._isCursorUndoRedo=!1}}c.ID="editor.contrib.cursorUndoRedoController";class l extends n.R6{constructor(){super({id:"cursorUndo",label:s.NC("cursor.undo","Cursor Undo"),alias:"Cursor Undo",precondition:void 0,kbOpts:{kbExpr:r.u.textInputFocus,primary:2099,weight:100}})}run(t,e,i){var o;null===(o=c.get(e))||void 0===o||o.cursorUndo()}}class u extends n.R6{constructor(){super({id:"cursorRedo",label:s.NC("cursor.redo","Cursor Redo"),alias:"Cursor Redo",precondition:void 0})}run(t,e,i){var o;null===(o=c.get(e))||void 0===o||o.cursorRedo()}}(0,n._K)(c.ID,c),(0,n.Qr)(l),(0,n.Qr)(u)}}]);