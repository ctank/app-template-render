(self.webpackChunkapp_template_builder=self.webpackChunkapp_template_builder||[]).push([[237],{53076:function(t,e,i){"use strict";i.d(e,{s:function(){return a}});i(77950),i(85940);var r=i(132),n=i(27875),a={name:"FormComponentBase",components:{},inject:["onChange","onGetValue","onEvent"],props:{id:{type:String,default:function(){return""}},type:{type:String,default:function(){return""}},extras:{type:Object,default:function(){return{}}},placeholder:{type:String,default:function(){return"请输入"}},rules:{type:Array,default:function(){return[]}},fieldPath:{type:String,default:function(){return""}},componentMap:{type:Object,default:function(){return{}}},formData:{type:Object,default:function(){return{}}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{}},computed:{value:{get:function(){var t="";return this.formData&&this.fieldPath&&(t=(0,r.g)(this.formData,this.fieldPath)),t},set:function(t){this.onChange(t,this.id)}},validProp:function(){return this.fieldPath.replace(/\//g,".")}},render:function(t,e,i,r,a,s){return(0,n.wg)(),(0,n.iD)("div")}}},4237:function(t,e,i){"use strict";i.r(e),i.d(e,{default:function(){return c}});i(71245),i(18178),i(43450),i(68995),i(17368),i(77950),i(51172),i(88233),i(48319),i(26936),i(21850),i(9949),i(99805);var r=i(27875),n=i(50349),a=i(53076),s=i(132),u=(0,r.aZ)({name:"ImageList",extends:a.s,props:{fileList:{type:Array,default:function(){return[]}},width:{type:Number,default:function(){return 50}},height:{type:Number,default:function(){return 50}},disabled:{type:Boolean,default:function(){return!1}}},data:function(){return{input:""}},computed:{itemPicStyle:function(){return"height:".concat(this.height,"px;width:").concat(this.width,"px;")},previewSrcList:function(){return Array.isArray(this.fileList)?this.fileList.map((function(t){return t.url})):[]}},watch:{},created:function(){},methods:{handleImageRemove:function(t){this.$emit("remove",t)}}}),o={class:"atp-image-list"},l=["onClick"];u.render=function(t,e,i,a,s,u){var c=(0,r.up)("CircleCloseFilled"),f=(0,r.up)("el-icon"),d=(0,r.up)("el-image");return(0,r.wg)(),(0,r.iD)("div",o,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(t.fileList,(function(e,i){return(0,r.wg)(),(0,r.iD)("div",{class:"atp-image-list__item mr-2",key:e.url},[(0,r._)("div",{class:"atp-image-list__delete",onClick:function(e){return t.handleImageRemove(i)}},[(0,r.Wm)(f,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(c)]})),_:1})],8,l),(0,r.Wm)(d,{style:(0,n.normalizeStyle)(t.itemPicStyle),class:"atp-image-list__pic",src:e.url,"preview-src-list":t.previewSrcList,fit:"cover"},null,8,["style","src","preview-src-list"])])})),128))])};var c=(0,r.aZ)({name:"ImageUpload",extends:a.s,components:{ImageList:u},props:{title:{type:String,default:function(){return""}},required:{type:Boolean,default:function(){return!1}},placeholder:{type:String,default:function(){return""}}},data:function(){return{}},computed:{showUploadBtn:function(){return 1!==this.extras.maxLimit||this.value.length!==this.extras.maxLimit},uploadBtnStyle:function(){return"height:".concat(this.extras.height,"px;width:").concat(this.extras.width,"px;")},disabledUpload:function(){return!!(this.extras.maxLimit>1&&this.value.length===this.extras.maxLimit||this.disabled)}},created:function(){this.setRules(),this.setDefaultValue()},methods:{setRules:function(){if(this.rules){var t=this.title;if(this.required&&this.rules.push({required:!0,message:"".concat(t,"不能为空"),trigger:"submit"}),this.extras){var e=parseInt(this.extras.minLimit),i=parseInt(this.extras.maxLimit);isNaN(e)||isNaN(i)?isNaN(e)?isNaN(i)||this.rules.push({validator:function(t,e,r){Array.isArray(e)&&e.length>i?r(new Error("最多允许上传".concat(i,"个文件"))):r()},trigger:"submit"}):this.rules.push({validator:function(t,i,r){Array.isArray(i)&&i.length<e?r(new Error("最少需要上传".concat(e,"个文件"))):r()},trigger:"submit"}):this.rules.push({validator:function(t,r,n){Array.isArray(r)&&(r.length<e||r.length>i)?n(new Error("上传文件数量在".concat(e,"和").concat(i,"之间"))):n()},trigger:"submit"})}}},setDefaultValue:function(){this.value||this.onChange([],this.id)},beforeUpload:function(t){var e=this.__$app.config.globalProperties.$message,i=new RegExp("^[一-龥A-Za-z0-9_-]+$");if(t.name.split(".").length>2||!i.test(this.filename))return e?e({showClose:!0,message:"文件名仅能包含中文数字英文字母_-",type:"error"}):alert("文件名仅能包含中文数字英文字母_-"),!1;var r=this.extras.fileSizeLimit;if(r.value){var n="MB"===r.unit?1024*r.value:r.value;if(t.size/1024>n)return e?e({showClose:!0,message:"上传文件大小不能超过".concat(r.value).concat(r.unit),type:"error"}):alert("上传文件大小不能超过".concat(r.value).concat(r.unit)),!1}return!0},uploadSuccess:function(t,e,i){var r=this,n=function(e){var n=r.extras.uploadConfig,a=n.nameFieldPath,u=n.urlFieldPath,o=n.thumbUrlFieldPath,l=e.name;a&&(l=(0,s.g)(t,a));var c="";u&&(c=(0,s.g)(t,u));var f=c;o&&(c=(0,s.g)(t,o));var d=i.findIndex((function(t){return t.uid&&t.uid===e.uid}));i[d]={name:l,url:c,thumbUrl:f,uid:e.uid,status:e.status,percentage:e.percentage}};this.extras.actionConfig.success?this.onEvent(this.extras.actionConfig.success,{file:e,res:t,id:this.id,fieldPath:this.fieldPath},n):n(e)},uploadError:function(t,e,i){this.extras.actionConfig.success&&this.onEvent(this.extras.actionConfig.success,{file:e,err:t,id:this.id,fieldPath:this.fieldPath})},handleImageRemove:function(t){var e=this;if(Array.isArray(this.value)){var i=this.value[t];i.status="uploading";var r=function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"success";if(i.status="success","success"===r){var n=(0,s.h)(e.value);n.splice(t,1),e.onChange(n,e.id)}};this.extras.actionConfig.remove?this.onEvent(this.extras.actionConfig.remove,{file:i,id:this.id,fieldPath:this.fieldPath},r):r()}}}});c.render=function(t,e,i,a,s,u){var o=(0,r.up)("image-list"),l=(0,r.up)("Plus"),c=(0,r.up)("el-icon"),f=(0,r.up)("el-upload"),d=(0,r.up)("el-form-item");return(0,r.wg)(),(0,r.j4)(d,{label:t.title,class:(0,n.normalizeClass)([t.required?"is-required":"","atp-image-upload"]),prop:t.validProp,rules:t.rules},{default:(0,r.w5)((function(){return[t.value.length?((0,r.wg)(),(0,r.j4)(o,{key:0,width:t.extras.width,height:t.extras.height,"file-list":t.value,onRemove:t.handleImageRemove},null,8,["width","height","file-list","onRemove"])):(0,r.kq)("",!0),t.showUploadBtn?((0,r.wg)(),(0,r.j4)(f,{key:1,"file-list":t.value,"onUpdate:file-list":e[0]||(e[0]=function(e){return t.value=e}),accept:"image/*",action:t.extras.uploadConfig.action,disabled:t.disabledUpload,"show-file-list":!1,"before-upload":t.beforeUpload,"on-success":t.uploadSuccess,"on-error":t.uploadError},{default:(0,r.w5)((function(){return[(0,r._)("div",{class:(0,n.normalizeClass)(["atp-image-upload__btn",t.disabledUpload?"atp-image-upload__btn--disabled":""]),style:(0,n.normalizeStyle)(t.uploadBtnStyle)},[(0,r.Wm)(c,null,{default:(0,r.w5)((function(){return[(0,r.Wm)(l)]})),_:1})],6)]})),_:1},8,["file-list","action","disabled","before-upload","on-success","on-error"])):(0,r.kq)("",!0)]})),_:1},8,["label","class","prop","rules"])}},96616:function(t,e,i){var r=i(16039),n=i(31787);t.exports=function(t,e,i){return i.get&&r(i.get,e,{getter:!0}),i.set&&r(i.set,e,{setter:!0}),n.f(t,e,i)}},20835:function(t,e,i){var r=i(26733),n=i(85052),a=i(56540);t.exports=function(t,e,i){var s,u;return a&&r(s=e.constructor)&&s!==i&&n(u=s.prototype)&&u!==i.prototype&&a(t,u),t}},26060:function(t,e,i){var r=i(31787).f;t.exports=function(t,e,i){i in t||r(t,i,{configurable:!0,get:function(){return e[i]},set:function(t){e[i]=t}})}},90143:function(t,e,i){var r=i(65968);t.exports=r(1..valueOf)},9949:function(t,e,i){"use strict";var r=i(23103),n=i(89996).findIndex,a=i(9736),s="findIndex",u=!0;s in[]&&Array(1).findIndex((function(){u=!1})),r({target:"Array",proto:!0,forced:u},{findIndex:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}}),a(s)},43450:function(t,e,i){"use strict";var r=i(23103),n=i(89996).map;r({target:"Array",proto:!0,forced:!i(31460)("map")},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},71245:function(t,e,i){"use strict";var r=i(7400),n=i(9859),a=i(65968),s=i(46541),u=i(14768),o=i(98270),l=i(20835),c=i(91321),f=i(49395),d=i(92066),h=i(24229),p=i(78151).f,g=i(97933).f,m=i(31787).f,v=i(90143),y=i(1017).trim,x="Number",b=n.Number,w=b.prototype,I=n.TypeError,_=a("".slice),E=a("".charCodeAt),S=function(t){var e=d(t,"number");return"bigint"==typeof e?e:N(e)},N=function(t){var e,i,r,n,a,s,u,o,l=d(t,"number");if(f(l))throw I("Cannot convert a Symbol value to a number");if("string"==typeof l&&l.length>2)if(l=y(l),43===(e=E(l,0))||45===e){if(88===(i=E(l,2))||120===i)return NaN}else if(48===e){switch(E(l,1)){case 66:case 98:r=2,n=49;break;case 79:case 111:r=8,n=55;break;default:return+l}for(s=(a=_(l,2)).length,u=0;u<s;u++)if((o=E(a,u))<48||o>n)return NaN;return parseInt(a,r)}return+l};if(s(x,!b(" 0o1")||!b("0b1")||b("+0x1"))){for(var A,C=function(t){var e=arguments.length<1?0:b(S(t)),i=this;return c(w,i)&&h((function(){v(i)}))?l(Object(e),i,C):e},P=r?p(b):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,isFinite,isInteger,isNaN,isSafeInteger,parseFloat,parseInt,fromString,range".split(","),R=0;P.length>R;R++)o(b,A=P[R])&&!o(C,A)&&m(C,A,g(b,A));C.prototype=w,w.constructor=C,u(n,x,C,{constructor:!0})}},17368:function(t,e,i){var r=i(7400),n=i(9859),a=i(65968),s=i(46541),u=i(20835),o=i(75762),l=i(78151).f,c=i(91321),f=i(48311),d=i(83326),h=i(83349),p=i(25650),g=i(26060),m=i(14768),v=i(24229),y=i(98270),x=i(56407).enforce,b=i(71832),w=i(70095),I=i(42926),_=i(10461),E=w("match"),S=n.RegExp,N=S.prototype,A=n.SyntaxError,C=a(N.exec),P=a("".charAt),R=a("".replace),k=a("".indexOf),L=a("".slice),U=/^\?<[^\s\d!#%&*+<=>@^][^\s!#%&*+<=>@^]*>/,D=/a/g,F=/a/g,T=new S(D)!==D,B=p.MISSED_STICKY,O=p.UNSUPPORTED_Y,j=r&&(!T||B||I||_||v((function(){return F[E]=!1,S(D)!=D||S(F)==F||"/a/i"!=S(D,"i")})));if(s("RegExp",j)){for(var q=function(t,e){var i,r,n,a,s,l,p=c(N,this),g=f(t),m=void 0===e,v=[],b=t;if(!p&&g&&m&&t.constructor===q)return t;if((g||c(N,t))&&(t=t.source,m&&(e=h(b))),t=void 0===t?"":d(t),e=void 0===e?"":d(e),b=t,I&&"dotAll"in D&&(r=!!e&&k(e,"s")>-1)&&(e=R(e,/s/g,"")),i=e,B&&"sticky"in D&&(n=!!e&&k(e,"y")>-1)&&O&&(e=R(e,/y/g,"")),_&&(a=function(t){for(var e,i=t.length,r=0,n="",a=[],s={},u=!1,o=!1,l=0,c="";r<=i;r++){if("\\"===(e=P(t,r)))e+=P(t,++r);else if("]"===e)u=!1;else if(!u)switch(!0){case"["===e:u=!0;break;case"("===e:C(U,L(t,r+1))&&(r+=2,o=!0),n+=e,l++;continue;case">"===e&&o:if(""===c||y(s,c))throw new A("Invalid capture group name");s[c]=!0,a[a.length]=[c,l],o=!1,c="";continue}o?c+=e:n+=e}return[n,a]}(t),t=a[0],v=a[1]),s=u(S(t,e),p?this:N,q),(r||n||v.length)&&(l=x(s),r&&(l.dotAll=!0,l.raw=q(function(t){for(var e,i=t.length,r=0,n="",a=!1;r<=i;r++)"\\"!==(e=P(t,r))?a||"."!==e?("["===e?a=!0:"]"===e&&(a=!1),n+=e):n+="[\\s\\S]":n+=e+P(t,++r);return n}(t),i)),n&&(l.sticky=!0),v.length&&(l.groups=v)),t!==b)try{o(s,"source",""===b?"(?:)":b)}catch(t){}return s},M=l(S),z=0;M.length>z;)g(q,S,M[z++]);N.constructor=q,q.prototype=N,m(n,"RegExp",q,{constructor:!0})}b("RegExp")},51172:function(t,e,i){var r=i(7400),n=i(25650).MISSED_STICKY,a=i(27079),s=i(96616),u=i(56407).get,o=RegExp.prototype,l=TypeError;r&&n&&s(o,"sticky",{configurable:!0,get:function(){if(this!==o){if("RegExp"===a(this))return!!u(this).sticky;throw l("Incompatible receiver, RegExp required")}}})}}]);